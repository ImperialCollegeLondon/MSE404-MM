
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MATE70020.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab04/readme/">
      
      
        <link rel="next" href="../../lab06/readme/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lab 5 - Metals and the Density of States - Modeling Materials with Density Functional Theory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#metals-and-the-density-of-states" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-header__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Modeling Materials with Density Functional Theory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 5 - Metals and the Density of States
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-nav__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    Modeling Materials with Density Functional Theory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 - Getting Started in Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab02/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Quantum Espresso Input and Output for Molecules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 - Convergence Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 4 - Crystals and the Electronic Band Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Metals and the Density of States
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Metals and the Density of States
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#density-of-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        Density of States
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Density of States">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smearing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Smearing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculating-the-dos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calculating the DOS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calculating the DOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-scf-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - SCF Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-nscf-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - NSCF Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-density-of-states-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Density of States Calculation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tackling-discontinuities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tackling Discontinuities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-aluminium" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Aluminium
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab06/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Spin Polarization and Magnetic Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab07/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Structural Optimisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab08/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 8 - Vibrational Normal Modes and Phonons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 9 - Finite Temperature Properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#density-of-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        Density of States
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Density of States">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smearing" class="md-nav__link">
    <span class="md-ellipsis">
      
        Smearing
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calculating-the-dos" class="md-nav__link">
    <span class="md-ellipsis">
      
        Calculating the DOS
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Calculating the DOS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-scf-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 - SCF Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-nscf-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 - NSCF Calculation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-density-of-states-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 - Density of States Calculation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Metals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Metals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tackling-discontinuities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tackling Discontinuities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-aluminium" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example: Aluminium
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="metals-and-the-density-of-states">Metals and the Density of States</h1>
<p>This week we will study the electronic structure of metals and the electronic
density of states. Solving the Kohn-Sham equation for metals requires some
additional considerations compared to the case of semiconductors and insulators
which we studied in the last lab.</p>
<p>As before, all the input files and scripts you need can be found in
<code>/opt/MSE404-MM/docs/labs/lab05</code> and you should copy this folder to
your home directory.</p>
<!-- <div markdown="span" style="margin: 0 auto; text-align: center"> -->
<!-- [Download the input files for this tutorial](./assets/lab10_input.zip){ .md-button .md-button--primary } -->
<!-- </div> -->

<hr />
<h2 id="density-of-states">Density of States</h2>
<p>The electronic density of states (DOS) contains information about the number of
electronic states with certain energies. Mathematically, it is defined as </p>
<div class="arithmatex">\[ 
\mathrm{DOS}(E) = \sum_{n} \sum_{\mathbf{k}} w_{\mathbf{k}}
                  \delta(E - \epsilon_{n\mathbf{k}}),
\]</div>
<p>where <span class="arithmatex">\(\epsilon_{n\mathbf{k}}\)</span> are the Kohn-Sham eigenvalues for band <span class="arithmatex">\(n\)</span> and
k-point <span class="arithmatex">\(\mathbf{k}\)</span>, <span class="arithmatex">\(w_{\mathbf{k}}\)</span> is the k-point weight to keep the total
integrated DOS to be the number of bands. I.e., </p>
<div class="arithmatex">\[
\int_{-\infty}^{\infty} \mathrm{DOS}(E) dE = \#\mathrm{bands}
\]</div>
<p>Note that the sum over k-points can be replaced by an integral if the grid is
sufficiently fine.</p>
<p>For a molecular system, the DOS consists of a series of discrete peaks at the
energies of the molecular Kohn-Sham orbitals, since we only use one k-point (the
<span class="arithmatex">\(\Gamma\)</span> point) for DFT calculations of isolated molecules. In contrast, for DFT
calculations of crystals, we use many k-points to sample the first Brillouin
zone and in this case the discrete peaks merge to form a continous curve. For
example, here are graphs of the DOS of a water molecule (isolated molecule) and
carbon diamond (periodic crystal):</p>
<figure>
  <img alt="DOS_m_c" src="../assets/dos_mol_crystal.svg" /> 
</figure>
<p>The shape of the DOS is intimately connected to the band structure of a crystal:
bands with a strong dispersion (i.e. the Kohn-Sham energies change rapidly along
a path in k-space) result in low DOS spread over a large interval, whereas less
dispersive (i.e. flatter) bands result in high DOS in a smaller energy interval. </p>
<details class="note">
<summary>Van Hove Singularity</summary>
<p>While the DOS is a continuous function, there can be sharp peaks in the DOS
that <strong>breaks the smoothness</strong> of the curve. These are called Van Hove
singularities and they occur when the band structure has a saddle point or
an inflection point. They are important because they can lead to interesting
properties in optical absorption spectra of materials.</p>
<p><figure markdown="span">
  <img alt="van hove" src="../assets/van_hove.svg" width="500" />
</figure></p>
</details>
<p>For insulators and semiconductors, the DOS is zero inside the band gap, as there
are no Kohn-Sham states in that energy range. Hence, the DOS allows us to
determine the band gap of a crystal (unlike a band structure plot which only
shows the KS energies along a specific path in the Brillouin zone, the DOS
contains information about the KS energies at all k-points in the first
Brillouin zone).</p>
<h3 id="smearing">Smearing</h3>
<p>To evaluate the equation for the DOS of a crystal numerically, we have to
replace the delta-functions by functions with a finite width, such as a Gaussian
(otherwise the DOS will always look like a set of sharp peaks). This is called
"smearing". </p>
<figure>
  <img alt="Delta" src="../assets/delta.svg" />
</figure>
<p>The width of the Gaussian is a parameter that needs to be tuned to ensure that a
physically meaningful result is obtained: </p>
<ul>
<li>If the broadening is too large, you may smear out important
  features of the DOS.</li>
<li>If the broadening is too small, you will see some unphysical peaks in the DOS
  and it will look very spikey.</li>
<li>In principle you want the smearing to be comparable to the <strong>typical
  difference of Kohn-Sham energies at neighboring k-points</strong>. In practice,
  however, it is often easier to just try different values for the broadening
  until the DOS looks physically meaningful.</li>
</ul>
<details class="note">
<summary>Tetrahedron Method</summary>
<p>Another way to obtained an accurate DOS is to linearly interpolate the
calculated Kohn-Sham energies using the so-called tetrahedron method. Such a
calculation is noticeably slower than using a broadening but there is no
need to to worry about using the correct smearing. Your only convergence
parameter is the fineness of the k-point grid you use which determines how
accurate the interpolation is.</p>
<p>It's important to note that in a real measurement of the density of states
of material (for example, using photoemission spectroscopy), there is always
some broadening coming from</p>
<ol>
<li>
<p>Electron-phonon coupling: since the atoms in a real material vibrate
     around their equilibrium positions, the energies of the electronic
     states will be smeared out.</p>
</li>
<li>
<p>Any measurement apparatus will have a finite energy resolution which
     will further broaden the measured DOS. </p>
</li>
</ol>
</details>
<h3 id="calculating-the-dos">Calculating the DOS</h3>
<p>In a similar way to the electronic band structure, we produce the density of 
states plot in three steps.</p>
<h4 id="step-1-scf-calculation">Step 1 - SCF Calculation</h4>
<p>Perform a self-consistent calculation as before to produce a converged
charge density.</p>
<div class="admonition example">
<p class="admonition-title">Task 1.1 - SCF Calculation</p>
<p>Run <code>pw.x</code> using the input file
<a href="../01_densityofstates/01_C_diamond_scf.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />01_C_diamond_scf.in</a>
for diamond.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1">pw.x &lt; 01_C_diamond_scf.in &gt; 01_C_diamond_scf.out
</span></code></pre></div></td></tr></table></div></p>
</div>
<h4 id="step-2-nscf-calculation">Step 2 - NSCF Calculation</h4>
<p>Take the density calculated in the previous step and use it to
perform a non-self-consistent calculation on a denser k-point grid.
We want an accurate description of how the KS energies vary as we move
around the Brillouin zone so we use a much denser grid here than we need
to obtain the converged density in the previous step.</p>
<p>The difference between this and the band structure calculation is that here
we use a uniform sampling of the Brillouin zone, rather than a path between
k-points. The input file for this calculation can be found at
<a href="../01_densityofstates/02_C_diamond_nscf.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />02_C_diamond_nscf.in</a>:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-1-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-1-3">    <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;nscf&#39;</span> <span class="c1">#(1)!</span>
</span><span id="__span-1-4"> <span class="o">/</span>
</span><span id="__span-1-5">
</span><span id="__span-1-6"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-1-7">    <span class="n">ibrav</span> <span class="o">=</span>  <span class="mi">2</span>
</span><span id="__span-1-8">    <span class="n">A</span> <span class="o">=</span> <span class="mf">3.567</span>
</span><span id="__span-1-9">    <span class="n">nat</span> <span class="o">=</span>  <span class="mi">2</span>
</span><span id="__span-1-10">    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-1-11">    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-1-12">    <span class="c1"># Add 4 conduction bands</span>
</span><span id="__span-1-13">    <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span> <span class="c1">#(2)!</span>
</span><span id="__span-1-14"> <span class="o">/</span>
</span><span id="__span-1-15">
</span><span id="__span-1-16"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-1-17"> <span class="o">/</span>
</span><span id="__span-1-18">
</span><span id="__span-1-19"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-1-20"> <span class="n">C</span>  <span class="mf">12.011</span>  <span class="n">C</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">vbc</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-1-21">
</span><span id="__span-1-22"><span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
</span><span id="__span-1-23"> <span class="n">C</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
</span><span id="__span-1-24"> <span class="n">C</span> <span class="mf">0.25</span> <span class="mf">0.25</span> <span class="mf">0.25</span>
</span><span id="__span-1-25">
</span><span id="__span-1-26"><span class="n">K_POINTS</span> <span class="n">automatic</span> <span class="c1">#(3)!</span>
</span><span id="__span-1-27">  <span class="mi">20</span> <span class="mi">20</span> <span class="mi">20</span>  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li><code>calculation = nscf</code> specifies that we are calculating the 
    non-self-consistent calculation.</li>
<li><code>nbnd = 8</code> specifies that we want to calculate 8 bands.</li>
<li><code>K_POINTS automatic</code> specifies that we are using an automatically generated
    k-point grid. We've increased the k-point sampling to a 20x20x20 grid, and
    we have removed the shift (without a shift, Quantum Espresso uses the
    convention that the gide always includes the origin, for more information
    see <a href="https://www.c2x.org.uk/mp_kpoints.html"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />this</a>). Many systems have
    a valence band maximum or conduction band minimum at the gamma point, so it
    is good to ensure it's explicitly included in the grid.</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Task 1.2 - NSCF Calculation</p>
<p>Run <code>pw.x</code> using the input file
<a href="../01_densityofstates/02_C_diamond_nscf.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />02_C_diamond_nscf.in</a>
for diamond.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">pw.x &lt; 02_C_diamond_nscf.in &gt; 02_C_diamond_nscf.out
</span></code></pre></div></td></tr></table></div></p>
</div>
<h4 id="step-3-density-of-states-calculation">Step 3 - Density of States Calculation</h4>
<p>From the Kohn-Sham energies calculated on the dense k-point grid we then
calculate the density of states using <code>dos.x</code>.
<a href="../01_densityofstates/03_C_diamond_dos.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />03_C_diamond_dos.in</a> is the input
file for <code>dos.x</code> and contains just a <code>DOS</code> section. What this input file
instruct <code>dos.x</code> to do is to discritise an energy range
<a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html#idm33"><code>Emin</code></a> and
<a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html#idm34"><code>Emax</code></a> using an
interval of
<a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html#idm37"><code>DeltaE</code></a> and at
each energy calculate the DOS using <a href="#density-of-states"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />the formula given
above</a>. Each delta function is replaced using a gaussian
function (which can be replace by other functions using
<a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html#idm26"><code>ngauss</code></a> tag) with
a width of
<a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html#idm30"><code>degauss</code></a>.</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"> <span class="o">&amp;</span><span class="n">DOS</span>
</span><span id="__span-3-2">  <span class="n">degauss</span> <span class="o">=</span> <span class="mf">0.03</span> <span class="c1">#!(1)!</span>
</span><span id="__span-3-3">  <span class="n">DeltaE</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#(2)!</span>
</span><span id="__span-3-4"> <span class="o">/</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li><code>degauss</code> specifies the Gaussian broadening (in Rydberg) to use in the
    density of states calculation.</li>
<li><code>DeltaE</code> specifies the spacing between energies at which the DOS is
    calculated, in eV.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We have picked similar values for <code>degauss</code> and <code>DeltaE</code> (after converting
them to the same units). In fact if <code>degauss</code> is not specified, and no
broadening scheme is used in the NSCF calculation, <code>degauss</code> will take the
value of <code>DeltaE</code> by default, and when <code>degauss</code> is used in NSCF
calculation, by default that value will be used. You can check the
documentation <a href="https://www.quantum-espresso.org/Doc/INPUT_DOS.html"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />
INPUT_DOS</a> for more
details.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Task 1.3 - Plotting Density of States</p>
<p>Run <code>dos.x</code> using the input file
<a href="../01_densityofstates/03_C_diamond_dos.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />03_C_diamond_dos.in</a>
for diamond.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">dos.x &lt; 03_C_diamond_dos.in &gt; 03_C_diamond_dos.out
</span></code></pre></div></td></tr></table></div></p>
</div>
<p>The final step produces a file named <code>pwscf.dos</code> by default. This is a simple
text file you can plot. It has three columns: Energy (eV), Density of States
(states/eV), and Integrated Density of States (states) up until that energy. And
in the first line, the estimated Fermi energy is also given.</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><span class="c1">#  E (eV)   dos(E)     Int dos(E) EFermi =   13.180 eV </span>
</span><span id="__span-5-2">  <span class="o">-</span><span class="mf">9.334</span>  <span class="mf">0.2778E-06</span>  <span class="mf">0.2778E-07</span>
</span><span id="__span-5-3">  <span class="o">-</span><span class="mf">9.234</span>  <span class="mf">0.1274E-05</span>  <span class="mf">0.1552E-06</span>
</span><span id="__span-5-4">  <span class="o">-</span><span class="mf">9.134</span>  <span class="mf">0.5226E-05</span>  <span class="mf">0.6778E-06</span>
</span><span id="__span-5-5">  <span class="o">-</span><span class="mf">9.034</span>  <span class="mf">0.1919E-04</span>  <span class="mf">0.2597E-05</span>
</span><span id="__span-5-6">  <span class="o">...</span>
</span></code></pre></div></td></tr></table></div>
<p>It is customary to shift the x-axis in the plot such that the Fermi energy
or valence band maximum is at 0. A value for the Fermi level is given in
the file header of <code>pwscf.dos</code>. This value is determined in a simple way from
the integrated density of states. Sometimes, it may be worth calculating the
Fermi level in a separate calculation using a relatively small broadening if
you're studying a metallic system (as we shall see later). For semiconductors
and insulators you can determine the valence band maximum energy from the output
file. </p>
<details class="note">
<summary>Fermi Energy From The Integrated Density of States</summary>
<p>The integrated density of states is the number of states up to a certain
energy. I.e., <span class="arithmatex">\(\int_{-\infty}^{E_1} DOS(E) d(E)\)</span>. One can easily found the
Fermi energy by looking at the energy where the integrated density of states
is equal to the number of electrons in the system. However, it is worth
noting that since we are using a smearing scheme and a denser k-point grid
in the NSCF step (which is not the case for the SCF calculation), the Fermi
energy calculated in this way may not be accurate. For accurate Fermi
energy, one should always refer to the output of the SCF calculation.</p>
</details>
<p>The directory <code>03_densityofstates</code> contains a python script that can be used to
plot the shifted DOS together with the integrated DOS.</p>
<div class="admonition example">
<p class="admonition-title">Task 1.4 - Density of States Calculation</p>
<p>Plot the density of states using the script provided.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">python plotdos_shifted.py
</span></code></pre></div></td></tr></table></div></p>
<details class="success">
<summary>DOS Plot</summary>
<p><figure markdown="span">
  <img alt="Diamond primitive cell" src="../assets/dos.png" width="500" />
</figure></p>
</details>
<p>Now try re-running Tasks 1.3 and 1.4 with different <code>degauss</code> values and see
how the DOS plots change. Does the change match your expectations?</p>
</div>
<hr />
<h2 id="metals">Metals</h2>
<p>Metals have a Fermi surface in k-space which separates the occupied from the
unoccupied Kohn-Sham states. The shape of the Fermi surface can be quite
complicated and is not known a priori. This means that in contrast to insulators
or semiconductors where every k-point has the same number of <strong>occupied</strong>
states, <strong>in a metal the number of occupied states can vary from k-point to
k-point</strong>. This makes it more difficult to calculate the electron density which
involves a summation of the squared magnitudes of the wavefunctions of all
<strong>occupied states</strong>. </p>
<h3 id="tackling-discontinuities">Tackling Discontinuities</h3>
<p>Generally, there are two things that we typically do for metals to help with the
convergence of the SCF calculation:</p>
<ol>
<li>
<p>Use a denser k-point grid than you would need for a semiconductor or
    insulator. This allows us to have a better description of the complex Fermi
    surface that metals have.</p>
</li>
<li>
<p>Use a smearing scheme for the calculation of the <strong>occupation number</strong> of
    Kohn-Sham states at each k-point. Instead of having a integer occupation
    number of each band (0 or 1), we now allow a fractional occupation number so
    that the occupation number varies smoothly across k-points. </p>
<details class="note">
<summary>Charge Sloshing Effect</summary>
<p>Without occupation smearing, each band is either fully occupied or
unoccupied. At each step of the SCF loop, bands may switch between being
occupied and occupied, leading to a large change in the electron
density which can slow down the convergence of the SCF calculation.</p>
</details>
<p>One way to obtain smeared occupation numbers is to calculate them using the
Fermi-Dirac distribution <span class="arithmatex">\(f_T(\epsilon_{n\mathbf{k}})\)</span> at a finite
temperature <span class="arithmatex">\(T\)</span></p>
<div class="arithmatex">\[
f_T(E) = \frac{2}{e^\frac{E-E_F}{k_B T} + 1},
\]</div>
<p>where <span class="arithmatex">\(E_F\)</span> denotes the Fermi energy which we set to the energy of the
highest occupied Kohn-Sham state and the factor of 2 results from the Pauli
principle. We can calculate the Fermi level using the condition that the sum
over all occupation numbers must be equal to the total number of electrons
<span class="arithmatex">\(N_e\)</span> in the cell(<span class="arithmatex">\(w_\mathbf{k}\)</span> is the weight of the k-point):</p>
<div class="arithmatex">\[
N_e = \sum_n \sum_\mathbf{k} w_\mathbf{k} f_T(\epsilon_{n\mathbf{k}}).
\]</div>
<p>At low temperatures, the Fermi-Dirac distribution becomes a discontinous
step function. So we must choose the temperature to be sufficiently high to
ensure smooth occupation numbers near the Fermi surface (using the tag
<code>degauss</code> in the input file). It is worth noting that other smearing
methods, such as Gaussian smearing.</p>
<p>Using a smearing scheme for the occupation numbers helps significantly in
achieving a smooth SCF convergence for metals, as otherwise a small change
in the energy of a KS state from one self-consistent iteration to the next
one could lead to a very large change in its occupation number and to the
electron density. We set the smearing scheme (for both DOS and occupation
function) and width with the <code>occupations</code> and <code>degauss</code> variables in the
input file.</p>
<div class="admonition tip">
<p class="admonition-title">Additional read</p>
<p>For a thorough review of the most typical smearing method used in DFT,
have a read at <a href="https://doi.org/10.1103/PhysRevB.107.195122"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />this
paper</a>. </p>
</div>
<p>It is importatant to note that the smearing used for the occupation numbers
can be different from the smearing used for the DOS plot. The former is
needed to help with the convergence of the SCF calculation for metals,
whereas the latter is used because the result of the SCF caculation are
descrete Kohn-Sham energy levels (at each k-point), and the only way to
produce a smooth DOS plot is to again use a smearing scheme.</p>
</li>
</ol>
<h3 id="example-aluminium">Example: Aluminium</h3>
<p>Aluminium has an FCC crystal structure with one atom per unit cell, which
we know how to deal with at this point. The thing about Aluminium that makes it
more complicated within DFT is that it is a metal.</p>
<p>Here is an example input file for a SCF calculation of Aluminium:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-7-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-7-3">    <span class="n">verbosity</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span> <span class="c1">#(1)!</span>
</span><span id="__span-7-4"> <span class="o">/</span>
</span><span id="__span-7-5">
</span><span id="__span-7-6"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-7-7">    <span class="n">ibrav</span> <span class="o">=</span>  <span class="mi">2</span>
</span><span id="__span-7-8">    <span class="n">A</span> <span class="o">=</span> <span class="mf">2.863</span>
</span><span id="__span-7-9">    <span class="n">nat</span> <span class="o">=</span>  <span class="mi">1</span>
</span><span id="__span-7-10">    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-7-11">    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">18.0</span>
</span><span id="__span-7-12"><span class="hll">    <span class="n">occupations</span> <span class="o">=</span> <span class="s1">&#39;smearing&#39;</span> <span class="c1">#(2)!</span>
</span></span><span id="__span-7-13"><span class="hll">    <span class="n">smearing</span> <span class="o">=</span> <span class="s1">&#39;fermi-dirac&#39;</span> <span class="c1">#(3)!</span>
</span></span><span id="__span-7-14"><span class="hll">    <span class="n">degauss</span> <span class="o">=</span> <span class="mf">0.1</span><span class="n">d0</span> <span class="c1">#(4)!</span>
</span></span><span id="__span-7-15"> <span class="o">/</span>
</span><span id="__span-7-16">
</span><span id="__span-7-17"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-7-18"> <span class="o">/</span>
</span><span id="__span-7-19">
</span><span id="__span-7-20"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-7-21"> <span class="n">Al</span>  <span class="mf">26.982</span>  <span class="n">Al</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">vbc</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-7-22">
</span><span id="__span-7-23"><span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
</span><span id="__span-7-24"> <span class="n">Al</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
</span><span id="__span-7-25">
</span><span id="__span-7-26"><span class="n">K_POINTS</span> <span class="n">automatic</span>
</span><span id="__span-7-27">  <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>The <code>verbosity</code> variable is set to <code>high</code> to give more information about
      the SCF calculation, including occupation of the bands at each k-point.</li>
<li>The <code>occupations</code> variable is set to <code>smearing</code> to tell Quantum Espresso
      to use a smearing scheme <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm362"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />input 
      description</a>.</li>
<li>The <code>smearing</code> variable is set to <code>fermi-dirac</code> to tell Quantum Espresso
      to use a Fermi-Dirac smearing scheme. <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm404"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />input
      description</a>. </li>
<li>The <code>degauss</code> variable is set to 0.1d0 to set the width of the smearing.
      see <a href="https://www.quantum-espresso.org/Doc/INPUT_PW.html#idm401"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />input
      description</a>.</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Task 2.1 - Smearing for Metals</p>
<p>First, run the <code>pw.x</code> calculation with the supplied input file in
<a href="../02_aluminium/Al.in"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" />02_aluminium/Al.in</a>.</p>
<p>Then, take a look at the output file. Can you find the Kohn-Sham eigenvalues
at each k-point and the corrresponding <strong>occupations</strong> number.</p>
<details class="success">
<summary>Example</summary>
<p>```
  k =-0.0625 0.0625 0.0625 (    59 PWs)   bands (ev):</p>
</details>
<p>3.5809  40.9721  43.7477  43.7477  49.9157  53.1364</p>
<p>occupation numbers 
 1.0000   0.0000   0.0000   0.0000   0.0000   0.0000</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>  k =-0.1875 0.1875-0.0625 (    58 PWs)   bands (ev):
</code></pre></div></td></tr></table></div>
<p>4.7127  35.0485  40.5915  44.7949  50.9368  50.9459</p>
<p>occupation numbers 
 1.0000   0.0001   0.0000   0.0000   0.0000   0.0000
     ... 
    ```</p>
<p>For a metal the default number of bands that are used in the SCF calculation
is at least four more than are needed to accommodate all electrons (even
without us setting the <code>nband</code> tag). The pseudopotential we have used for
aluminium has 3 valence electrons, which could be accommodated in two bands.
Adding the four extra bands, this gives a total of 6 bands which are used in
the calculation. </p>
<p><!-- Now, try to remove the <code>occupations</code> and <code>degauss</code> variables from the input -->
<!-- file and see what happens when you re-run the calculation. -->
<!--  -->
<!-- ??? success "Example"  -->
<!--     The calculation will fail with the following error message: -->
<!--     <code>--&gt;
&lt;!--     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% --&gt;
&lt;!--          Error in routine electrons (1): --&gt;
&lt;!--          charge is wrong: smearing is needed --&gt;
&lt;!--     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% --&gt;
&lt;!--</code> --></p>
<p>Now, try to play around with the <code>degauss</code> value and see how the
 occupations change. Does it match your expectations?</p>
</div>
<p>Now you know how to use smearing to help with the convergence of a metal, you
can obtain the density of states and band structure of a metal just as easy. </p>
<div class="admonition example">
<p class="admonition-title">Task 2.2 - DOS of Aluminium</p>
<p>Try calculating the density of states of Aluminium by following Tasks 1.1 to
1.4. Remember to change the Fermi energy in the python script to the correct
value. Can you find an energy gap? Where does the Fermi level lie?</p>
<details class="success">
<summary>DOS Plot</summary>
<p><figure markdown="span">
  <img alt="Diamond primitive cell" src="../assets/Al_dos.png" width="500" />
</figure></p>
</details>
</div>
<div class="admonition example">
<p class="admonition-title">Task 2.3 - Band Structure of Aluminium</p>
<p>Try calculate the band structure of Aluminium following the path of:
 <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><span class="c1"># Path here goes: Î“ X U|K Î“ L W X</span>
</span><span id="__span-8-2"><span class="n">K_POINTS</span> <span class="n">crystal_b</span>
</span><span id="__span-8-3"><span class="mf">0.0000000000</span>     <span class="mf">0.0000000000</span>     <span class="mf">0.0000000000</span> <span class="mi">30</span>    <span class="n">Î“</span>
</span><span id="__span-8-4"><span class="mf">0.5000000000</span>     <span class="mf">0.0000000000</span>     <span class="mf">0.5000000000</span> <span class="mi">30</span>    <span class="n">X</span> 
</span><span id="__span-8-5"><span class="mf">0.6250000000</span>     <span class="mf">0.2500000000</span>     <span class="mf">0.6250000000</span> <span class="mi">00</span>    <span class="n">U</span> 
</span><span id="__span-8-6"><span class="mf">0.3750000000</span>     <span class="mf">0.3750000000</span>     <span class="mf">0.7500000000</span> <span class="mi">30</span>    <span class="n">K</span> 
</span><span id="__span-8-7"><span class="mf">0.0000000000</span>     <span class="mf">0.0000000000</span>     <span class="mf">0.0000000000</span> <span class="mi">30</span>    <span class="n">Î“</span>
</span><span id="__span-8-8"><span class="mf">0.5000000000</span>     <span class="mf">0.5000000000</span>     <span class="mf">0.5000000000</span> <span class="mi">30</span>    <span class="n">L</span> 
</span><span id="__span-8-9"><span class="mf">0.5000000000</span>     <span class="mf">0.2500000000</span>     <span class="mf">0.7500000000</span> <span class="mi">30</span>    <span class="n">W</span> 
</span><span id="__span-8-10"><span class="mf">0.5000000000</span>     <span class="mf">0.0000000000</span>     <span class="mf">0.5000000000</span> <span class="mi">00</span>    <span class="n">X</span> 
</span></code></pre></div></td></tr></table></div>
 You can always refer back to <a href="../../lab04/readme/">lab04</a> for
 reference. Remember to change the number of bands to and the Fermi energy
 in the plotting script.</p>
<details class="success">
<summary>Band Structure Plot</summary>
<p><figure markdown="span">
  <img alt="Diamond primitive cell" src="../assets/Al_bands.png" width="500" />
</figure></p>
</details>
</div>
<hr />
<h2 id="summary">Summary</h2>
<p>In this tutorial, we have learned:</p>
<ul>
<li>What is the electronic density of states (DOS).</li>
<li>How to use the <code>dos.x</code> code from the Quantum Espresso package.</li>
<li>How to treat a metallic system.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>