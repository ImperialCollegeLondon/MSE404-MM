
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MATE70020.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab06/readme/">
      
      
        <link rel="next" href="../../lab08/readme/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lab 7 - Structural Optimisation - Modeling Materials with Density Functional Theory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#structural-optimisation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-header__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Modeling Materials with Density Functional Theory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 7 - Structural Optimisation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-nav__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    Modeling Materials with Density Functional Theory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 - Getting Started in Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab02/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Quantum Espresso Input and Output for Molecules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 - Convergence Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 4 - Crystals and the Electronic Band Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab05/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Metals and the Density of States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab06/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Spin Polarization and Magnetic Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Structural Optimisation
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Structural Optimisation
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-potential-energy-surface" class="md-nav__link">
    <span class="md-ellipsis">
      
        The potential energy surface
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-structure-of-molecules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground state structure of molecules
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground state structure of molecules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forces-in-molecules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forces in molecules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convergence test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation-of-molecular-geometry" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimisation of molecular geometry
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-structure-of-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground state structure of crystals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground state structure of crystals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stress-and-pressure-in-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stress and pressure in crystals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimizing-lattice-parameters-of-unit-cells" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimizing lattice parameters of unit cells
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-modulus-of-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bulk modulus of crystals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab08/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 8 - Vibrational Normal Modes and Phonons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 9 - Finite Temperature Properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-potential-energy-surface" class="md-nav__link">
    <span class="md-ellipsis">
      
        The potential energy surface
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-structure-of-molecules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground state structure of molecules
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground state structure of molecules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forces-in-molecules" class="md-nav__link">
    <span class="md-ellipsis">
      
        Forces in molecules
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convergence-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Convergence test
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimisation-of-molecular-geometry" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimisation of molecular geometry
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ground-state-structure-of-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Ground state structure of crystals
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ground state structure of crystals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stress-and-pressure-in-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stress and pressure in crystals
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optimizing-lattice-parameters-of-unit-cells" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optimizing lattice parameters of unit cells
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-modulus-of-crystals" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bulk modulus of crystals
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="structural-optimisation">Structural Optimisation</h1>
<p>This week, we will focus on predicting the atomic structure of materials and molecules. In particular, we will study techniques that allow us to find the atomic structure with the lowest energy. We will begin by briefly reviewing the very important concept of a potential energy surface (PES). </p>
<h2 id="the-potential-energy-surface">The potential energy surface</h2>
<p>The potential energy surface (PES) gives the total energy of a molecule or crystal (excluding the kinetic energy of the nuclei, hence the name <strong>potential</strong> energy surface) as function of the nuclear positions. It is commonly denoted as <span class="arithmatex">\(U(\{\mathbf{R}\})\)</span>, where <span class="arithmatex">\(\mathbf{R}\)</span> represents the set of nuclear positions. Many useful quantities, such as the forces acting on the nuclei or the stress in a crystal, can be calculated by evaluating the relevant derivatives of the PES.  </p>
<h2 id="ground-state-structure-of-molecules">Ground state structure of molecules</h2>
<p>The ground state structure of a molecule simply refers to the structure with the lowest total energy. This atomic structure is also called the optimal, equilibrium, or stablest structure of the molecule. Mathematically, this structure is associated with the <strong>global</strong> minimum of the PES. Therefore, the atomic forces in this structure will all vanish.  </p>
<p>Most DFT codes, like Quantum Espresso, move the nuclei by moving them in the direction of the forces that act on them until the atomic forces "vanish", i.e. become lower than some cutoff value. This process is called <strong>relaxation</strong> or <strong>structural optimisation</strong>. The resulting structure obtained from this procedure is called the relaxed structure. </p>
<p>In the first part of the lab, we will demonstrate how to calculate the forces and find the optimal structure of a molecule in Quantum Espresso. </p>
<div class="admonition danger">
<p class="admonition-title">Danger: metastable structures</p>
<p>When relaxing large molecules, there might be other <strong>local</strong> minima in the PES. These local minima are associated with atomic structures which are higher in the total energy, but the the forces also vanish. These structures are called <strong>metastable</strong> structures.</p>
<p>When searching for the stablest structures using DFT, there is always a possibility that your calculation is "trapped" in one of these metastable structures. Whereas this is less likely to happen for small molecules, this can happen with large molecules. You will have to be careful! </p>
</div>
<div class="admonition question">
<p class="admonition-title">Question</p>
<p>How can we reduce the risk of mistaking a metastable structure as the ground state structure? </p>
<details class="success">
<summary>Answer</summary>
<p>After obtaining a relaxed structure, add some small (but not too small) random displacement to the nuclei and then redo the relaxation. If the displacement is sufficiently large, your structure can now relax to a different minimum of the PES. </p>
</details>
</div>
<h3 id="forces-in-molecules">Forces in molecules</h3>
<p>The force acting on a nucleus, <span class="arithmatex">\(\mathbf{F}\)</span>, is defined as the first derivative of the PES, <span class="arithmatex">\(U\)</span>, with respect to the position of that nucleus, <span class="arithmatex">\(\mathbf{R}\)</span>. Mathematically,
$$
\mathbf{F} = -\nabla_\mathbf{R} U.
$$</p>
<p>In following tasks, we will go through how the atomic forces are calculated in Quantum Espresso. We have prepared a distorted methane molecule, <span class="arithmatex">\(\mathrm{CH_4}\)</span>, where one of the hydrogen atoms (the one sitting on the z-axis above the <span class="arithmatex">\(\mathrm{C}\)</span> atom) is pushed closer to the carbon atom than others. </p>
<p>This is how the distorted methane molecule looks like. The white atoms are the hydrogen atoms, and the black atom is the carbon atom. Notice how the top hydrogen atom is so close to the carbon atom that it gets merged into the carbon atom in the visualisation.  </p>
<figure>
  <img alt="ch4_comp" src="../assets/CH4_vis0.png" width="300" />
</figure>
<div class="admonition example">
<p class="admonition-title">Task 1 - Examining atomic forces in the output file</p>
<ul>
<li>Go to the directory <code>01_ch4_scf</code>. </li>
<li>Read input file <code>CH4.in</code>. The most important section of the file is shown below. 
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-0-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>  
</span><span id="__span-0-3">    <span class="n">disk_io</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>  
</span><span id="__span-0-4">    <span class="n">tprnfor</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span> <span class="c1">#(1)!</span>
</span><span id="__span-0-5"> <span class="o">/</span>
</span><span id="__span-0-6"><span class="o">...</span>
</span><span id="__span-0-7">
</span><span id="__span-0-8"><span class="n">K_POINTS</span> <span class="n">gamma</span> <span class="c1">#(2)!</span>
</span></code></pre></div></td></tr></table></div><ol>
<li><code>tprnfor</code> asks Quantum Espresso to print the forces.</li>
<li>We only use the <span class="arithmatex">\(\Gamma\)</span>-point since we are modelling a molecule. </li>
</ol>
</li>
<li>Run the command <code>pw.x &lt; CH4.in &gt; CH4.out</code>.</li>
<li>
<p>When the calculation is finished, search the output file for the line saying <code>Forces acting on atoms</code>. This should be written just before the timing information. </p>
</li>
<li>
<p>You should find a section that looks like the following: 
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"> <span class="n">Forces</span> <span class="n">acting</span> <span class="n">on</span> <span class="n">atoms</span> <span class="p">(</span><span class="n">cartesian</span> <span class="n">axes</span><span class="p">,</span> <span class="n">Ry</span><span class="o">/</span><span class="n">au</span><span class="p">):</span>
</span><span id="__span-1-2">
</span><span id="__span-1-3"> <span class="n">atom</span>    <span class="mi">1</span> <span class="nb">type</span>  <span class="mi">1</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.00015533</span>    <span class="mf">0.00000000</span>  <span class="o">-</span><span class="mf">22.80532399</span>
</span><span id="__span-1-4"> <span class="n">atom</span>    <span class="mi">2</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>    <span class="o">-</span><span class="mf">0.00015700</span>    <span class="mf">0.00000000</span>   <span class="mf">22.78015891</span>
</span><span id="__span-1-5"> <span class="n">atom</span>    <span class="mi">3</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>    <span class="o">-</span><span class="mf">0.04291717</span>    <span class="mf">0.00000000</span>    <span class="mf">0.00839216</span>
</span><span id="__span-1-6"> <span class="n">atom</span>    <span class="mi">4</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.02145942</span>    <span class="mf">0.03717243</span>    <span class="mf">0.00838646</span>
</span><span id="__span-1-7"> <span class="n">atom</span>    <span class="mi">5</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.02145942</span>   <span class="o">-</span><span class="mf">0.03717243</span>    <span class="mf">0.00838646</span>
</span><span id="__span-1-8">
</span><span id="__span-1-9"> <span class="n">Total</span> <span class="n">force</span> <span class="o">=</span>    <span class="mf">32.233898</span>     <span class="n">Total</span> <span class="n">SCF</span> <span class="n">correction</span> <span class="o">=</span>     <span class="mf">0.000310</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>Why are these atomic forces expected for this distorted methane molecule? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Since the <span class="arithmatex">\(\mathrm{H}\)</span> atom (atom 2) above the <span class="arithmatex">\(\mathrm{C}\)</span> atom (atom 1) is pushed closer to the <span class="arithmatex">\(\mathrm{C}\)</span> atom, the covalent <span class="arithmatex">\(\mathrm{C}-\mathrm{H}\)</span> bond between these two atoms is compressed. The two atoms will repel each other to uncompress the bond. Atom 2 should experience an upward force and atom 1 should experience a downward force, and this pair should be approximately equal and opposite. This is indeed the case in the output file.  </p>
</details>
<ul>
<li>What are the units of atomic forces in Quantum Espresso? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Ry/Bohr. 1 Ry/Bohr is equivalent to 25.7 eV/Å, check this yourself!</p>
</details>
<details class="note">
<summary>Understanding the units better</summary>
<p>In this task, the <span class="arithmatex">\(z\)</span>-component of the force acting on the <span class="arithmatex">\(\mathrm{H}\)</span> atom is 22.80 Ry/Bohr. This means that moving the <span class="arithmatex">\(\mathrm{H}\)</span> atom along the positive <span class="arithmatex">\(z\)</span>-direction by 0.01 Bohr reduces the total energy by about 0.28 Ry, or 3.81 eV. This is a large gain in energy. This is because the covalent bond is strong, and the size of compression is large. So pushing the H atom away from the C atom by any small amount will lead to a large gain in energy.  </p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>Total force</code> listed here is the square root of the sum of <em>all</em> of the force components squared</p>
<div class="arithmatex">\[
F = \sqrt{\sum_{i\in\mathrm{atoms}}|\mathbf{F}_{i}|^2}     
\]</div>
<p>If the <code>Total SCF correction</code> is comparable to the <code>Total force</code> it usually means you need to try to better converge the SCF cycle (via <code>conv_thr</code>).</p>
</div>
<h3 id="convergence-test">Convergence test</h3>
<p>Just as we have to check the convergence of the total energy against the plane-wave cutoff, we have to check the convergence of the atomic forces against the plane-wave cutoff, too. Note that you might need a different cutoff to convergence the forces than for the total energy! To save a bit of time, we simply show you the result of such a convergence study for the methane molecule below. </p>
<figure>
  <img alt="conv_curve" src="../assets/conv_curve.png" width="400" />
</figure>
<p>In the figure, <span class="arithmatex">\(\delta_E=(E^{\mathrm{tot}}_{\mathrm{best}}-E^{\mathrm{tot}}_{\mathrm{PW_cutoff}})/E^{\mathrm{tot}}_{\mathrm{best}}\)</span>, the fractional difference in total energy you have calculated in lab 3, and <span class="arithmatex">\(\delta_F=(F^{\mathrm{tot}}_{\mathrm{best}}-F^{\mathrm{tot}}_{\mathrm{PW_cutoff}})/F^{\mathrm{tot}}_{\mathrm{best}}\)</span>, the same fractional difference for the total force (we have scaled the energy curve by a factor of 10 for visual clarity). You will notice that the magnitude of <span class="arithmatex">\(\delta_E\)</span> is much smaller than that of  <span class="arithmatex">\(\delta_F\)</span>. This shows that the total force converges slower with respect to the plane-wave cutoff than to the total energy. So if you want to find the stablest structure of a material or molecule, make sure the force is converged with respect to the plane-wave cutoff! </p>
<!-- !!! example "Task 2 - Examining convergence" 
    In this task, multiple input files of the same distorted methane molecule are prepared. Each input file is labelled by their PW cutoff. 

    - Go to the directory `02_ch4_convergence`. 


    - Similar to what you have done in Lab 3, make 9 copies of the input file `CH4_20.in` and name them `CH4_i.in`, where `i` runs from 30 to 100 in steps of 10. Edit each input file so that the value of `ecutwfc` is `i` Ry. 
    - Run `python3 ecutwfc_file_build.py` script to produce a list of input files. This script is very similar to the one used in Lab 3. This will create input files with PW cutoffs from 10 to 100 Ry.  

    - Use the script `tbd` to run `pw.x` to perform a DFT calculation for each input files.

    - Create a file named `data.txt` that records the values of PW cutoff in the first column, and the values of `Total force` in the second column. 
     - Run `bash ecutwfc_force.sh` to run all the `pw.x` calculations as in Lab 3. 

    - Which quantities are being plotted by the script for determining the convergence? 

    ??? success "Answer" 
        The script plots the fractional difference of the total force with respect to the best-converged total force $(F^{\mathrm{tot}}_{\mathrm{best}}-F^{\mathrm{tot}}_{i})/F^{\mathrm{tot}}_{\mathrm{best}}$.   

    - How does the convergence curves look like? 
    ??? success "Answer" -->

<h3 id="optimisation-of-molecular-geometry">Optimisation of molecular geometry</h3>
<p>Now that we have seen how to calculate the forces associated with a particular atomic structure, we can use Quantum Espresso to optimise the structure of molecules.</p>
<div class="admonition example">
<p class="admonition-title">Task 2 - Optimising the molecular structure</p>
<ul>
<li>Go to the directory <code>02_ch4_opt</code>. </li>
<li>
<p>Read the input file <code>CH4_opt.in</code>, the important parts are shown below. 
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-2-2">    <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;relax&#39;</span> <span class="c1">#(1)! </span>
</span><span id="__span-2-3">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-2-4">    <span class="n">disk_io</span> <span class="o">=</span> <span class="s1">&#39;none&#39;</span>
</span><span id="__span-2-5">    <span class="n">tprnfor</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</span><span id="__span-2-6">    <span class="n">forc_conv_thr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">D</span><span class="o">-</span><span class="mi">4</span> <span class="c1">#(2)!</span>
</span><span id="__span-2-7"> <span class="o">/</span>
</span><span id="__span-2-8">
</span><span id="__span-2-9"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-2-10">    <span class="n">ibrav</span> <span class="o">=</span>  <span class="mi">1</span>
</span><span id="__span-2-11">    <span class="n">A</span> <span class="o">=</span> <span class="mf">20.0</span>
</span><span id="__span-2-12">    <span class="n">nat</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="__span-2-13">    <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-2-14">    <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mi">80</span>
</span><span id="__span-2-15"> <span class="o">/</span>
</span><span id="__span-2-16">
</span><span id="__span-2-17"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-2-18"> <span class="o">/</span>
</span><span id="__span-2-19">
</span><span id="__span-2-20"> <span class="o">&amp;</span><span class="n">IONS</span> <span class="c1">#(3)!</span>
</span><span id="__span-2-21"> <span class="o">/</span> 
</span><span id="__span-2-22"><span class="o">...</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Tells Quantum Espresso to carry out a structure optimisation.   </li>
<li>Set convergence criterion for forces in units of Ry/Bohr.   </li>
<li>You'll need to add an <code>IONS</code> section to the input. This is needed when <code>calculation=relax</code>. There are many other variables you can add for the IONS section. These include the algorithm of relaxation. If you are interested, you can read about it in the input description of <code>pw.x</code>.</li>
</ol>
</li>
<li>
<p>Run <code>pw.x &lt; CH4_opt.in &gt; CH4_opt.out</code>.  </p>
</li>
<li>In the output file, navigate to the line that says <code>End of BFGS Geometry Optimization</code>. The important sections above the end of the output file are shown below. 
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"> <span class="o">...</span>
</span><span id="__span-3-2">
</span><span id="__span-3-3"> <span class="n">number</span> <span class="n">of</span> <span class="n">scf</span> <span class="n">cycles</span>    <span class="o">=</span>  <span class="mi">17</span> <span class="c1">#(1)!</span>
</span><span id="__span-3-4"> <span class="n">number</span> <span class="n">of</span> <span class="n">bfgs</span> <span class="n">steps</span>    <span class="o">=</span>  <span class="mi">15</span> <span class="c1">#(2)!</span>
</span><span id="__span-3-5">
</span><span id="__span-3-6"> <span class="o">...</span> 
</span><span id="__span-3-7">
</span><span id="__span-3-8"> <span class="n">Forces</span> <span class="n">acting</span> <span class="n">on</span> <span class="n">atoms</span> <span class="p">(</span><span class="n">cartesian</span> <span class="n">axes</span><span class="p">,</span> <span class="n">Ry</span><span class="o">/</span><span class="n">au</span><span class="p">):</span>
</span><span id="__span-3-9">
</span><span id="__span-3-10"> <span class="n">atom</span>    <span class="mi">1</span> <span class="nb">type</span>  <span class="mi">1</span>   <span class="n">force</span> <span class="o">=</span>    <span class="o">-</span><span class="mf">0.00000168</span>    <span class="mf">0.00000000</span>    <span class="mf">0.00000028</span> <span class="c1">#(3)! </span>
</span><span id="__span-3-11"> <span class="n">atom</span>    <span class="mi">2</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.00000060</span>    <span class="mf">0.00000000</span>    <span class="mf">0.00009975</span>
</span><span id="__span-3-12"> <span class="n">atom</span>    <span class="mi">3</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>    <span class="o">-</span><span class="mf">0.00001049</span>    <span class="mf">0.00000000</span>   <span class="o">-</span><span class="mf">0.00003770</span>
</span><span id="__span-3-13"> <span class="n">atom</span>    <span class="mi">4</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.00000578</span>    <span class="mf">0.00000471</span>   <span class="o">-</span><span class="mf">0.00003116</span>
</span><span id="__span-3-14"> <span class="n">atom</span>    <span class="mi">5</span> <span class="nb">type</span>  <span class="mi">2</span>   <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.00000578</span>   <span class="o">-</span><span class="mf">0.00000471</span>   <span class="o">-</span><span class="mf">0.00003116</span>
</span><span id="__span-3-15">
</span><span id="__span-3-16"> <span class="n">Total</span> <span class="n">force</span> <span class="o">=</span>     <span class="mf">0.000116</span>     <span class="n">Total</span> <span class="n">SCF</span> <span class="n">correction</span> <span class="o">=</span>     <span class="mf">0.000046</span> 
</span><span id="__span-3-17">
</span><span id="__span-3-18"><span class="o">...</span> 
</span><span id="__span-3-19">
</span><span id="__span-3-20"> <span class="n">bfgs</span> <span class="n">converged</span> <span class="ow">in</span>  <span class="mi">18</span> <span class="n">scf</span> <span class="n">cycles</span> <span class="ow">and</span>  <span class="mi">15</span> <span class="n">bfgs</span> <span class="n">steps</span> <span class="c1">#(4)! </span>
</span><span id="__span-3-21">
</span><span id="__span-3-22"><span class="n">Begin</span> <span class="n">final</span> <span class="n">coordinates</span>
</span><span id="__span-3-23">
</span><span id="__span-3-24"><span class="o">...</span> 
</span><span id="__span-3-25">
</span><span id="__span-3-26"><span class="n">ATOMIC_POSITIONS</span> <span class="p">(</span><span class="n">angstrom</span><span class="p">)</span>
</span><span id="__span-3-27"><span class="n">C</span>                <span class="mf">0.0000041368</span>        <span class="mf">0.0000000000</span>       <span class="o">-</span><span class="mf">0.1580814281</span>
</span><span id="__span-3-28"><span class="n">H</span>                <span class="mf">0.0000879609</span>        <span class="mf">0.0000000000</span>        <span class="mf">0.9402289196</span>
</span><span id="__span-3-29"><span class="n">H</span>                <span class="mf">1.0356035232</span>        <span class="mf">0.0000000000</span>       <span class="o">-</span><span class="mf">0.5241329179</span>
</span><span id="__span-3-30"><span class="n">H</span>               <span class="o">-</span><span class="mf">0.5178483105</span>       <span class="o">-</span><span class="mf">0.8968828453</span>       <span class="o">-</span><span class="mf">0.5240072869</span>
</span><span id="__span-3-31"><span class="n">H</span>               <span class="o">-</span><span class="mf">0.5178483105</span>        <span class="mf">0.8968828453</span>       <span class="o">-</span><span class="mf">0.5240072869</span>
</span><span id="__span-3-32"><span class="n">End</span> <span class="n">final</span> <span class="n">coordinates</span> <span class="c1">#(5)!</span>
</span></code></pre></div></td></tr></table></div><ol>
<li>The latest number of scf cycles is shown after each scf cycle. </li>
<li>The latest number of relaxation steps is shown after each relaxation step. Here, a relaxation step is called a "bfgs step" in our calculation. This is just the name of our relaxation algorithm.</li>
<li>The components of the force on each atom are almost zero. </li>
<li>The total number of scf cycles is 18, and the number of relaxation steps taken is 15. </li>
<li>Atomic coordinates of the relaxed structure. </li>
</ol>
</li>
</ul>
<details class="success">
<summary>What is the equilibrium bond length?</summary>
<p>By taking the difference between the <span class="arithmatex">\(z\)</span>-coordinates of atoms 2 and 1, the bond length is found to be 1.10 Å. The experimental value is 1.09 Å so this is in good agreement. You can check that all the bond lengths are the same.  </p>
</details>
</div>
<p>The animation below visualises the motion of the atoms during the relaxation. You can clearly see how in the first step, the top hydrogen atom is pushed away from the carbon atom.   </p>
<figure>
  <img alt="rel_gif" src="../assets/ch4.gif" width="300" />
</figure>
<h2 id="ground-state-structure-of-crystals">Ground state structure of crystals</h2>
<p>We have seen how the stablest structures of molecules can be determined by finding the atomic positions for which the forces vanish. In contrast to a molecule, the atomic structure of a crystal is specified by the atomic positions of the atoms inside the unit cell and also by the shape and size of the unit cell. To find the stablest atomic structure of a crystal, a few additional concepts are needed.</p>
<h3 id="stress-and-pressure-in-crystals">Stress and pressure in crystals</h3>
<p>Mathematically, the stress is a rank-2 tensor, i.e. a matrix, <span class="arithmatex">\(\sigma_{ij}\)</span>, defined through the relation  </p>
<div class="arithmatex">\[
F_{i} =  \sigma_{ij}\epsilon_{j}
\]</div>
<details class="tip">
<summary>Tip: what does stress measure and why is it a matrix?</summary>
<p>Stress is the ratio between the <span class="arithmatex">\(i\)</span>-th component of the induced force (e.g. this could be the <span class="arithmatex">\(x\)</span>-component), <span class="arithmatex">\(F_{i}\)</span>, due to a deformation along the <span class="arithmatex">\(j\)</span>-th direction (e.g. in the <span class="arithmatex">\(x\)</span>- or <span class="arithmatex">\(z\)</span>-direction), <span class="arithmatex">\(\epsilon_{j}\)</span>. So it measures how favourable or unfavourable it is to distort the crystal along a certain direction in terms of the induced force along different directions. </p>
<p>This is also why it is a matrix, you need to specify two pieces of information before reading the stress tensor. You need to decide which distortion direction, and which component of the induced force you would like to know from the stress tensor. </p>
</details>
<p>Whereas stress describes the force induced on a crystal due to a distortion along a certain direction, the pressure, <span class="arithmatex">\(P\)</span>, of a crystal measures the change in total energy due to contraction or expansion. The pressure is defined as the negative of the derivative of the PES with respect to the volume, <span class="arithmatex">\(V\)</span>. It measures the tendency of the crystal to expand or contract. Mathematically,  </p>
<div class="arithmatex">\[
P = -\frac{dU}{dV}.
\]</div>
<details class="tip">
<summary>Tip: what does it mean to have a structure with a negative or positive pressure?</summary>
<p>If the pressure is negative, the crystal structure is unstable and will contract. If the pressure is positive, the crystal structure is also unstable but it will expand. The structure is only stable when the pressure is close to zero, as first derivatives of the PES vanish at the equilibrium structure.  </p>
</details>
<p>Having introduced these useful quantities, we can try to calculate these quantities using Quantum Espresso. In the following tasks, we will look at carbon diamond. The unit cell of this crystal contains two carbon atoms. We will first run a single-point calculation for this crystal.  </p>
<div class="admonition example">
<p class="admonition-title">Task 3 - calculating stress and pressure of crystals</p>
<ul>
<li>
<p>Go to the directory <code>03_cd_strpr</code>. Read the input file <code>CD_scf.in</code>. The important parts are shown below.<br />
    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-4-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-4-3">    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;CD&#39;</span>
</span><span id="__span-4-4">    <span class="n">disk_io</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span>
</span><span id="__span-4-5">    <span class="n">tprnfor</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span>
</span><span id="__span-4-6">    <span class="n">tstress</span> <span class="o">=</span> <span class="o">.</span><span class="n">true</span><span class="o">.</span> <span class="c1">#(1)!</span>
</span><span id="__span-4-7"> <span class="o">/</span>
</span><span id="__span-4-8">
</span><span id="__span-4-9"><span class="o">...</span> 
</span><span id="__span-4-10">
</span><span id="__span-4-11"><span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span> <span class="c1">#(2)!</span>
</span><span id="__span-4-12"> <span class="n">C</span> <span class="mf">0.00</span> <span class="mf">0.00</span> <span class="mf">0.00</span>
</span><span id="__span-4-13"> <span class="n">C</span> <span class="mf">0.25</span> <span class="mf">0.25</span> <span class="mf">0.25</span>
</span><span id="__span-4-14">
</span><span id="__span-4-15"><span class="n">K_POINTS</span> <span class="n">automatic</span> <span class="c1">#(3)!</span>
</span><span id="__span-4-16"><span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>This tells Quantum Espresso to print the stress.  </li>
<li>Fractional (or crystal) coordinates are used to specify the atomic positions.      </li>
<li>A k-grid must be specified since we are modelling a crystal.    </li>
</ol>
</li>
<li>
<p>Run <code>pw.x &lt; CD_scf.in &gt; CD.out</code>. </p>
</li>
<li>
<p>Once the job has finished, look for the line saying "total   stress" in the output file. You should see something like this:
    <div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">     <span class="n">Computing</span> <span class="n">stress</span> <span class="p">(</span><span class="n">Cartesian</span> <span class="n">axis</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pressure</span>
</span><span id="__span-5-2">
</span><span id="__span-5-3">          <span class="n">total</span>   <span class="n">stress</span>  <span class="p">(</span><span class="n">Ry</span><span class="o">/</span><span class="n">bohr</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>                   <span class="p">(</span><span class="n">kbar</span><span class="p">)</span>     <span class="n">P</span><span class="o">=</span>     <span class="mf">1325.29</span>
</span><span id="__span-5-4">   <span class="mf">0.00900912</span>  <span class="o">-</span><span class="mf">0.00000000</span>   <span class="mf">0.00000000</span>         <span class="mf">1325.29</span>       <span class="o">-</span><span class="mf">0.00</span>        <span class="mf">0.00</span>
</span><span id="__span-5-5">   <span class="mf">0.00000000</span>   <span class="mf">0.00900912</span>   <span class="mf">0.00000000</span>            <span class="mf">0.00</span>     <span class="mf">1325.29</span>        <span class="mf">0.00</span>
</span><span id="__span-5-6">   <span class="mf">0.00000000</span>   <span class="mf">0.00000000</span>   <span class="mf">0.00900912</span>            <span class="mf">0.00</span>        <span class="mf">0.00</span>     <span class="mf">1325.29</span>
</span></code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>What are the units for the stress tensor?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Ry/Bohr^3. The dimension of this unit is energy per volume, which is the same dimension as pressure. </p>
</details>
<ul>
<li>What is the total pressure? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>1325.29 kbar. Note that kbar is one of the common units for pressure.  </p>
</details>
<ul>
<li>Is the lattice constant optimised? Why? If not, does it want to expand or contract? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>No. The evidence is that <span class="arithmatex">\(P\)</span> is 1325.29 kbar, which is very large (atmospheric pressure is only 1 bar). Since the sign is positive, the lattice wants to expand. </p>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When simulating molecules (or 2D crystals), we use a large supercell with lots of vacuum to avoid artificial interactions between periodic images. When you calculate the stress for such a supercell, you often find that it is large and negative along the direction which separates the periodic images. Of course, this stress is not physically meaningful and should be ignored.  </p>
</div>
</div>
<h3 id="optimizing-lattice-parameters-of-unit-cells">Optimizing lattice parameters of unit cells</h3>
<p>We will now carry out the structural optimisation in carbon diamond to find the equilibrium lattice parameter.      </p>
<div class="admonition note">
<p class="admonition-title">Note on choice of plane-wave cutoff</p>
<p>Keep in mind that you might need a higher plane-wave cutoff to converge the force or the stress (as we saw at the start of this lab). Also, the number of plane waves in your calculation depends on the unit cell volume. So if during the course of the calculation we change the unit cell volume, we also change the number of plane waves; or if we fix the number of plane waves, we are changing the plane-wave cut-off (Quantum Espresso does the latter, but different DFT codes handle this differently). So you need to be quite careful when optimizing lattice vectors.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Task 4 - Optimising the unit cell</p>
<ul>
<li>
<p>Go to the directory <code>04_cd_opt</code> and read the input file <code>CD_opt.in</code>. You'll notice in addition to the inputs mentioned, there's also a fairly high energy cut-off, and we've lowered the SCF convergence threshold from the default. Run this now with <code>pw.x</code>.
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-6-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-6-3">    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;CD&#39;</span>
</span><span id="__span-6-4">    <span class="n">disk_io</span> <span class="o">=</span> <span class="s1">&#39;low&#39;</span>
</span><span id="__span-6-5">    <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;vc-relax&#39;</span> <span class="c1">#(1)!</span>
</span><span id="__span-6-6">    <span class="n">etot_conv_thr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">D</span><span class="o">-</span><span class="mi">9</span> <span class="c1">#(2)!</span>
</span><span id="__span-6-7">    <span class="n">forc_conv_thr</span> <span class="o">=</span> <span class="mf">1.0</span><span class="n">D</span><span class="o">-</span><span class="mi">6</span> <span class="c1">#(3)!</span>
</span><span id="__span-6-8"> <span class="o">/</span>
</span><span id="__span-6-9"> <span class="o">...</span>
</span><span id="__span-6-10"> <span class="o">&amp;</span><span class="n">IONS</span> <span class="c1">#(4)!</span>
</span><span id="__span-6-11"> <span class="o">/</span>
</span><span id="__span-6-12">
</span><span id="__span-6-13"> <span class="o">&amp;</span><span class="n">CELL</span> <span class="c1">#(5)!</span>
</span><span id="__span-6-14"> <span class="o">/</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Tells Quantum Espresso to do a variable-cell (vc) relaxation. </li>
<li>The energy tolerance is stricter than usual. </li>
<li>Specifies the force tolerance. </li>
<li>The IONS section is needed for vc-relaxation too.  </li>
<li>The CELL section is also needed for vc-relaxation.  </li>
</ol>
</li>
<li>
<p>Now inspect the output file. It is very similar to the one for relaxing molecules in task 3. The most important section of the output file is shown below. 
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><span class="n">Begin</span> <span class="n">final</span> <span class="n">coordinates</span>
</span><span id="__span-7-2">     <span class="n">new</span> <span class="n">unit</span><span class="o">-</span><span class="n">cell</span> <span class="n">volume</span> <span class="o">=</span>     <span class="mf">73.86018</span> <span class="n">a</span><span class="o">.</span><span class="n">u</span><span class="o">.^</span><span class="mi">3</span> <span class="p">(</span>    <span class="mf">10.94495</span> <span class="n">Ang</span><span class="o">^</span><span class="mi">3</span> <span class="p">)</span>
</span><span id="__span-7-3">     <span class="n">density</span> <span class="o">=</span>      <span class="mf">3.64456</span> <span class="n">g</span><span class="o">/</span><span class="n">cm</span><span class="o">^</span><span class="mi">3</span>
</span><span id="__span-7-4">
</span><span id="__span-7-5"><span class="n">CELL_PARAMETERS</span> <span class="p">(</span><span class="n">alat</span><span class="o">=</span>  <span class="mf">6.23609621</span><span class="p">)</span> <span class="c1">#(1)!</span>
</span><span id="__span-7-6">  <span class="o">-</span><span class="mf">0.534007441</span>  <span class="o">-</span><span class="mf">0.000000000</span>   <span class="mf">0.534007441</span> 
</span><span id="__span-7-7">  <span class="o">-</span><span class="mf">0.000000000</span>   <span class="mf">0.534007441</span>   <span class="mf">0.534007441</span>
</span><span id="__span-7-8">  <span class="o">-</span><span class="mf">0.534007441</span>   <span class="mf">0.534007441</span>   <span class="mf">0.000000000</span>
</span><span id="__span-7-9">
</span><span id="__span-7-10"><span class="n">ATOMIC_POSITIONS</span> <span class="p">(</span><span class="n">crystal</span><span class="p">)</span>
</span><span id="__span-7-11"><span class="n">C</span>               <span class="o">-</span><span class="mf">0.0000000000</span>        <span class="mf">0.0000000000</span>       <span class="o">-</span><span class="mf">0.0000000000</span>
</span><span id="__span-7-12"><span class="n">C</span>                <span class="mf">0.2500000000</span>        <span class="mf">0.2500000000</span>        <span class="mf">0.2500000000</span>
</span><span id="__span-7-13"><span class="n">End</span> <span class="n">final</span> <span class="n">coordinates</span>
</span></code></pre></div></td></tr></table></div></p>
<ol>
<li>Quantum Espresso expresses the Cartesian components of the new lattice vectors in units of the original lattice parameter <span class="arithmatex">\(a_0\)</span> (called <code>alat</code> here). See the tip box below for how to calculate the new lattice constant.   </li>
</ol>
</li>
</ul>
<details class="success">
<summary>Tip on calculating the new lattice constant</summary>
<p>The most general way to do this is to calculate the magnitude of each lattice vector. For example, the lattice constant along <span class="arithmatex">\(\mathbf{a}_1\)</span> is <span class="arithmatex">\(\frac{a_0}{\sqrt{2}}\times\sqrt{a_{1x}^2+a_{1y}^2+a_{1z}^2}\)</span>. Here <span class="arithmatex">\(a_{1x}=-0.534\)</span>, <span class="arithmatex">\(a_{1y}=0\)</span>, <span class="arithmatex">\(a_{1z}=0.534\)</span>, and <span class="arithmatex">\(a_0=6.236\)</span> Bohrs. Using this method for the remaining two lattice vectors, you should find that the lattice constants are the same along the three directions.  </p>
<p>However, for <code>ibrav=2</code>, there is a simpler way. You can simply calculate the ratio of the new and old Cartesian components of the lattice vectors, and multiply that by the original lattice constant. For example, <span class="arithmatex">\(a_{1x}^{\mathrm{new}}/a_{1x}^{\mathrm{old}}\times a_0\)</span>, here <span class="arithmatex">\(a_{1x}^{\mathrm{old}}=-0.5\)</span>. </p>
</details>
<ul>
<li>What is the final lattice constant? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Using any of the methods from the tip box, the new lattice constant is 6.66 Bohrs, which is 3.53 Å. This is in excellent agreement with the experimental value of 3.57 Å (from Wikipedia).  </p>
</details>
<ul>
<li>How can you check if the lattice parameter is fully relaxed? </li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>The pressure is 0.32 kbar, which is very small.  </p>
</details>
</div>
<div class="admonition warning">
<p class="admonition-title">A word on the final pressure in the output file</p>
<p>The final pressure at the end of the optimisation might appear large occasionally. This is because Quantum Espresso uses the basis set for the original input unit cell to calculate the pressure of the relaxed unit cell. However, if your cell has changed drastically, the adequate basis set for the relaxed unit cell should be recalculated based on the new lattice constant. So you should run a new scf calculation in that case. The artificial pressure due to the inadequacy of the plane-wave basis size is called the Pulay stress. You can look it up if interested.</p>
</div>
<h3 id="bulk-modulus-of-crystals">Bulk modulus of crystals</h3>
<p>From the PES, we can calculate the bulk modulus, B, which measures how difficult it is to compress the material. Mathematically, it is defined as the negative of the second derivative of the PES with respect to volume multiplied by the volume:  </p>
<div class="arithmatex">\[
B = -V\frac{d^2U}{dV^2}.
\]</div>
<p>Whereas Quantum Espresso prints the stress and pressure for you, it does not automatically calculate the bulk modulus. You will need to distort the unit cell volume manually yourself and run multiple <code>pw.x</code> calculations to obtain the PES as function of the unit cell volume. In particular, you will need to change the cell parameter <code>A</code> to change the cell volume. Let's do this in the following task. </p>
<div class="admonition example">
<p class="admonition-title">Task 5 - calculating the bulk modulus using the PES</p>
<ul>
<li>
<p>Go to the directory <code>05_cd_bm</code>. You should find an input file called <code>CD_0.000.in</code>. This is the reference input file representing a diamond structure with a relaxed lattice parameter.  </p>
</li>
<li>
<p>Create 10 copies of this input file, named <code>CD_i.in</code>, where <code>i</code> runs from -0.01 to 0.01 in steps of 0.002. Here <code>i</code> is going to be the fractional change in the lattice constant. </p>
</li>
<li>
<p>Edit the lattice constant in each input file so that the new lattice constant is <span class="arithmatex">\(A'=(1+i)A\)</span>.</p>
</li>
<li>
<p>Run <code>pw.x</code> for each <code>CD_i.in</code>. Note that we carry out a relaxation for each unit cell volume because in principle the equilibrium positions of the atom can be different for different lattice constants.  </p>
</li>
<li>
<p>After the jobs are finished, create a file named <code>data.txt</code>, with the first column containing all the unit cell volumes <span class="arithmatex">\(V\)</span> in Bohr^3, and the second column containing the total energies in Ry. </p>
<details class="success">
<summary>Tip on the finding the unit cell volume</summary>
<p>The unit cell volume is provided in the line <code>unit-cell volume</code>. The units are in Bohr^3. </p>
</details>
</li>
<li>
<p>Run <code>python3 BULK_MOD.py</code>. If you are interested, you can read the code and check out the unit conversions involved in expressing the bulk modulus in units of GPa. This should produce a graph, with a parabola fitted to it and print out a line that says "The bulk modulus is ... GPa."</p>
</li>
<li>
<p>What does the PES look like? </p>
<details class="success">
<summary>Answer</summary>
<p><img alt="BM" src="../assets/bm.png" width="600,align" /></p>
</details>
</li>
<li>
<p>How is the bulk modulus calculated? What is its value for this structure? </p>
<details class="success">
<summary>Answer</summary>
<p>A parabola with the equation <span class="arithmatex">\(ax^2+bx+c\)</span> is first fitted to the data points. The second derivative of this parabola is then simply <span class="arithmatex">\(2a\)</span>. Therefore, the bulk modulus per volume at this structure is <span class="arithmatex">\(-2aV_{0}\)</span>. Here <span class="arithmatex">\(V_0=\frac{1}{2^{3/2}}A_0^3\)</span> with <span class="arithmatex">\(A_0=3.53Å\)</span>. The bulk modulus obtained from the code is -459 GPa. Compared to a literature value of -443 GPa (from Wikipedia), this is in very good agreement. </p>
</details>
</li>
<li>
<p>Read the output file for <code>i</code>=0.01. How many relaxation steps does it take for the calculation to finish? </p>
<details class="success">
<summary>Answer</summary>
<p>None. In this particular setup, through the use of fractional coordinates, the carbon atoms are guaranteed to sit at the high-symmetry positions, so that the net force acting on them vanishes. So for any given volume, the atomic positions are already relaxed. In fact, if you read any other output file, the number of bfgs steps should also be 0.  </p>
</details>
</li>
</ul>
</div>
<!--    ??? tip "Tip on constrained relaxations"
        In the input file shown just now,we have constrained the relaxation to moving one specific component of a specified lattice vector. Constraints like this is very useful especially for low-dimensional systems. If you are interested in what Quantum Espresso can can constrain for you, you can read the input description of `pw.x`. -->

<hr />
<h2 id="summary">Summary</h2>
<p>In this lab we have seen:</p>
<ul>
<li>
<p>How to calculate atomic forces, stress, and pressure in Quantum Espresso. </p>
</li>
<li>
<p>How to check if the forces have converged.</p>
</li>
<li>
<p>How to optimise the structure of molecules, atomic positions in a crystal, and the lattice parameter of a crystal. </p>
</li>
<li>
<p>How the PES allows us to estimate the bulk modulus.</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>