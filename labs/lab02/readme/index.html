
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MATE70020.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab01/readme/">
      
      
        <link rel="next" href="../../lab03/readme/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lab 2 - Quantum Espresso Input and Output for Molecules - Modeling Materials with Density Functional Theory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#quantum-espresso-input-and-output-for-molecules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-header__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Modeling Materials with Density Functional Theory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 2 - Quantum Espresso Input and Output for Molecules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-nav__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    Modeling Materials with Density Functional Theory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 - Getting Started in Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Quantum Espresso Input and Output for Molecules
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Quantum Espresso Input and Output for Molecules
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-and-examining-the-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running and examining the calculation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualisation-vesta" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualisation - VESTA
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methane-ethane-and-ethene" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methane, ethane and ethene
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c_20-isomers" class="md-nav__link">
    <span class="md-ellipsis">
      
        C\(_{20}\) isomers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 - Convergence Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 4 - Crystals and the Electronic Band Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab05/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Metals and the Density of States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab06/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Spin Polarization and Magnetic Systems
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab07/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Structural Optimisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab08/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 8 - Vibrational Normal Modes and Phonons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 9 - Finite Temperature Properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#input-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Files
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-and-examining-the-calculation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running and examining the calculation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualisation-vesta" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualisation - VESTA
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#methane-ethane-and-ethene" class="md-nav__link">
    <span class="md-ellipsis">
      
        Methane, ethane and ethene
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#c_20-isomers" class="md-nav__link">
    <span class="md-ellipsis">
      
        C\(_{20}\) isomers
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="quantum-espresso-input-and-output-for-molecules">Quantum Espresso Input and Output for Molecules</h1>
<p>This week you will run some DFT calculations for molecules and small atomic clusters using the Quantum Espresso software. We will focus on understanding the format of input files and output files that you will need for the rest of the course.</p>
<p>Quantum Espresso is used via the command line. There is no graphical user interface by default, which is typical of most electronic structure codes. If you can't remember how to do something using the command line, you can always refer back to <a href="../../lab01/readme/">Lab 1</a>.</p>
<div class="admonition example">
<p class="admonition-title">Task 1 - Copy Input Files</p>
<p>In lab 1 you should have created a directory named <code>MSE404-MM</code> in your home directory.</p>
<ul>
<li>Check this by issuing the command <code>cd ~</code> followed by <code>ls</code>.</li>
<li>Copy the input files from <code>/opt/MSE404-MM/docs/labs/lab02</code> to your <code>MSE404-MM</code> folder. Remember you need to pass an additional flag to <code>cp</code> to copy a directory. If you are struggling with this, revisit <a href="../../lab01/readme/">Lab 1</a>.</li>
<li>Copy the directory containing the pseudopotentials that you will be using during this course to your <code>MSE404-MM</code> directory. These are stored in <code>/opt/MSE404-MM/docs/labs/pseudo</code></li>
</ul>
</div>
<p>You should now have the directories <code>lab02</code> and <code>pseudo</code> within your <code>MSE404-MM</code> directory. These contain a set of basic input files for a variety of systems and the pseudopotentials for the input files.</p>
<h2 id="input-files">Input Files</h2>
<p>Before running a DFT calculation we need to create the input files. These input files give instructions to Quantum Espresso to tell it what we want to calculate, and what parameters to use for the calculation. The first example we will be looking at is in the <code>01_methane</code> directory. In this directory there is an input file for the <code>pw.x</code> module of Quantum Espresso which calculates the total energy of your system.</p>
<p>Let's take a look at our first input file <a href="../01_methane/CH4.in">CH4.in</a>.</p>
<div class="admonition tip annotate">
<p class="admonition-title">Tip: In-code annotations</p>
<p>Click (1) to see notes on the input tags.</p>
</div>
<ol>
<li>This is an annotation</li>
</ol>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><span class="p">&amp;</span>CONTROL<span class="w"> </span><span class="c1">#(1)!</span>
</span><span id="__span-0-2"><span class="w">    </span><span class="nv">pseudo_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="c1">#(2)!</span>
</span><span id="__span-0-3">/
</span><span id="__span-0-4">
</span><span id="__span-0-5"><span class="p">&amp;</span>SYSTEM
</span><span id="__span-0-6"><span class="w">    </span><span class="nv">ibrav</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c1">#(3)!</span>
</span><span id="__span-0-7"><span class="w">    </span><span class="nv">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span>.0<span class="w"> </span><span class="c1">#(4)!</span>
</span><span id="__span-0-8"><span class="w">    </span><span class="nv">nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="c1">#(5)!</span>
</span><span id="__span-0-9"><span class="w">    </span><span class="nv">ntyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="c1">#(6)!</span>
</span><span id="__span-0-10"><span class="w">    </span><span class="nv">ecutwfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span>.0<span class="w"> </span><span class="c1">#(7)!</span>
</span><span id="__span-0-11">/
</span><span id="__span-0-12">
</span><span id="__span-0-13"><span class="p">&amp;</span>ELECTRONS
</span><span id="__span-0-14">/
</span><span id="__span-0-15">
</span><span id="__span-0-16">ATOMIC_SPECIES
</span><span id="__span-0-17"><span class="w"> </span>C<span class="w">  </span><span class="m">12</span>.011<span class="w">  </span>C.pz-vbc.UPF<span class="w"> </span><span class="c1">#(8)!</span>
</span><span id="__span-0-18"><span class="w"> </span>H<span class="w">   </span><span class="m">1</span>.008<span class="w">  </span>H.pz-vbc.UPF
</span><span id="__span-0-19">
</span><span id="__span-0-20">ATOMIC_POSITIONS<span class="w"> </span>angstrom<span class="w"> </span><span class="c1">#(9)!</span>
</span><span id="__span-0-21">C<span class="w"> </span><span class="m">7</span>.2433205<span class="w"> </span><span class="m">7</span>.5<span class="w"> </span><span class="m">7</span>.137
</span><span id="__span-0-22">H<span class="w"> </span><span class="m">7</span>.2433205<span class="w"> </span><span class="m">7</span>.5<span class="w"> </span><span class="m">8</span>.225999999999999
</span><span id="__span-0-23">H<span class="w"> </span><span class="m">8</span>.2700395<span class="w"> </span><span class="m">7</span>.5<span class="w"> </span><span class="m">6</span>.773999999999999
</span><span id="__span-0-24">H<span class="w"> </span><span class="m">6</span>.729960500000001<span class="w"> </span><span class="m">6</span>.610835<span class="w"> </span><span class="m">6</span>.773999999999999
</span><span id="__span-0-25">H<span class="w"> </span><span class="m">6</span>.729960500000001<span class="w"> </span><span class="m">8</span>.389165<span class="w"> </span><span class="m">6</span>.773999999999999
</span><span id="__span-0-26">
</span><span id="__span-0-27">K_POINTS<span class="w"> </span>gamma<span class="w"> </span><span class="c1">#(10)!</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li>Quantum Espresso input files are ordered with 'tags'. These 'tags' start with a <code>&amp;</code> and end with a <code>/</code>. They are blocks of input parameters.</li>
<li>Directory containing your pseudopotentials defined later in the input file. The directory <code>.</code> means the current directory. </li>
<li>Bravais lattice type e.g. simple cubic, face centered cubic etc. These are documented on the <a href="https://www.quantum-espresso.org/documentation/input-data-description/">Quantum Espresso input description page</a>. You will get familiar with this throughout the course. ibrav = 1 is a simple cubic lattice.</li>
<li>Crystallographic constant i.e. cell vector length. Simple cubic with A=15 means a 15x15x15 Å box. </li>
<li>Number of atoms.</li>
<li>Number of species.</li>
<li>Energy cutoff for wavefunction expansion. You will learn more about this in your lectures and <a href="../../lab03/readme/">Lab 3</a></li>
<li>Atomic species, atomic mass and the name of the pseudopotential file.</li>
<li>Below this tag are the atomic positions of your atoms. The <code>angstrom</code> after <code>ATOMIC_POSITIONS</code> specifies these are in cartesian coordinates in units of Å.</li>
<li>K-points are wave vectors of electrons. As we are interested in bound electronic states of molecules in this lab, we are using k=(0,0,0). This k-point is also known as the Gamma point.</li>
</ol>
<p>Later we will learn how to visualise the structure, but for now, here is how our methane molecule looks:</p>
<figure>
<img alt="methane" src="../assets/methane.png" width="900" />
</figure>
<div class="admonition example">
<p class="admonition-title">Task 2 - Alternative Input File Style</p>
<p>Take a look at the input file in the <code>01a_methane</code> directory.</p>
<ul>
<li>How is this different from the input file discussed above?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>ibrav is now set to 0. This means 'free cell' meaning the user needs to specify the cell parameters manually. The parameter defining the cell vector length is not present. There is also a section called <code>CELL_PARAMETERS</code>.</p>
</details>
<ul>
<li>Will this input file do the exact same thing as the one in <code>01_methane</code>?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Yes! Instead of specifying the cell vector length we have just specified the length of each cell vector in the <code>CELL_PARAMETERS</code> section. </p>
</details>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning - Periodic Boundary Conditions and Molecules</p>
<p>Quantum Espresso uses periodic boundary conditions. In other words: we are not modelling a single molecule, but instead an infinite cubic crystal of molecules. In order to avoid interactions between molecules in the different unit cells of this crystal, we have to make the lattice constant of the crystal sufficiently large. Otherwise we might not get the correct description of an isolated molecule. </p>
</div>
<h2 id="running-and-examining-the-calculation">Running and examining the calculation</h2>
<p>The Quantum Espresso package has been compiled as a module on the server as discussed in <a href="../../lab01/readme/">Lab 1</a>. Modules are often used on High Performance Computing (HPC) systems to make different versions of packages available to users.
In order to be able to run a Quantum Espresso calculation, it must first be loaded to your environment. This can be done by issuing the command</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1">module<span class="w"> </span>load<span class="w"> </span>quantum-espresso
</span></code></pre></div></td></tr></table></div>
<p>This will load Quantum Espresso and any other modules that Quantum Espresso needs to run.</p>
<div class="admonition example">
<p class="admonition-title">Task 3 - Running a calculation</p>
<p>To run the first calculation of the day, make sure you have loaded Quantum Espresso to your environment as discussed above.</p>
<ul>
<li>
<p>Navigate back to the <code>01_methane</code> directory.</p>
</li>
<li>
<p>Issue the command 
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">pw.x<span class="w"> </span>&lt;<span class="w"> </span>CH4.in<span class="w"> </span>&gt;<span class="w"> </span>CH4.out
</span></code></pre></div></td></tr></table></div></p>
</li>
</ul>
</div>
<p>After the calculation has finished take a look at the files created in your directory. You should have a file named <code>pwscf.xml</code> and a new directory named <code>pwscf.save</code>.</p>
<ul>
<li><code>pwscf.xml</code> contains the results of the pw.x calculation in xml format. This format is both human-readable and machine-readable and facilitates the storing, transmitting and reconstructing of data.</li>
<li><code>pwscf.save</code> is a directory which contains: <ul>
<li>A copy of <code>pwscf.xml</code>.</li>
<li>A copy of the pseudopotential files used in the calculation.</li>
<li>A file in which the charge density stored. </li>
<li>Wavefunction files which are stored in binary format (and thus are not human readable). These can be used as inputs to other calculations.</li>
</ul>
</li>
</ul>
<p>Now that we have run the calculation for methane, we should examine the output file <code>CH4.out</code>, which is where we instructed Quantum Espresso to pipe the output of the pw.x calculation.
Using the command
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1">less<span class="w"> </span>CH4.out
</span></code></pre></div></td></tr></table></div>
we can look at the output file. Output files are generally structured as follows:</p>
<ul>
<li>Beginning: important information about the system including parameters used in the calculation.</li>
<li>Middle: actual DFT calculation.</li>
<li>End: final results like total energy, orbital energies, etc.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Task 4 - Examining an output file</p>
<p>Using the <code>less</code> command specified above</p>
<ul>
<li>How many valence electrons were in your calculation?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>8.00. This is found at the top of your output file.
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">number<span class="w"> </span>of<span class="w"> </span><span class="nv">electrons</span><span class="w">       </span><span class="o">=</span><span class="w">         </span><span class="m">8</span>.00
</span></code></pre></div></td></tr></table></div></p>
</details>
<ul>
<li>How many iterations did your calculation go through to find the solution?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>9 scf cycles. This is found on the line:
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1">convergence<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>achieved<span class="w"> </span><span class="k">in</span><span class="w">   </span><span class="m">9</span><span class="w"> </span>iterations
</span></code></pre></div></td></tr></table></div></p>
</details>
<ul>
<li>What is the total energy of the methane molecule?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p><span class="arithmatex">\(E_{\text{Tot}} = -15.49833140 \, \text{Ry}\)</span>. This is found on the line:
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">!<span class="w">    </span>total<span class="w"> </span><span class="nv">energy</span><span class="w">              </span><span class="o">=</span><span class="w">     </span>-15.49833140<span class="w"> </span>Ry
</span></code></pre></div></td></tr></table></div>
Notice the converged total energy will always have a <code>!</code> at the beginning of the line.</p>
</details>
<ul>
<li>What accuracy is your calculation converged to?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>0.00000064 Ry. This is found on the line:
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1">estimated<span class="w"> </span>scf<span class="w"> </span>accuracy<span class="w">    </span>&lt;<span class="w">       </span><span class="m">0</span>.00000064<span class="w"> </span>Ry
</span></code></pre></div></td></tr></table></div>
We did not specify this in the input file. The default value of below 1E-6 was therefore used.</p>
</details>
<ul>
<li>How many Kohn-Sham energy eigenvalues were calculated?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>4 Kohn-Sham energy eigenvalues were calculated. This is found in the lines:
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1">End<span class="w"> </span>of<span class="w"> </span>self-consistent<span class="w"> </span>calculation
</span><span id="__span-8-2">
</span><span id="__span-8-3"><span class="nv">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>.0000<span class="w"> </span><span class="m">0</span>.0000<span class="w"> </span><span class="m">0</span>.0000<span class="w"> </span><span class="o">(</span><span class="w"> </span><span class="m">14712</span><span class="w"> </span>PWs<span class="o">)</span><span class="w">   </span>bands<span class="w"> </span><span class="o">(</span>ev<span class="o">)</span>:
</span><span id="__span-8-4">
</span><span id="__span-8-5">-17.3307<span class="w">  </span>-9.3182<span class="w">  </span>-9.3176<span class="w">  </span>-9.3173
</span></code></pre></div></td></tr></table></div></p>
</details>
</div>
<div class="admonition note">
<p class="admonition-title">Electrons and Energy Eigenvalues</p>
<p>Note that in this calculation we had 8 valence electrons but only 4 energy eigenvalues were calculated. This is because - according to the Pauli principle - each Kohn-Sham state can accommodate 2 electrons. </p>
</div>
<div class="admonition example">
<p class="admonition-title">Task 5 - Alternative Input File</p>
<p>Navigate to the directory <code>01a_methane</code>. </p>
<ul>
<li>Run the same calculation as in Task 4 and confirm that you get the same results.</li>
</ul>
</div>
<h2 id="visualisation-vesta">Visualisation - VESTA</h2>
<p>Interactive visualisation software is crucial in computational physics. Not only can it be used to check the atomic structure, but it is also very useful for looking at the charge density and wavefunctions generated by DFT calculation. You will learn more about this in <a href="../../lab05/readme/">Lab 5</a>. The visualisation software we are going to use in this course is called <a href="https://jp-minerals.org/vesta/en/">VESTA</a>.</p>
<p>VESTA, like Quantum Espresso, can be loaded as a module. To use it you will need to issue the command:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1">module<span class="w"> </span>load<span class="w"> </span>vesta
</span></code></pre></div></td></tr></table></div>
<p>You have now loaded VESTA to your environment. By default, VESTA cannot read Quantum Espresso input files. Therefore, we will need to convert the input files to a format that VESTA can read. To do this we are going to use another module <code>c2x</code>. To use it you will need to issue the command:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1">module<span class="w"> </span>load<span class="w"> </span>c2x
</span></code></pre></div></td></tr></table></div>
<p>This allows us to convert the Quantum Espresso .in file into a .cif file that VESTA can read. To do this, issue the command:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1">c2x<span class="w"> </span>--cif<span class="w"> </span>CH4.in<span class="w"> </span>CH4.cif
</span></code></pre></div></td></tr></table></div>
<p>You will now see a .cif file in your directory. VESTA can visualise this file. You can do this with the command:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1">vesta<span class="w"> </span>CH4.cif
</span></code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">.cif Files</p>
<p>A .cif file is a Crystallographic Information File and is a standard text file format used to describe the structure of crystalline materials. The .cif file usually contains atomic positions, symmetry operations, lattice vectors etc. They are very useful for materials modellers since it is a standardised format. Additionally, .cif files are commonly used to store experimental crystallographic data, so they can be used to generate input files using experimentally measured atomic structures.</p>
</div>
<p>During this lab we will be working with different molecules. It will be a good exercise to visualise them as we go along.</p>
<h2 id="methane-ethane-and-ethene">Methane, ethane and ethene</h2>
<p>Now we have understood the basics of the Quantum Espresso input file, technically the scf input file, let's try some other molecules. We have been looking at Methane (CH4), so we can go up one step and look at ethane (C2H6)</p>
<figure>
<img alt="ethane" src="../assets/ethane.png" width="900" />
</figure>
<p>and then ethene (C2H4).</p>
<figure>
<img alt="ethene" src="../assets/ethene.png" width="900" />
</figure>
<p>The only thing that is going to change in our input files are the number of atoms and the atomic positions. The input files <a href="../02_ethane/C2H6.in">C2H6.in</a> and <a href="../03_ethene/C2H4.in">C2H4.in</a> have been made for you in the directories <code>02_ethane</code> and <code>03_ethene</code> respectively.</p>
<p>We can use the <code>diff</code> command to check for differences between two file. To see the changes made in the ethane input file relative to the one for methane that we have been working on, use the diff command. If you are in the <code>lab02</code> directory then this can be done using the command:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1">diff<span class="w"> </span>01_methane/CH4.in<span class="w"> </span>02_ethane/C2H6.in
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 6 - Running and Visualising Structures</p>
<p>We want to visualise all three molecules; methane, ethane and ethene to see the structural differences. We then want to run a total energy calculation and finally do some post processing to look at the charge density and the wavefunction.</p>
<ul>
<li>
<p>Using <code>c2x</code> and <code>vesta</code>, visualise the structures for methane, ethane and ethene yourself.</p>
</li>
<li>
<p>Run a DFT calculation for ethane and ethene using <code>pw.x</code> as you did for methane. How do the energy eigenvalues compare between the molecules?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>The eigenvalues are printed in eV. Methane, ethane and ethene have a different number of eigenvalues as shown below.</p>
<p>Methane:    -17.3307  -9.3182  -9.3176  -9.3173</p>
<p>Ethane:    -18.9981 -15.1568 -10.4905 -10.4893  -9.0301  -7.7951  -7.7936</p>
<p>Ethene:    -19.2564 -14.3120 -11.4232  -9.9431  -8.1807  -6.8756</p>
<ul>
<li>Methane has 8 electrons in the calculation, therefore 4 doubly occupied states and 4 eigenvalues.</li>
<li>Ethane has 14 electrons in the calculation, therefore 7 doubly occupied states and 7 eigenvalues.</li>
<li>Ethene has 12 electrons in the calculation, therefore 6 doubly occupied states and 6 eigenvalues.</li>
</ul>
</details>
<ul>
<li>A common mistake in DFT calculations is the use of incorrect units. In the example <code>03_ethene</code>, the atomic positions are defined in Bohr. Try changing the units in ATOMIC_POSITIONS from bohr to angstrom. Rerun pw.x. What happens?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>Convergence was not achieved in 100 iterations.</p>
</details>
</div>
<p>As mentioned above, we can do some post-processing of our DFT calculation to write desired quantities, like the electron charge density, or the probability density <span class="arithmatex">\(|\psi|^2\)</span> (wavefunctions) etc. to files in a suitable format for visualisation / plotting. A comprehensive list of quantities Quantum Espresso can generate via the built-in post-processing tool <code>pp.x</code> can be found <a href="https://www.quantum-espresso.org/Doc/INPUT_PP.html#idm74">here</a>. This is used in a very similar way to <code>pw.x</code>:</p>
<div class="language-bash highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1">pp.x<span class="w"> </span>&lt;<span class="w"> </span>pp.in<span class="w"> </span>&gt;<span class="w"> </span>pp.out
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 7 - Post Processing and Visualisation</p>
<p>We now want to perform some post-processing on our ethane molecule. Specifically we wish to visualise the charge density and one of the Kohn-Sham states our electrons are occupying. Since we are calculating ethane at the gamma point, the wavefunction can be made purely real, and this allows us to plot the sign of the wavefunction as well.</p>
<ul>
<li>
<p>Return to the <code>02-ethane/</code> directory and run the post-processing for the charge density using <code>pp.x</code> on the <code>pp_chg.in</code> file. The <code>.cube</code> file produced can directly be visualised using VESTA.</p>
</li>
<li>
<p>Now try to visualise one of the Kohn-Sham states using <code>pp_wfc.in</code>. The <code>.cube</code> file produced can be visualised directly using VESTA. Try to plot the next band and visualise it. Why is this state higher in energy?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>The plot for kband=1 showed the same sign of the wavefunction with 0 nodes. This corresponds to a bonding orbital. The plot for kband=2 showed different signs of the wavefunction with a node in the center which represents the antibonding orbital. Antibonding orbital is higher in energy than a bonding orbital.</p>
</details>
</div>
<h2 id="c_20-isomers">C<span class="arithmatex">\(_{20}\)</span> isomers</h2>
<p>The total energy of a molecule often isn't that useful by itself. In fact, our calculations use pseudopotentials and therefore cannot produce accurate values for the total energy. However, <strong><em>differences</em></strong> of total energies between, say, different isomers of a given molecule are much more useful.</p>
<p>In general (ignoring effects of e.g. temperature), if we compare total energies of isomers, a lower total energy indicates that an isomer is more stable.
As an example, we will investigate three different isomers of 
C<span class="arithmatex">\(_{20}\)</span>:</p>
<ul>
<li>C<span class="arithmatex">\(_{20}\)</span> in a bowl structure</li>
</ul>
<figure>
<img alt="bowl" src="../assets/c20_bowl.png" width="900" />
</figure>
<ul>
<li>C<span class="arithmatex">\(_{20}\)</span> in a ring structure</li>
</ul>
<figure>
<img alt="ring" src="../assets/c20_ring.png" width="900" />
</figure>
<ul>
<li>C<span class="arithmatex">\(_{20}\)</span> in a cage structure.</li>
</ul>
<figure>
<img alt="cage" src="../assets/c20_cage.png" width="900" />
</figure>
<p>If you are wondering if this is a calculation people really do, <a href="https://pubs.acs.org/doi/10.1021/acs.jpca.5b10266">here is an article doing this exact calculation</a></p>
<div class="admonition example">
<p class="admonition-title">Task 8 - Total Energy of Isomers</p>
<ul>
<li>
<p>Run the inputs for the three different isomers in <code>04_c20_bowl</code>, <code>05_c20_ring</code> and <code>06_c20_cage</code></p>
</li>
<li>
<p>Which isomer has the lowest total energy?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p><span class="arithmatex">\(E_{\text{Tot}}^{\text{Bowl}} = -218.12237988 \,\text{Ry}\)</span></p>
<p><span class="arithmatex">\(E_{\text{Tot}}^{\text{Ring}} = -217.76506479 \,\text{Ry}\)</span></p>
<p><span class="arithmatex">\(E_{\text{Tot}}^{\text{Cage}} = -218.37740806 \,\text{Ry}\)</span></p>
<p>Using <span class="arithmatex">\(E_{\text{Tot}}^{\text{Cage}}\)</span> as a reference, we can calculate the energy differences between the structures. Doing so we can see that the the cage structure has the lowest energy.</p>
</details>
<ul>
<li>What does it mean to have the lowest total energy of the three isomers? What conclusions about stability can we draw from these calculations?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>The lowest energy typically means that the structure is the most stable. However, these energies are very close, so it is hard to draw conclusions based on these calculations. Additionally, one can compare the energy differences between the structures to <span class="arithmatex">\(k_BT\)</span> at room temperature, <span class="arithmatex">\(25\)</span> meV. If the energy difference between the structures is within <span class="arithmatex">\(25\)</span> meV of one another, then the structures are degenerate and no conclusions about stability can be drawn.</p>
</details>
</div>
<p>You will notice that the three isomers are very close in total energy. Maybe we can find some other isomers with even lower energies. For example, we can try an amorphous structure.</p>
<figure>
<img alt="amorphous" src="../assets/c20_amorphous.png" width="900" />
</figure>
<p>Or a "smiley" face :-).</p>
<figure>
<img alt="smile" src="../assets/c20_smile.png" width="900" />
</figure>
<div class="admonition example">
<p class="admonition-title">Task 9 - Amorphous and Unrealistic Calculation</p>
<ul>
<li>Run the inputs for the amorphous structure found in <code>07_c20_amorphous</code>. How does the energy compare to the three isomers above? Is this what you expect?</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p><span class="arithmatex">\(E_{\text{Tot}}^{\text{Amorphous}} = -217.09834389 \,\text{Ry}\)</span></p>
<p>Again, comparing this to <span class="arithmatex">\(E_{\text{Tot}}^{\text{Cage}}\)</span> we can see that this has the highest energy of the three isomers. This is expected as amorphous structures are typically higher in energy due to their disorder.</p>
</details>
<p>Finally we can run a calculation for the smiley face.</p>
<ul>
<li>
<p>Navigate to <code>08_c20_smile</code> and visualise the structure. </p>
</li>
<li>
<p>Run a DFT calculation and compare the total energies to your previous results for the other isomers. Is this what we expect?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p><span class="arithmatex">\(E_{\text{Tot}}^{\text{Smile}} = -216.92843483 \,\text{Ry}\)</span></p>
<p>This is even higher than that of the amorphous structure. This is expected as this is a totally unrealistic structure and we do not expect it to be stable.</p>
</details>
</div>
<p>In the paper linked above it was shown that the relative energies of the ring, cage and bowl structure are very sensitive to the details of the approach used. For these systems using just DFT it is hard to say with certainty which is the most stable isomer.
However, comparing to less realistic structures we can see the difference in energy between structures which should be stable and which should not be stable, which is very valuable information.</p>
<div class="admonition warning">
<p class="admonition-title">Convergence Issues</p>
<p>If you were to use a structure which more closely resembled a smiley face, Quantum Espresso would be unable to reach convergence within 100 iterations, just as when we used the wrong units for ethene. 
If you encounter a problem with convergence, the first thing you should check is whether or not the input structure is sensible which underlines the importance of visualising your structures before you run calculations!</p>
</div>
<hr />
<h2 id="summary">Summary</h2>
<p>In this lab we have looked at how to create input files and examine the output files for some different molecules:</p>
<ul>
<li>Methane</li>
<li>Ethane</li>
<li>Ethene</li>
<li>Different isomers of C<span class="arithmatex">\(_{20}\)</span></li>
</ul>
<p>We have also learned how to use VESTA to visualise our structures with the help of the <code>c2x</code>.</p>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>