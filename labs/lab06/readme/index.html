
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Labs for MATE70020.">
      
      
        <meta name="author" content="Johannes Lischner">
      
      
      
        <link rel="prev" href="../../lab05/readme/">
      
      
        <link rel="next" href="../../lab07/readme/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Lab 6 - Spin Polarization and Magnetic Systems - Modeling Materials with Density Functional Theory</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spin-polarization-and-magnetic-systems" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-header__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Modeling Materials with Density Functional Theory
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Lab 6 - Spin Polarization and Magnetic Systems
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Modeling Materials with Density Functional Theory" class="md-nav__button md-logo" aria-label="Modeling Materials with Density Functional Theory" data-md-component="logo">
      
  <img src="../../../assets/IMPV2.svg" alt="logo">

    </a>
    Modeling Materials with Density Functional Theory
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ImperialCollegeLondon/MSE404-MM" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    ImperialCollegeLondon/MSE404-MM
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Labs
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab01/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 1 - Getting Started in Linux
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab02/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 2 - Quantum Espresso Input and Output for Molecules
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab03/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 3 - Convergence Testing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab04/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 4 - Crystals and the Electronic Band Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab05/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 5 - Metals and the Density of States
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Spin Polarization and Magnetic Systems
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 6 - Spin Polarization and Magnetic Systems
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spin-polarization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spin Polarization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-oxygen-molecule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Oxygen Molecule
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iron" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iron
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab07/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 7 - Structural Optimisation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab08/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 8 - Vibrational Normal Modes and Phonons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../lab09/readme/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lab 9 - Finite Temperature Properties
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#spin-polarization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Spin Polarization
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-oxygen-molecule" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Oxygen Molecule
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iron" class="md-nav__link">
    <span class="md-ellipsis">
      
        Iron
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="spin-polarization-and-magnetic-systems">Spin Polarization and Magnetic Systems</h1>
<p>This week we'll cover the topic of spin-polarized systems. For metals, there are
a couple of complications which mean we have to treat them differently from
systems with a non-zero band gap. </p>
<p>As before, all inpus and scripts you need can be found in
<code>/opt/MSE404-MM/docs/labs/lab06</code> and you should make a copy of the folder to
your home directory.</p>
<!-- <div markdown="span" style="margin: 0 auto; text-align: center"> -->
<!-- [Download the input files for this tutorial](./assets/lab08_input.zip){ .md-button .md-button--primary } -->
<!-- </div> -->

<hr />
<h2 id="spin-polarization">Spin Polarization</h2>
<p>Until now we have assumed that the electronic states are the same for up-spin
and down-spin electrons: in other words, we assumed that each state can be
occupied by two electrons. In a magnetic system, however, the electronic
wavefunctions (and the corresponding Kohn-Sham energies) can be different for
electrons with different spins. </p>
<h2 id="the-oxygen-molecule">The Oxygen Molecule</h2>
<p>An oxygen molecule has an even number of electrons.So you might expect that a
certain number of Kohn-Sham states are filled with two electrons and therefore
the total number of up-spin electrons is equal to the total number of down-spin
electrons. This is, however, not true. </p>
<p><img align="right" alt="MO" src="../assets/Mo_diagram.svg" style="width:250px" /></p>
<p>When the two oxygen atoms are sufficiently close to each other so that their
atomic orbitals start to overlap, new states - called molecular orbitals - are
formed. These are called <span class="arithmatex">\(\sigma_s\)</span>, <span class="arithmatex">\(\sigma_s^*\)</span>, <span class="arithmatex">\(\sigma_z\)</span>, <span class="arithmatex">\(\pi_x\)</span>, <span class="arithmatex">\(\pi_y\)</span>
and so on. As a consequence of the symmetry properties that the molecule
possesses, some of the molecular orbitals have the same energies. In Quantum
Mechanics, such wavefunctions are called degenerate. You can see from the
molecular orbital diagram below that the <span class="arithmatex">\(\pi_x\)</span> and <span class="arithmatex">\(\pi_y\)</span> orbitals are
degenerate and also the <span class="arithmatex">\(\pi_x^*\)</span> and the <span class="arithmatex">\(\pi_y^*\)</span> orbitals have the same
energy.   </p>
<p>When we fill these molecular orbitals with electrons, we end up with two
electrons that we can distribute in the <span class="arithmatex">\(\pi_x^*\)</span> and <span class="arithmatex">\(\pi_y^*\)</span> orbitals. It
turns out that the repulsive interaction between electrons favors a state in
which the two electrons sit in different molecular orbitals, but have the same
spin. This is known as Hund's Rule. Note that a similar situation occurs in an
isolated oxygen atom.</p>
<p>The directory <code>01_O2</code> contains an input file to calculate the total energy of
the oxygen molecule at the experimentally measured bond length. Here the
calculation has been set up exactly as you've seen in the past (i.e., assuming
doubly degenerate band occupation without smearing or spin polarization):</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-0-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-0-3"> <span class="o">/</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-0-6">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-7">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-0-8">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-0-9">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-0-10">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-0-11">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-0-12"> <span class="o">/</span>
</span><span id="__span-0-13">
</span><span id="__span-0-14"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-0-15"> <span class="o">/</span>
</span><span id="__span-0-16">
</span><span id="__span-0-17"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-0-18"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-0-19">
</span><span id="__span-0-20"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-0-21"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-0-22"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-0-23">
</span><span id="__span-0-24"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 1.1 - Assming Spin Degenerate Insulator</p>
<p>Try running the calculation in this directory. Does it converge?</p>
<details class="success">
<summary>Answer</summary>
<p>While it's possible that the system may randomly meet the convergence
criteria in the self-consistent cycle, this calculation will most likely
not converge. If you look at the estimate accuracy at the end of each
iteration in the output, it will likely vary from step to step, rather
than steadily decreasing as in a well-behaved calculation.</p>
</details>
</div>
<p>To help converge the system, we can smear the occupancies (as we do in a DFT
calculation for a metal). This will allow the system to converge. The relevant
input variables are the ones highlighed below:</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-1-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-1-3">    <span class="n">verbosity</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span>
</span><span id="__span-1-4"> <span class="o">/</span>
</span><span id="__span-1-5">
</span><span id="__span-1-6"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-1-7">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-1-8">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-1-9">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-1-10">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-1-11">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-1-12">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-1-13"><span class="hll">   <span class="n">occupations</span> <span class="o">=</span> <span class="s1">&#39;smearing&#39;</span> 
</span></span><span id="__span-1-14"><span class="hll">   <span class="n">smearing</span> <span class="o">=</span> <span class="s1">&#39;fermi-dirac&#39;</span>
</span></span><span id="__span-1-15"><span class="hll">   <span class="n">degauss</span> <span class="o">=</span> <span class="mf">0.1</span><span class="n">d0</span>
</span></span><span id="__span-1-16"> <span class="o">/</span>
</span><span id="__span-1-17">
</span><span id="__span-1-18"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-1-19"> <span class="o">/</span>
</span><span id="__span-1-20">
</span><span id="__span-1-21"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-1-22"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-1-23">
</span><span id="__span-1-24"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-1-25"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-1-26"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-1-27">
</span><span id="__span-1-28"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<div class="admonition example">
<p class="admonition-title">Task 1.2 - Assuming Spin Degenerate Metal</p>
<p>Create a copy of the <code>01_O2</code> directory called <code>01_O2_metal</code>. Modify the
input file in it to use a metallic occupation scheme with a small smearing
width and run the calculation (as above). </p>
<ul>
<li>
<p>Does the calculation now converge?</p>
</li>
<li>
<p>Take a look at the log file, are the occupations of each band at each 
  k-point matche your expectations?</p>
</li>
</ul>
<details class="success">
<summary>Answer</summary>
<p>There are a few states which are completely filled with electrons and
then there are two states which are half-filled (i.e. one electron per
state). The last state is almost empty.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1">          k = 0.0000 0.0000 0.0000 ( 26462 PWs)   bands (ev):
</span><span id="__span-2-2">
</span><span id="__span-2-3">   -27.9544 -21.2930 -12.5056 -11.0340 -11.0340  -7.4591  -7.4591  -2.9357
</span><span id="__span-2-4">
</span><span id="__span-2-5">     occupation numbers
</span><span id="__span-2-6">     1.0000   1.0000   0.9800   0.9433   0.9433   0.5460   0.5460   0.0415
</span></code></pre></div></td></tr></table></div>
</details>
</div>
<p>While treating this system as a metal may help converging the calculation, it
may not necessarily reach the true ground state (i.e. the state with the lowest
total energy). This is because we have imposed that there is an equal number of
up-spin and down-spin electrons, and treating the system as an metal allows the
electrons to occupy higher energy states. A better way to describe the system is
to allow different numbers of spin-up and spin-down electrons (i.e., doing a
spin-polarized calculation), we can perform a spin-polarized calculation by
adding the <code>nspin</code> and <code>tot_magnetization</code> variables to the input file
(highlighted below):</p>
<div class="language-python highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"> <span class="o">&amp;</span><span class="n">CONTROL</span>
</span><span id="__span-3-2">    <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span>
</span><span id="__span-3-3">    <span class="n">verbosity</span> <span class="o">=</span> <span class="s1">&#39;high&#39;</span>
</span><span id="__span-3-4"> <span class="o">/</span>
</span><span id="__span-3-5">
</span><span id="__span-3-6"> <span class="o">&amp;</span><span class="n">SYSTEM</span>
</span><span id="__span-3-7">   <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-3-8">   <span class="n">A</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-3-9">   <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="__span-3-10">   <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="__span-3-11">   <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
</span><span id="__span-3-12">   <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mf">60.0</span>
</span><span id="__span-3-13"><span class="hll">   <span class="n">nspin</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#(1)!</span>
</span></span><span id="__span-3-14"><span class="hll">   <span class="n">tot_magnetization</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1">#(2)!</span>
</span></span><span id="__span-3-15"> <span class="o">/</span>
</span><span id="__span-3-16">
</span><span id="__span-3-17"> <span class="o">&amp;</span><span class="n">ELECTRONS</span>
</span><span id="__span-3-18"> <span class="o">/</span>
</span><span id="__span-3-19">
</span><span id="__span-3-20"><span class="n">ATOMIC_SPECIES</span>
</span><span id="__span-3-21"> <span class="n">O</span>  <span class="mf">15.9999</span>  <span class="n">O</span><span class="o">.</span><span class="n">pz</span><span class="o">-</span><span class="n">rrkjus</span><span class="o">.</span><span class="n">UPF</span>
</span><span id="__span-3-22">
</span><span id="__span-3-23"><span class="n">ATOMIC_POSITIONS</span> <span class="n">angstrom</span>
</span><span id="__span-3-24"> <span class="n">O</span>  <span class="mf">0.0</span>   <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-3-25"> <span class="n">O</span>  <span class="mf">1.48</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span>
</span><span id="__span-3-26">
</span><span id="__span-3-27"><span class="n">K_POINTS</span> <span class="n">gamma</span>
</span></code></pre></div></td></tr></table></div>
<ol>
<li><code>nspin</code>: this is 1 by default so no spin polarization is taken into 
      account. To perform a spin polarized calculation it should be set to 2.</li>
<li><code>tot_magnetization</code>: this is difference between the number of spin-up and
      spin-down electrons in the cell.</li>
</ol>
<div class="admonition example">
<p class="admonition-title">Task 1.3 - Assuming Spin Polarized Metal</p>
<p>Create another copy of <code>01_O2</code> called <code>01_O2_spin</code>. Then, try to:</p>
<ol>
<li>
<p>Only turn on spin polarization (<code>nspin=2</code>). Does the calculation run?</p>
<details class="success">
<summary>Answer</summary>
<p>The calculation will not run because it needs to know how to set the
number of electrons with each spin.
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span><span id="__span-4-2">    Error in routine iosys (1):
</span><span id="__span-4-3">    fixed occupations and lsda need tot_magnetization
</span><span id="__span-4-4">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
</span></code></pre></div></td></tr></table></div></p>
</details>
</li>
<li>
<p>Set the total magnetization to 0.0, which would be the case if we 
   don't have any net magnetization in the molecule, i.e. the two spins in
   the <span class="arithmatex">\(\pi_x^*\)</span> and <span class="arithmatex">\(\pi_y^*\)</span> orbitals point in opposite directions. What
   is the final total energy?</p>
<details class="success">
<summary>Final energy</summary>
<p>The calculation converges to a total energy of -63.25520699 Ry.</p>
</details>
</li>
<li>
<p>Set the total magnetization to 2.0, which corresponds
   to both spins pointing in the same direction. Is the total energy lower?
   Are the Kohn-Sham energies the same for up-spin electrons and down-spin
   electrons?</p>
<details class="success">
<summary>Answer</summary>
<p>The calculation converges to a total energy of -63.29338911 Ry. This
is lower than for the configuration in which the spins point in the
same direction. The Kohn-Sham energies are different for up-spin and
down-spin electrons: the Kohn-Sham eigenvalues and occupations are
written in the log file with the spin-up values printed first,
followed by the spin-down values.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"> ------ SPIN UP ------------
</span><span id="__span-5-2">
</span><span id="__span-5-3">
</span><span id="__span-5-4">          k = 0.0000 0.0000 0.0000 ( 26462 PWs)   bands (ev):
</span><span id="__span-5-5">
</span><span id="__span-5-6">   -28.5946 -22.0951 -12.9798 -11.8147 -11.8147  -8.3869  -8.3869  -3.4845
</span><span id="__span-5-7">
</span><span id="__span-5-8"> ------ SPIN DOWN ----------
</span><span id="__span-5-9">
</span><span id="__span-5-10">
</span><span id="__span-5-11">          k = 0.0000 0.0000 0.0000 ( 26462 PWs)   bands (ev):
</span><span id="__span-5-12">
</span><span id="__span-5-13">   -27.1299 -20.3045 -11.9232 -10.0441 -10.0441  -6.3091  -6.3091  -2.2868
</span><span id="__span-5-14">
</span><span id="__span-5-15">     highest occupied, lowest unoccupied level (ev):    -8.3869   -6.3091
</span></code></pre></div></td></tr></table></div>
</details>
</li>
</ol>
</div>
<p>You have now seen that allowing for different numbers of up-spin and down-spin electrons can sometimes lower the total energy of the material.</p>
<div class="admonition pied-piper">
<p class="admonition-title">Fun fact</p>
<p>O2 can exist in its non-magnetic state, but it this state it is actually quite dangerous (see e.g. <a href="https://www.sciencedirect.com/science/article/pii/S1383574211001189"><img alt="ðŸ”—" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/1f517.svg" title=":link:" /><code>this
paper</code></a>),
so treating the spin correctly is important for your health!</p>
</div>
<h2 id="iron">Iron <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 19.63 13.43 8.2l-.71-.7 1.42-1.43L12 3.89c1.2-1.19 3.09-1.19 4.27 0l3.6 3.61-1.42 1.41h2.84l.71.71-3.55 3.59-.71-.71V9.62l-1.47 1.42-.71-.71L4.13 21.76z"/></svg></span></h2>
<p>Now that you've seen how including spin polarization has allowed us to correctly
describe the ground state of a molecular system, the next step is to use it to
describe a magnetic crystal. In contrast to a molecule, where the Kohn-Sham
wavefunctions of all states are fully contained in the unit cell of our DFT
calculation, the Kohn-Sham wavefunctions of electrons in crystals are
delocalized over many unit cells. In other words: each unit cell only contains a
small fraction of the electron which occupies a certain Bloch Kohn-Sham state.
As a consequence of this, the difference of the total number of up-spin and
down-spin electrons in each unit cell does not have to be an integer number.
Also, it is much harder to estimate the total magnetization of each unit cell of
a crystal. </p>
<p>One of the most common magnetic crystals is iron, so we'll study this material.
The directory <code>02_Fe</code> contains an input file for iron. Note this is a BCC
crystal structure (as set by <code>ibrav = 3</code> in the input file), whereas most of the
crystal structures you have studied so far in the labs have been FCC. The
calculation has been set up in the usual way for a spin polarized (<code>nspin=2</code>)
metallic system (with smearing).</p>
<div class="admonition example">
<p class="admonition-title">Task 2.1 - Fixed Magnetization</p>
<ol>
<li>
<p>Run this calculation and check everything works as expected. What is the
   final total energy?</p>
<details class="success">
<summary>Answer</summary>
<p>The final total energy should be -55.52528610 Ry.</p>
</details>
</li>
<li>
<p>Now make a copy of the calculation directory and in this new directory,
   modify the input file to allow for spin polarization. Try running the
   calculation with <code>tot_magnetization = 0.0</code> first, and compare your total
   energy to the one obtained using doubly degenerate bands. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that iron remains a metal in its magnetic configuration. So you
need keep the input variables associated with smearing the
occupancies even if you are running a spin-polarized calculation for
iron.</p>
</div>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.52528589 Ry. Almost identical to the
one obtained with the doubly degenerate bands. This is because these
two calculations are essentially identical.</p>
</details>
</li>
<li>
<p>Now try setting the total magnetization to 1.0 and see how the total
   energy changes: is it lower than the result of the non-magnetic
   calculation?</p>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.53839616 Ry. It is lower than the
result obtained without spin polarization.</p>
</details>
</li>
<li>
<p>Try setting the total magnetization to 2.0. How does the final energy
   compare to the previous value?</p>
<details class="success">
<summary>Answer</summary>
<p>The total energy becomes -55.56226730 Ry. Lower than all previous
cases.</p>
</details>
</li>
</ol>
</div>
<p>We could keep going like this and try out many different values for the total
magnetization to see which one has the lowest total energy (as discussed above,
the total magnetization in the unit cell does not have to be an integer).
Instead of doing this yourself, Quantum Espresso can do it for you: this is
achieved by setting the <code>starting_magnetization</code> input variable.</p>
<div class="admonition example">
<p class="admonition-title">Task 2.2 - Relaxed magnetization</p>
<ol>
<li>
<p>Make another copy of the <code>02_Fe</code> directory, and this time set
   <code>starting_magnetization = 1.0</code> (remove <code>tot_magnetization</code>). Run the
   calculation and see what the final total magnetization per cell is.</p>
<details class="success">
<summary>Answer</summary>
<p>The total magnetization becomes larger than 2.0.</p>
<div class="language-text highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1">total magnetization       =     2.21 Bohr mag/cell
</span></code></pre></div></td></tr></table></div>
<p>This value is in good agreement with the experimental value of 2.15
Bohr mag/cell.</p>
</details>
</li>
<li>
<p>Use the input files and scripts in the directory <code>extra_bandstructure</code> to
   generate a plot of the electronic band structure of BCC Fe.</p>
<details class="success">
<summary>Answer</summary>
<p>You can find the relevant input file in the directory
<code>02_Fe/extra_bandstructure</code>. The band structure should look like
this: </p>
<p><figure markdown="span"> 
<img alt="Diamond primitive cell" src="../assets/Iron_bands.png" width="500" /> 
</figure></p>
<p>You can find <code>README.md</code> in the directory for more information on
how to reproduce this plot.</p>
</details>
</li>
</ol>
</div>
<hr />
<h2 id="summary">Summary</h2>
<p>In this lab you have seen:</p>
<!-- - How to treat a metallic system. -->
<ul>
<li>how to do a DFT calculation including spin polarization.</li>
<li>how some materials can lower their ground state energy by becoming magnetic.</li>
<li>how to use spin-polarized calculations to find the correct magnetization of a
  magnetic crystal.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Johannes Lischner
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["content.code.copy", "content.code.annotate", "navigation.sections", "navigation.top", "navigation.expand"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
        <script src="../../../javascripts/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>