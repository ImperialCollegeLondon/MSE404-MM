(function(ka,la,ma,na,V,oa,W,C,X,$,aa,ba,pa,U,qa,M,N,ra,x,ja,sa,ta,ua,va,wa,xa,ya,za,Aa,Ba,E,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va,Wa,Xa,Ya,Za,$a,ab,bb,p){W("JS");X(["java.lang.Float"],"JS.MathExt","java.util.Date $.Hashtable $.Random JU.AU $.BArray $.BS $.CU $.Lst $.M3 $.M4 $.Measure $.OC $.P3 $.P4 $.PT $.Quat $.Rdr $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.bspt.PointIterator J.c.VDW J.i18n.GT JM.BondSet $.Measurement JS.SV $.T JU.BSUtil $.BoxInfo $.Edge $.Escape $.JmolMolecule $.Logger $.Parser $.Point3fi $.SimpleUnitCell JV.FileManager $.JC $.Viewer".split(" "),
function(){var m=aa(function(){this.pm=this.rand=this.e=this.vwr=null;$(this,arguments)},JS,"MathExt");U(m,function(){});p(m,"init",function(e){this.e=e;this.vwr=this.e.vwr;return this},"~O");p(m,"evaluate",function(e,a,b,d){switch(d){case 134218760:return 1<=b.length&&4==b[0].tok?e.addXStr((1==b.length?(new java.util.Date).toString():this.vwr.apiPlatform.getDateFormat(JS.SV.sValue(b[1])))+"\t"+JS.SV.sValue(b[0]).trim()):e.addXInt(System.currentTimeMillis()-JS.MathExt.t0-(0==b.length?0:b[0].asInt()));
case 134218250:return 1==b.length&&2==b[0].tok?e.addXInt(b[0].intValue):e.addXFloat(Math.abs(b[0].asFloat()));case 134218241:case 134218245:case 134218244:case 134218246:return 1==b.length&&this.evaluateMath(e,b,d);case 1275069441:case 1275068928:case 1275068929:case 1275068930:case 1275068931:case 1275335685:case 1275334681:return this.evaluateList(e,a.intValue,b);case 268437504:0==b.length&&(e.wasX=!1);case 1275068418:return this.evaluateArray(e,b,1275068418==d&&268442113==a.tok);case 134217765:return this.evaluateCallbackParam(e,
b);case 134217731:case 134221850:return this.evaluateQuaternion(e,b,d);case 1275068420:return this.evaluateBin(e,b);case 134221829:return this.evaluateCache(e,b);case 1275068934:case 1275068935:return this.evaluateRowCol(e,b,d);case 1765808134:return this.evaluateColor(e,b);case 134221831:return this.evaluateCompare(e,b);case 1228931586:case 134217736:case 1275203608:return this.evaluateConnected(e,b,d,a.intValue);case 1812599299:case 1814695966:return this.evaluateUnitCell(e,b,268442113==a.tok,268442113==
a.tok?a.intValue:a.tok);case 134353926:return this.evaluateContact(e,b);case 134221834:return this.evaluateData(e,b);case 1275069444:case 1275069442:return this.evaluateDotDist(e,b,d,a.intValue);case 1275069443:if(268442113==a.tok)return this.evaluateDotDist(e,b,d,a.intValue);case 134217729:case 1745489939:return this.evaluateMeasure(e,b,a.tok);case 1228935687:case 134223363:return this.evaluateLoad(e,b,1228935687==d);case 1275068427:return this.evaluateFind(e,b);case 1275068433:return this.evaluateInChI(e,
b);case 1287653388:case 1825200146:return this.evaluateFormat(e,a.intValue,b,1825200146==d);case 134320141:return this.evaluateUserFunction(e,a.value,b,a.intValue,268442113==a.tok);case 1275068437:d=1275068725;case 1275068446:case 1275068725:case 1275082241:case 1275072526:return this.evaluateGetProperty(e,b,d,268442113==a.tok);case 136314895:return this.evaluateHelix(e,b);case 134219777:case 134217750:case 134217763:return this.evaluatePlane(e,b,d);case 134218759:case 134238732:case 134222850:case 134222350:return this.evaluateScript(e,
b,d);case 1275069446:case 1275069447:case 1275068932:return this.evaluateString(e,a.intValue,b);case 134217751:return this.evaluatePoint(e,b);case 1275068447:return this.evaluatePointGroup(e,b,268442113==a.tok);case 134256129:return this.evaluatePrompt(e,b);case 134219266:return this.evaluateRandom(e,b);case 1275068432:return this.evaluateIn(e,b);case 1275072532:return this.evaluateModulation(e,b);case 1275068443:return this.evaluateReplace(e,b);case 134218753:case 134218756:case 134218757:case 1237320707:return this.evaluateSubstructure(e,
b,d,268442113==a.tok);case 1275068444:case 1275068425:return this.evaluateSort(e,b,d);case 134217764:return this.evaluateSpacegroup(e,b);case 1296041985:return this.evaluateSymop(e,b,268442113==a.tok);case 1275068445:return this.evaluateTensor(e,b);case 134217759:return this.evaluateWithin(e,b,268442113==a.tok);case 134221856:return this.evaluateWrite(e,b)}return!1},"JS.ScriptMathProcessor,JS.T,~A,~N");p(m,"evaluateCallbackParam",function(e,a){return e.addX(this.e.getCallbackParameter(0==a.length?
-2147483648:a[0].asInt()))},"JS.ScriptMathProcessor,~A");p(m,"evaluateSpacegroup",function(e,a){var b=null;switch(a.length){case 0:return e.addXObj(this.vwr.getSymTemp().getSpaceGroupInfo(this.vwr.ms,null,this.vwr.am.cmi,!0,null));case 2:if(b=JS.SV.flistValue(a[1],0),6!=b.length)return!1;case 1:var d=null,c=null;if(4==a[0].tok){c=a[0].asString();if(c.toUpperCase().startsWith("ITA/"))return e.addXObj(this.vwr.getSymTemp().getSpaceGroupJSON(this.vwr,"ITA",c.substring(4),0));if(c.toUpperCase().startsWith("AFLOW/"))return e.addXObj(this.vwr.getSymTemp().getSpaceGroupJSON(this.vwr,
"AFLOW",c.substring(6),0));if(0>c.indexOf("x")&&null==b)return e.addXObj(this.vwr.getSymTemp().getSpaceGroupInfoObj(c,null,!0,!1))}else if(null==(d=JS.SV.getBitSet(a[0],!0)))return e.addXObj(this.vwr.getSymTemp().getSpaceGroupInfoObj(""+a[0].asString(),b,!0,!1));return e.addXObj(this.vwr.findSpaceGroup(d,c,b,null==c,!1));default:return!1}},"JS.ScriptMathProcessor,~A");p(m,"evaluatePointGroup",function(e,a,b){var d=null,c=null,f=-1,j=-1,g=null,h=!1;switch(a.length){case 4:j=a[3].asFloat();case 3:f=
a[2].asFloat();case 2:switch(a[1].tok){case 8:c=JS.SV.ptValue(a[1]);break;case 10:g=JS.SV.getBitSet(a[1],!1),a[0].asString().equalsIgnoreCase("spaceGroup")&&(h=!0,2==a.length&&(f=0))}if(h)break;case 1:switch(a[0].tok){case 7:b=a[0].getList();d=Array(b.size());for(a=d.length;0<=--a;)d[a]=JS.SV.ptValue(b.get(a));break;case 10:g=JS.SV.getBitSet(a[0],!1);d=this.vwr.ms.at;break;case 4:if(b){g=JS.SV.getBitSet(e.getX(),!0);if(null==g||g.isEmpty())return!1;h=a[0].asString();if("spacegroup".equals(h)){h=!0;
break}}default:return!1}break;case 0:if(!b)return e.addXObj(this.vwr.ms.getPointGroupInfo(null));g=JS.SV.getBitSet(e.getX(),!1);break;default:return!1}if(null!=g){a=g.nextSetBit(0);if(0>a||a>=this.vwr.ms.ac||h&&1!=g.cardinality())return!1;if(h){c=this.vwr.ms.generateCrystalClass(a,JU.P3.new3(NaN,NaN,NaN));d=Array(c.size());for(a=d.length;0<=--a;)d[a]=c.get(a);c=new JU.P3}}d=this.vwr.getSymTemp().setPointGroup(null,c,null==d?this.vwr.ms.at:d,g,!1,0>f?this.vwr.getFloat(570425382):f,0>j?this.vwr.getFloat(570425384):
j,null==g?d.length:g.cardinality(),!0);return e.addXMap(d.getPointGroupInfo(-1,null,!0,null,0,1))},"JS.ScriptMathProcessor,~A,~B");p(m,"evaluateUnitCell",function(e,a,b,d){var c=b?JS.SV.getBitSet(e.getX(),!0):1812599299==d?this.vwr.getAllAtoms():null,f=(null==c?this.vwr.getAllAtoms():c).nextSetBit(0),j=a.length-1;b=1;switch(0>j?0:a[j].tok){case 2:case 3:b=a[j].asFloat(),j--}var g=0>j?0:a[0].tok,h=null,k=null,l=null;switch(g){case 7:k=a[0].getList();break;case 4:if(l=a[0].asString(),1814695966==d)if(0==
l.indexOf("a=")){for(var h=Array(4),s=0;4>s;s++)h[s]=new JU.P3;JU.SimpleUnitCell.setOabc(l,null,h)}else if(0<=l.indexOf(","))return e.addXObj(this.vwr.getV0abc(-1,l))}if(1812599299==d)return b=this.vwr.ms.getBoxInfo(c,1),e.addXObj(b.getInfo(l));d=null;s=null!=k;if(null==h&&s&&4>k.size())return!1;l=s?1:0;null==h&&(!s&&8!=g)&&(d=0>f?this.vwr.getCurrentUnitCell():this.vwr.ms.getUnitCell(this.vwr.ms.at[f].mi),h=null==d?E(-1,[JU.P3.new3(0,0,0),JU.P3.new3(1,0,0),JU.P3.new3(0,1,0),JU.P3.new3(0,0,1)]):d.getUnitCellVectors());
if(null==h)if(h=Array(4),s)switch(k.size()){case 3:h[0]=new JU.P3;for(s=0;3>s;s++)h[s+1]=JU.P3.newP(JS.SV.ptValue(k.get(s)));break;case 4:for(s=0;4>s;s++)h[s]=JU.P3.newP(JS.SV.ptValue(k.get(s)));break;case 6:g=x(6,0);for(s=0;6>s;s++)g[s]=k.get(s).asFloat();JU.SimpleUnitCell.setOabc(null,g,h);break;default:return!1}else switch(h[0]=JS.SV.ptValue(a[0]),j){case 3:for(s=1;4>s;s++)(h[s]=JU.P3.newP(JS.SV.ptValue(a[s]))).sub(h[0]);break;case 1:if(k=a[1].getList(),null!=k&&3==k.size()){for(s=0;3>s;s++)h[s+
1]=JS.SV.ptValue(k.get(s));break}default:return!1}s=l<=j?a[l].asString():null;if((k="primitive".equalsIgnoreCase(s))||"conventional".equalsIgnoreCase(s)){a=++l>j?"":a[l].asString().toUpperCase();a.equals("BCC")?a="I":0==a.length&&(a=this.vwr.getSymmetryInfo(f,null,0,null,null,null,1073741994,null,0,-1,0,null));if(null==a||0==a.length)return!1;null==d&&(d=this.vwr.getSymTemp());f=this.vwr.getModelForAtomIndex(f).auxiliaryInfo.get("primitiveToCrystal");if(!d.toFromPrimitive(k,a.charAt(0),h,f))return!1}else if("reciprocal".equalsIgnoreCase(s))h=
JU.SimpleUnitCell.getReciprocal(h,null,b),b=1;else if("vertices".equalsIgnoreCase(s))return e.addXObj(JU.BoxInfo.getVerticesFromOABC(h));if(1!=b)for(s=1;4>s;s++)h[s].scale(b);return e.addXObj(h)},"JS.ScriptMathProcessor,~A,~B,~N");p(m,"evaluateArray",function(e,a,b){if(b){b=e.getX();switch(1==a.length?b.tok:0){case 6:var d=new JU.Lst,c=a[0].asString(),f=b.getMap(),j=b.getKeys(!1);b=0;for(a=j.length;b<a;b++)if(null==f.get(j[b]).getMap())return!1;b=0;for(a=j.length;b<a;b++){var g=f.get(j[b]),g=g.getMap(),
g=JS.SV.deepCopy(g,!0,!1);g.put(c,JS.SV.newS(j[b]));d.addLast(JS.SV.newV(6,g))}return e.addXList(d);case 7:d=new java.util.Hashtable;c=b.getList();f=a[0].asString();b=0;for(a=c.size();b<a;b++)if(g=c.get(b).getMap(),null==g||null==g.get(f))return!1;b=0;for(a=c.size();b<a;b++)g=c.get(b),g=JS.SV.deepCopy(g.getMap(),!0,!1),j=g.remove(f),d.put(j.asString(),JS.SV.newV(6,g));return e.addXObj(d)}return!1}d=Array(a.length);for(b=d.length;0<=--b;)d[b]=JS.SV.newT(a[b]);return e.addXAV(d)},"JS.ScriptMathProcessor,~A,~B");
p(m,"evaluateBin",function(e,a){var b=a.length;if(3>b||5<b)return!1;var d=e.getX(),c=13==d.tok;if(!c&&7!=d.tok)return e.addX(d);var f=JS.SV.fValue(a[0]),j=JS.SV.fValue(a[1]),g=JS.SV.fValue(a[2]),h=4<=b&&1073742335==a[b-1].tok,b=(5==b||4==b&&!h)&&1073742334!=a[3].tok?JS.SV.sValue(a[3]):null,k=null;if(c)d=d.value;else{c=d.getList();d=x(c.size(),0);null!=b&&(k=JU.AU.createArrayOfHashtable(c.size()));try{for(var l=c.size();0<=--l;)d[l]=JS.SV.fValue(null==b?c.get(l):(k[l]=c.get(l).getMap()).get(b))}catch(s){if(M(s,
Exception))return!1;throw s;}}for(var j=Math.max(V(Math.floor((j-f)/g+0.01)),1),c=N(j,0),n=d.length,l=0;l<n;l++){var u=V(Math.floor((d[l]-f)/g));if(!(0>u||u>=j))if(c[u]++,null!=b){var q=k[l];if(null!=q){q.put("_bin",JS.SV.newI(u));var r=f+g*u,m=r+g;q.put("_binMin",JS.SV.newF(0==u?-3.4028235E38:r));q.put("_binMax",JS.SV.newF(u==j-1?3.4028235E38:m))}}}if(h){h=new JU.Lst;for(l=0;l<j;l++)h.addLast(x(-1,[f+g*l,c[l]]));return e.addXList(h)}return e.addXAI(c)},"JS.ScriptMathProcessor,~A");p(m,"evaluateCache",
function(e,a){return 0<a.length?!1:e.addXMap(this.vwr.fm.cacheList())},"JS.ScriptMathProcessor,~A");p(m,"evaluateColor",function(e,a){var b=0<a.length?JS.SV.sValue(a[0]):"",d=b.startsWith("$");if(2==a.length&&b.equalsIgnoreCase("TOHSL"))return e.addXPt(JU.CU.rgbToHSL(JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):JU.CU.colorPtFromString(a[1].asString())),!0));if(2==a.length&&b.equalsIgnoreCase("TORGB")){var c=JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):JU.CU.colorPtFromString(a[1].asString()));return e.addXPt(8==
a[1].tok?JU.CU.hslToRGB(c):c)}if(4==a.length&&(1073742335==a[3].tok||1073742334==a[3].tok)){var c=JU.P3.newP(8==a[0].tok?JS.SV.ptValue(a[0]):JU.CU.colorPtFromString(a[0].asString())),f=JU.P3.newP(8==a[1].tok?JS.SV.ptValue(a[1]):JU.CU.colorPtFromString(a[1].asString())),j=1073742335==a[3].tok;j&&(c=JU.CU.rgbToHSL(c,!1),f=JU.CU.rgbToHSL(f,!1));var g=new JU.SB,f=JU.V3.newVsub(f,c),h=a[2].asInt();2>h&&(h=20);f.scale(1/(h-1));for(b=0;b<h;b++)g.append(JU.Escape.escapeColor(JU.CU.colorPtToFFRGB(j?JU.CU.hslToRGB(c):
c))),c.add(f);return e.addXStr(g.toString())}h=d?null:this.vwr.cm.getColorEncoder(b);if(!d&&null==h)return e.addXStr("");c=1<a.length?JS.SV.fValue(a[1]):3.4028235E38;f=2<a.length?JS.SV.fValue(a[2]):3.4028235E38;j=3<a.length?JS.SV.fValue(a[3]):3.4028235E38;g=3.4028235E38!=j||3.4028235E38!=c&&3.4028235E38==f;3.4028235E38==f&&0==b.length&&(j=c,f=this.vwr.getCurrentColorRange(),c=f[0],f=f[1]);if(d){h=b.substring(1);h=E(-1,[h,null]);if(!this.vwr.shm.getShapePropertyData(24,"colorEncoder",h))return e.addXStr("");
h=h[1]}else h.setRange(c,f,c>f);b=h.getColorKey();return g?e.addXPt(JU.CU.colorPtFromInt(h.getArgb(3.4028235E38==f?c:j),null)):e.addX(JS.SV.getVariableMap(b))},"JS.ScriptMathProcessor,~A");p(m,"evaluateCompare",function(e,a){var b=a.length;if(2>b||5<b)return!1;var d,c=1073742335==a[b-1].tok;(c||1073742334==a[b-1].tok)&&b--;var f=JS.SV.sValue(a[b-1]),j=f.equalsIgnoreCase("stddev"),g=f.equalsIgnoreCase("ISOMER"),h=g&&c,k=f.equalsIgnoreCase("BONDS"),c=7==a[0].tok&&7==a[1].tok,l=3<=b?a[2].getList():null,
s=null==l&&!c&&!g&&b>(j?3:2),c=10==a[0].tok?a[0].value:null,n=10==a[1].tok?a[1].value:null,u=null==c?JS.SV.sValue(a[0]):"",q=null==n?JS.SV.sValue(a[1]):"";d=NaN;try{if(k){if(4!=b)return!1;u=JS.SV.sValue(a[2]);s=u.equalsIgnoreCase("SMILES");try{s&&(u=this.vwr.getSmiles(c))}catch(r){if(M(r,Exception))this.e.evalError(r.getMessage(),null);else throw r;}var m=this.e.getSmilesExt().getFlexFitList(c,n,u,!s);return null==m?e.addXStr(""):e.addXAF(m)}if(g){if(3!=b)return!1;if(null==c&&null==n){var y=this.vwr.getSmilesMatcher().getRelationship(u,
q).toUpperCase();return e.addXStr(y)}var p=null==c?this.vwr.getSmilesMatcher().getMolecularFormula(u,!1,!1):JU.JmolMolecule.getMolecularFormulaAtoms(this.vwr.ms.at,c,null,!1),C=null==n?this.vwr.getSmilesMatcher().getMolecularFormula(q,!1,!1):JU.JmolMolecule.getMolecularFormulaAtoms(this.vwr.ms.at,n,null,!1);if(!p.equals(C))return e.addXStr("NONE");null!=c&&(u=this.e.getSmilesExt().getSmilesMatches("/strict///",null,c,null,1,!0,!1));var A;null==n?A=0<this.vwr.getSmilesMatcher().areEqual(q,u):(q=this.e.getSmilesExt().getSmilesMatches("/strict///",
null,n,null,1,!0,!1),A=0<=this.e.getSmilesExt().getSmilesMatches("/strict///"+u,null,n,null,1,!0,!1).nextSetBit(0));if(!A){var B=u+q;if(0<=B.indexOf("/")||0<=B.indexOf("\\")||0<=B.indexOf("@")){if(0<=u.indexOf("@")&&(null!=n||0<=q.indexOf("@"))&&0>u.indexOf("@SP")){var D=u.toLowerCase().indexOf("invertstereo"),u=0<=D?"/strict/"+u.substring(0,D)+u.substring(D+12):"/invertstereo strict/"+u;if(A=null==n?0<this.vwr.getSmilesMatcher().areEqual(u,q):0<=this.e.getSmilesExt().getSmilesMatches(u,null,n,null,
1,!0,!1).nextSetBit(0))return e.addXStr("ENANTIOMERS")}null==n?A=0<this.vwr.getSmilesMatcher().areEqual("/nostereo/"+q,u):(y=this.e.getSmilesExt().getSmilesMatches("/nostereo/"+u,null,n,null,1,!0,!1),A=0<=y.nextSetBit(0));if(A)return e.addXStr("DIASTEREOMERS")}y="CONSTITUTIONAL ISOMERS";if(h){var v=this.vwr.getInchi(c,null,null);null!=v&&v.equals(this.vwr.getInchi(n,null,null))&&(y="TAUTOMERS")}return e.addXStr(y)}if(null==c||null==n)return e.addXStr("IDENTICAL");d=this.e.getSmilesExt().getSmilesCorrelation(c,
n,u,null,null,null,null,!1,null,null,!1,1);return e.addXStr(0.2>d?"IDENTICAL":"IDENTICAL or CONFORMATIONAL ISOMERS (RMSD="+d+")")}var I=new JU.M4,v=A=null;if(s){if(null==c||null==n)return!1;var f=JS.SV.sValue(a[2]),x=f.equalsIgnoreCase("MAP"),s=f.equalsIgnoreCase("SMILES"),t=x||f.equalsIgnoreCase("SMARTS");if(s||t)f=b>(j?4:3)?JS.SV.sValue(a[3]):null;var z="H".equalsIgnoreCase(f)||"allH".equalsIgnoreCase(f)||"bestH".equalsIgnoreCase(f),E=!z&&("polyhedra".equalsIgnoreCase(f)||"polyhedron".equalsIgnoreCase(f));
if(E)d=this.e.getSmilesExt().mapPolyhedra(c.nextSetBit(0),n.nextSetBit(0),s,I);else{A=new JU.Lst;var v=new JU.Lst,B="all".equalsIgnoreCase(f)||"allH".equalsIgnoreCase(f),F="best".equalsIgnoreCase(f)||"bestH".equalsIgnoreCase(f);"stddev".equals(f)&&(f=null);var G=f;if(null==f||z||B||F){if(!x&&!s||z&&E)return!1;G="/noaromatic"+(B||F?"/":" nostereo/")+this.e.getSmilesExt().getSmilesMatches(z?"H":"",null,c,null,32769,!0,!1)}else B=!0;d=this.e.getSmilesExt().getSmilesCorrelation(c,n,G,A,v,I,null,x,null,
null,F,(s?1:2)|(!B&&!F?8:0));if(x){var H=A.size();if(0==H)return e.addXStr("");for(var ea=V(v.size()/H),y=new JU.Lst,D=G=0;G<ea;G++){var w=JU.AU.newInt2(H);y.addLast(w);for(f=0;f<H;f++,D++)w[f]=N(-1,[A.get(f).i,v.get(D).i])}return B?e.addXList(y):0<y.size()?e.addXAII(y.get(0)):e.addXStr("")}}}else{A=this.e.getPointVector(a[0],0);v=this.e.getPointVector(a[1],0);if(null==A||null==v)return!1;if(null!=l){b--;var Q=l.size();if(Q>A.size()||Q!=v.size())return!1;for(var Y=new JU.Lst,G=0;G<Q;G++)Y.addLast(A.get(l.get(G).intValue-
1));A=Y}switch(b){case 2:break;case 3:if(j)break;default:return!1}A.size()==v.size()&&(J.api.Interface.getInterface("JU.Eigen",this.vwr,"script"),d=JU.Measure.getTransformMatrix4(A,v,I,null))}return j||Float.isNaN(d)?e.addXFloat(d):e.addXM4(I.round(1E-7))}catch(O){if(M(O,Exception))return this.e.evalError(null==O.getMessage()?O.toString():O.getMessage(),null),!1;throw O;}},"JS.ScriptMathProcessor,~A");p(m,"evaluateConnected",function(e,a,b,d){if(5<a.length)return!1;var c=-2147483648,f=2147483647,
j=0,g=3.4028235E38,h=65535,k=null,l=null,s=!1,n=!1;switch(b){case 1275203608:l=-2147483648;j=null;if(0<a.length)switch(a[0].tok){case 2:l=a[0].intValue;break;case 4:j=JS.SV.sValue(a[0])}1275203608==d&&(k=JS.SV.getBitSet(e.getX(),!0));k=E(-1,[Integer.$valueOf(l),j,k]);this.vwr.shm.getShapePropertyData(21,"getCenters",k)||(k[1]=null);return e.addXBs(null==k[1]?new JU.BS:k[1]);case 1228931586:k=e.getX();if(10!=k.tok||1!=a.length||10!=a[0].tok)return!1;k=k.value;l=a[0].value;a=new JU.Lst;j=this.vwr.ms.at;
for(d=k.nextSetBit(0);0<=d;d=k.nextSetBit(d+1)){b=0;g=j[d].bonds;for(n=g.length;0<=--n;)l.get(g[n].getOtherAtom(j[d]).i)&&b++;a.addLast(Integer.$valueOf(b))}return e.addXList(a)}for(d=0;d<a.length;d++){var u=a[d];switch(u.tok){case 10:if((n=C(u.value,"JM.BondSet"))&&null!=k)return!1;if(null==k)k=u.value;else if(null==l)l=u.value;else return!1;break;case 4:b=JS.SV.sValue(u);h=b.equalsIgnoreCase("hbond")?30720:JU.Edge.getBondOrderFromString(b);if(131071==h)return!1;break;case 3:s=!0;default:b=u.asInt();
u=u.asFloat();if(2147483647!=f)return!1;-2147483648==c?(c=Math.max(b,0),j=u):(f=b,g=u)}}-2147483648==c?(c=1,f=100,j=0.1,g=1E8):2147483647==f&&(f=c,g=j,j=0.1);null==k&&(k=this.vwr.getAllAtoms());s&&null==l&&(l=k);return null!=l?(a=new JU.BS,this.vwr.makeConnections(j,g,h,1086324745,k,l,a,n,!1,0),e.addX(JS.SV.newV(10,JM.BondSet.newBS(a)))):e.addXBs(this.vwr.ms.getAtomsConnected(c,f,h,k))},"JS.ScriptMathProcessor,~A,~N,~N");p(m,"evaluateContact",function(e,a){if(1>a.length||3<a.length)return!1;var b=
0,d=100;switch(a[0].tok){case 3:case 2:d=JS.SV.fValue(a[b++]);break;case 10:break;default:return!1}if(b==a.length||!C(a[b].value,"JU.BS"))return!1;var c=JU.BSUtil.copy(a[b++].value),b=b<a.length?JU.BSUtil.copy(a[b].value):null,d=new J.atomdata.RadiusData(null,10<d?d/100:d,10<d?J.atomdata.RadiusData.EnumType.FACTOR:J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO),b=this.setContactBitSets(c,b,!0,NaN,d,!1);b.or(c);return e.addXBs(b)},"JS.ScriptMathProcessor,~A");p(m,"evaluateData",function(e,a){var b=
0==a.length?"":JS.SV.sValue(a[0]);switch(a.length){case 0:case 1:break;case 2:case 3:if(10==a[0].tok)return e.addXStr(this.vwr.getModelFileData(b,JS.SV.sValue(a[1]),3==a.length&&JS.SV.bValue(a[2])));break;case 4:var b=a[1].asInt(),d=a[2].asInt(),c=a[3].asInt(),b=JU.Parser.parseFloatArrayFromMatchAndField(JS.SV.sValue(a[0]),null,0,0,null,b,d,null,c);return e.addXStr(JU.Escape.escapeFloatA(b,!1));default:return!1}if(0==b.indexOf("data2d_"))return b=this.vwr.getDataObj(b,null,2),null==b?e.addXStr(""):
2==a.length&&2==a[1].tok?(d=a[1].intValue,0>d&&(d+=b.length),0<=d&&d<b.length?e.addXStr(JU.Escape.escapeFloatA(b[d],!1)):e.addXStr("")):e.addXStr(JU.Escape.escapeFloatAA(b,!1));if(b.endsWith("*"))return e.addXList(this.vwr.getDataObj(b,null,0));if(0==b.indexOf("property_"))return b=this.vwr.getDataObj(b,null,1),null==b?e.addXStr(""):e.addXStr(JU.Escape.escapeFloatA(b,!1));b=this.vwr.getDataObj(b,null,-1);return e.addXStr(null==b||2>b.length?"":""+b[1])},"JS.ScriptMathProcessor,~A");p(m,"evaluateDotDist",
function(e,a,b,d){var c=1275069443==b,f,j,g=null;switch(a.length){case 2:if(2147483647==d){f=a[0];j=a[1];break}g=a[1];case 1:f=e.getX();j=a[0];break;case 0:if(c){f=e.getX();j=JS.SV.getVariable(new JU.P3);break}default:return!1}a=NaN;try{if(1275069442==b){var h=JU.P3.newP(e.ptValue(f,null));h.cross(h,e.ptValue(j,null));return e.addXPt(h)}var k=7==j.tok?null:e.ptValue(j,null),l=this.e.planeValue(j);if(c){b=-2147483648==d?0:d&480;var h=32==b||64==b,s=480==b;switch(f.tok){case 7:case 10:var n=10==f.tok,
u=10==j.tok,q=8==j.tok,r=n?f.value:null,m=u?j.value:null,y=n?null:f.getList(),p=u?null:j.getList(),C=h&&null!=g&&g.asBoolean();switch(j.tok){case 10:case 7:case 8:var A=this.vwr.ms.at;if(C){var B=NaN,D=2147483647;if(n){for(var v=r.nextSetBit(0);0<=v;v=r.nextSetBit(v+1)){var I=q?A[v].distanceSquared(k):this.e.getBitsetProperty(m,p,d,A[v],l,f.value,null,!1,f.index,!1).floatValue();if(!(32==b?I>=B:I<=B))B=I,D=v}return e.addXBs(2147483647==D?new JU.BS:JU.BSUtil.newAndSetBit(D))}for(v=y.size();0<=--v;){var E=
JS.SV.ptValue(y.get(v)),I=q?E.distanceSquared(k):this.e.getBitsetProperty(m,p,d,E,l,f.value,null,!1,2147483647,!1).floatValue();if(!(32==b?I>=B:I<=B))B=I,D=v}return e.addXInt(D)}if(s){if(null==m){for(var t=x(r.cardinality(),0),B=0,v=r.nextSetBit(0);0<=v;v=r.nextSetBit(v+1),B++)t[B]=A[v].distance(k);return e.addXAF(t)}D=x(r.cardinality(),m.cardinality(),0);B=0;for(v=r.nextSetBit(0);0<=v;v=r.nextSetBit(v+1),B++){d=0;for(var z=m.nextSetBit(0);0<=z;z=m.nextSetBit(z+1),d++)D[B][d]=A[v].distance(A[z])}return e.addXAFF(D)}if(h){t=
x(n?r.cardinality():y.size(),0);if(n){v=r.nextSetBit(0);for(B=0;0<=v;v=r.nextSetBit(v+1))t[B++]=this.e.getBitsetProperty(m,p,d,A[v],l,f.value,null,!1,f.index,!1).floatValue();return e.addXAF(t)}for(v=t.length;0<=--v;)t[v]=this.e.getBitsetProperty(m,p,d,JS.SV.ptValue(y.get(v)),l,null,null,!1,2147483647,!1).floatValue();return e.addXAF(t)}return e.addXObj(this.e.getBitsetProperty(r,y,d,k,l,f.value,null,!1,f.index,!1))}}}var N=e.ptValue(f,null),F=this.e.planeValue(f);c?a=null!=l&&null!=g?JU.Measure.directedDistanceToPlane(N,
l,JS.SV.ptValue(g)):null==F?null==l?k.distance(N):JU.Measure.distanceToPlane(l,N):JU.Measure.distanceToPlane(F,k):null!=F&&null!=l?a=F.x*l.x+F.y*l.y+F.z*l.z+F.w*l.w:(null!=F?N=JU.P3.new3(F.x,F.y,F.z):null!=l&&(k=JU.P3.new3(l.x,l.y,l.z)),a=N.dot(k))}catch(G){if(!M(G,Exception))throw G;}return e.addXFloat(a)},"JS.ScriptMathProcessor,~A,~N,~N");p(m,"evaluateHelix",function(e,a){if(1>a.length||5<a.length)return!1;var b=2<a.length?3:1,d=b>=a.length?"array":JS.SV.sValue(a[b]),b=JS.T.getTokFromName(d);if(2<
a.length){var c=e.ptValue(a[0],null),f=e.ptValue(a[1],null);if(0==b||9!=a[2].tok||null==c||null==f)return!1;var j=JU.Quat.newP4(a[2].value),j=JU.Measure.computeHelicalAxis(c,f,j);return null==j?!1:e.addXObj(JU.Escape.escapeHelical(d,b,c,f,j))}d=C(a[0].value,"JU.BS")?a[0].value:this.vwr.ms.getAtoms(1094715412,Integer.$valueOf(a[0].asInt()));switch(b){case 134217751:case 1073741854:case 1665140738:return e.addXObj(this.getHelixData(d,b));case 134217729:return e.addXFloat(this.getHelixData(d,134217729).floatValue());
case 135176:case 1745489939:return e.addXObj(this.getHelixData(d,b));case 1275068418:j=this.getHelixData(d,1073742001);if(null==j)break;return e.addXAS(j)}return!1},"JS.ScriptMathProcessor,~A");p(m,"getHelixData",function(e,a){var b=e.nextSetBit(0);return 0>b?"null":this.vwr.ms.at[b].group.getHelixData(a,this.vwr.getQuaternionFrame(),this.vwr.getInt(553648142))},"JU.BS,~N");p(m,"evaluateInChI",function(e,a){var b=e.getX(),d=0<a.length?JS.SV.sValue(a[0]):"fixedh?";d.toLowerCase().equals("standard")&&
(d="");var c=JS.SV.getBitSet(b,!0),b=null==c?JS.SV.sValue(b):null;return e.addXStr(this.vwr.getInchi(c,b,d))},"JS.ScriptMathProcessor,~A");p(m,"evaluateFind",function(e,a){var b=e.getX(),d=7==b.tok,c=10==b.tok,f=0==a.length,j=0==a.length?0:a[0].tok,g=f||4!=j?"":JS.SV.sValue(a[0]),h=1<a.length&&1073742334==a[1].tok,k=0==j?0:a[a.length-1].tok,l=0==k?JS.SV.vF:a[a.length-1],s=!d&&1073742335==k,n=1<a.length&&1073742335!=a[1].tok&&1073742334!=a[1].tok&&10!=a[1].tok?JS.SV.sValue(a[1]):"",k=!d&&!h&&g.equalsIgnoreCase("SEQUENCE"),
u=!d&&!h&&g.equalsIgnoreCase("SEQ");if(g.toUpperCase().startsWith("SMILES/")){g.endsWith("/")||(g+="/");var q=g.substring(6)+"//";JV.JC.isSmilesCanonical(q)?(n="SMILES",g="CHEMICAL"):(g="SMILES",n=q+n)}else g.toUpperCase().startsWith("SMARTS/")&&(g.endsWith("/")||(g+="/"),n=g.substring(6)+(0==n.length?"//":n),g="SMARTS");var r=null,q=!1;if(4==b.tok)switch(a.length){case 1:if(b.value.startsWith("InChI=")&&g.equalsIgnoreCase("SMILES"))return e.addXStr(this.vwr.getInchi(null,b.value,"SMILES"+n));q=!0;
break;case 2:h||s?q=!0:b.value.startsWith("InChI=")?g.equals("SMARTS")?r=this.vwr.getInchi(null,b.value,"SMILES"):q=!0:3>=n.length&&0==n.$replace("m"," ").$replace("i"," ").$replace("v"," ").trim().length&&(q=!0)}var m=!q&&g.equalsIgnoreCase("SMILES"),p=!q&&g.equalsIgnoreCase("SMARTS"),x=!d&&!q&&g.equalsIgnoreCase("CHEMICAL"),C=!d&&!q&&g.equalsIgnoreCase("MF"),A=!d&&!q&&g.equalsIgnoreCase("CELLFORMULA"),B=c&&!d&&g.equalsIgnoreCase("INCHI"),D=c&&!d&&g.equalsIgnoreCase("INCHIKEY"),v=!m&&!p&&10==j&&
0<=n.toLowerCase().indexOf("map"),q=!m&&!p&&(10==b.tok||8==b.tok||7==b.tok)&&g.toLowerCase().startsWith("equivalent");try{if(q)switch(b.tok){case 10:return e.addXBs(this.vwr.ms.getSymmetryEquivAtoms(b.value,null,null));case 8:return e.addXList(this.vwr.getSymmetryEquivPoints(b.value,g+n));case 7:for(var I=new JU.Lst,V=b.getList(),t=0,z=V.size();t<z;t++){var W=JS.SV.ptValue(V.get(t));if(null==W)return!1;I.addLast(W)}return e.addXList(this.vwr.getSymmetryEquivPointList(I,g+n))}else if(B||D)return D&&
(n+=" key"),e.addXStr(this.vwr.getInchi(JS.SV.getBitSet(b,!0),null,n));if(x){var F=c?b.value:null,G=null==F?JS.SV.sValue(b):this.vwr.getOpenSmiles(F),G=(0==G.length?"":this.vwr.getChemicalInfo(G,n.toLowerCase(),F)).trim();G.startsWith("InChI")&&(G=JU.PT.rep(JU.PT.rep(G,"InChI=",""),"InChIKey=",""));return e.addXStr(G)}if(m||p||c){var c=v?0:m||p?2:1,H=c<a.length&&10==a[c].tok?a[c++].value:null,ea="bonds".equalsIgnoreCase(JS.SV.sValue(l)),I=ea||s,c=null;switch(b.tok){case 7:case 4:null==r&&!d&&(r=JS.SV.sValue(b));
if((m||p)&&1==a.length||null!=H)return!1;if(n.equalsIgnoreCase("mf"))c=this.vwr.getSmilesMatcher().getMolecularFormula(r,p,s);else{var H=n,w=!0,t=!1;switch(a.length){case 4:w=JS.SV.bValue(a[3]);case 3:t=JS.SV.bValue(a[2])}var Q=H.equals("chirality"),z=!t&&(!w||!p&&!Q);try{if(c=this.e.getSmilesExt().getSmilesMatches(H,d?JS.SV.strListValue(b):r,null,null,p?2:1,!t,!w),d)return e.addXObj(c)}catch(Y){if(M(Y,Exception))return System.out.println(Y.getMessage()),e.addXInt(-1);throw Y;}var O=Q?1:(JU.AU.isAI(c),
c.length);0==O&&("MF_FAILED"!==this.vwr.getSmilesMatcher().getLastException()&&0>r.toLowerCase().indexOf("noaromatic")&&0>r.toLowerCase().indexOf("strict"))&&(c=this.e.getSmilesExt().getSmilesMatches(H,r,null,null,16|(p?2:1),!t,!w));if(z)return e.addXInt(!w&&0<O?1:O)}break;case 10:w=b.value;if(g.equalsIgnoreCase("spacegroup"))return e.addXObj(this.vwr.findSpaceGroup(w,null,null,!1,!1));if(g.equalsIgnoreCase("crystalClass"))return z=w.nextSetBit(0),w=null,2!=a.length&&(w=new JU.BS,w.set(z)),e.addXList(this.vwr.ms.generateCrystalClass(z,
null!=w?this.vwr.ms.getAtomSetCenter(w):10==l.tok?this.vwr.ms.getAtomSetCenter(l.value):JS.SV.ptValue(l)));if(C&&0!=n.length)return e.addXBs(JU.JmolMolecule.getBitSetForMF(this.vwr.ms.at,w,n));if(C||A)return e.addXStr(this.vwr.getFormulaForAtoms(w,C?"MF":"CELLFORMULA",s));if(k||u){var X=l.asString().equalsIgnoreCase("H"),I=(new Boolean(I|X)).valueOf();return e.addXStr(this.vwr.getSmilesOpt(w,-1,-1,(I?7340032|(X?9437184:0):0)|(u?34603008:1048576),null))}if(v){var K=null,O=Q=z=null,P=3==a.length?JS.SV.sValue(l):
null,R=null==P||P.equals("%i")||P.equals("number")?"i":P.equals("%a")||P.equals("name")?"a":P.equals("%D")||P.equals("index")?"D":"?";null==P&&(P="number");l=null;n=n.$replace("map","").trim();g=this.vwr.getSmilesOpt(w,0,0,0,n);if(w.cardinality()!=H.cardinality())l="atom sets are not the same size";else try{0<n.length&&(g="/"+n+"/"+g);var z=this.vwr.getSmilesMatcher().getCorrelationMaps(g,this.vwr.ms.at,this.vwr.ms.ac,w,137)[0],Z=this.vwr.getSmilesMatcher().getCorrelationMaps(g,this.vwr.ms.at,this.vwr.ms.ac,
H,137);if(0<Z.length){K=N(w.length(),0);for(t=K.length;0<=--t;)K[t]=-1;Q=Z[0];for(t=z.length;0<=--t;)K[z[t]]=Q[t];var O=E(z.length,2,null),U=JU.BS.copy(w);U.or(H);var S="?"==R?Array(U.length()):null;null!=S&&(S=this.e.getCmdExt().getBitsetIdentFull(U,P,!1,2147483647,!1,S));for(var L=this.vwr.ms.at,Z=0,t=w.nextSetBit(0);0<=t;t=w.nextSetBit(t+1)){var ca=K[t];if(-1!=ca){var da;switch(R.charCodeAt(0)){case 97:da=E(-1,[L[t].getAtomName(),L[ca].getAtomName()]);break;case 105:da=E(-1,[Integer.$valueOf(L[t].getAtomNumber()),
Integer.$valueOf(L[ca].getAtomNumber())]);break;case 68:da=E(-1,[Integer.$valueOf(t),Integer.$valueOf(ca)]);break;default:da=E(-1,[S[t],S[ca]])}O[Z++]=da}}}}catch(fa){if(M(fa,Exception))l=fa.getMessage();else throw fa;}var T=new java.util.Hashtable;T.put("BS1",w);T.put("BS2",H);T.put("SMILES",g);null==l?(T.put("SMILEStoBS1",z),T.put("SMILEStoBS2",Q),T.put("BS1toBS2",K),T.put("MAP1to2",O),T.put("key",P)):T.put("error",l);return e.addXMap(T)}if(m||p)g=1<a.length&&10==a[1].tok?this.vwr.getSmilesOpt(a[1].value,
0,0,0,n):n;n=n.toUpperCase();if(0<=n.indexOf("INCHI"))return e.addXStr(this.vwr.getInchi(w,null,"SMILES/"+n));if(n.equals("MF"))r=this.e.getSmilesExt().getSmilesMatches("",null,w,H,1,!0,!1),c=this.vwr.getSmilesMatcher().getMolecularFormula(r,!1,s);else if(ea)K=this.vwr.getSmilesMatcher().getCorrelationMaps(g,this.vwr.ms.at,this.vwr.ms.ac,w,(m?1:2)|8),c=0<K.length?this.vwr.ms.getDihedralMap(K[0]):N(0,0);else if(n.equals("MAP"))c=K=this.vwr.getSmilesMatcher().getCorrelationMaps(g,this.vwr.ms.at,this.vwr.ms.ac,
w,(m?1:2)|144);else{var $=(m?0<=n.indexOf("OPEN")?5:1:2)|(s&&0==g.length?22020096:0);if(0<=n.indexOf("/MOLECULE/")){for(var ga=this.vwr.ms.getMolecules(),aa=new JU.Lst,t=0;t<ga.length;t++)if(ga[t].atomList.intersects(w)){var ba=this.e.getSmilesExt().getSmilesMatches(g,null,ga[t].atomList,H,$,!s,!1);ba.isEmpty()||aa.addLast(ba)}c=aa}else c=this.e.getSmilesExt().getSmilesMatches(g,null,w,H,$,!s,!1)}}null==c&&this.e.invArg();return e.addXObj(c)}}catch(ha){if(M(ha,Exception))this.e.evalError(ha.getMessage(),
null);else throw ha;}w=new JU.BS;K=d?b.getList():null;if(d&&4!=j&&0!=j){b=a[0];t=0;for(z=K.size();t<z;t++)JS.SV.areEqual(K.get(t),b)&&w.set(t);c=N(w.cardinality(),0);Z=0;for(t=w.nextSetBit(0);0<=t;t=w.nextSetBit(t+1))c[Z++]=t+1;return e.addXAI(c)}j=0<=n.indexOf("v");t=0<=n.indexOf("i")||h;h=0<=n.indexOf("m");n=0==g.length;q=!n&&!q&&2==a.length;if(d||q){k=q?this.getPatternMatcher():null;H=null;if(q)try{H=k.compile(g,t)}catch(ia){if(M(ia,Exception))this.e.evalError(ia.toString(),null);else throw ia;
}k=n?null:JS.SV.strListValue(b);P=n?K.size():k.length;JU.Logger.debugging&&JU.Logger.debug("finding "+g);z=0;R=null;b=h?new JU.Lst:null;S="";for(t=0;t<P;t++){if(n)switch(L=K.get(t),L.tok){case 6:L=L.getMap().isEmpty()!=f;break;case 7:L=0==L.getList().size()!=f;break;case 4:L=0==L.asString().length!=f;break;default:L=!0}else q?(S=k[t],R=H.matcher(S),L=R.find()):L=0<=JS.SV.sValue(K.get(t)).indexOf(g);if(h&&L||!h&&L==!j)z++,w.set(t),h&&b.addLast(j?S.substring(0,R.start())+S.substring(R.end()):R.group())}if(!d)return h?
e.addXStr(1==b.size()?b.get(0):""):j?e.addXBool(1==z):h?e.addXStr(0==z?"":R.group()):e.addXInt(0==z?0:R.start()+1);if(h){d=Array(z);if(0<z)for(t=k.length;0<=--t;)w.get(t)&&(--z,d[z]=h?b.get(z):k[t]);return e.addXAS(d)}d=new JU.Lst;for(t=w.nextSetBit(0);0<=t;t=w.nextSetBit(t+1))d.addLast(K.get(t));return e.addXList(d)}return k?e.addXStr(this.vwr.getJBR().toStdAmino3(JS.SV.sValue(b))):e.addXInt(JS.SV.sValue(b).indexOf(g)+1)},"JS.ScriptMathProcessor,~A");p(m,"evaluateGetProperty",function(e,a,b,d){var c=
a.length,f=d&&1275082241==b,j=d&&1275068725==b,g=1275068446==b,h=0,k=0==c?0:a[0].tok;if(2==c&&(7==k||6==k||14==k))return e.addXObj(this.vwr.extractProperty(a[0].value,a[1].value.toString(),-1));var l=d&&1==c&&10==a[0].tok?a[0].value:null,s=null==l&&0<c?JS.SV.sValue(a[h++]):"",k=s,n=k.toLowerCase();!f&&0>n.indexOf("[select ")&&(k=n);var u=!1;k.equals("json")&&c>h&&(u=!0,k=JS.SV.sValue(a[h++]));var q=null;if(d){q=e.getX();switch(q.tok){case 10:break;case 4:var r=q.value,c=Array(3);r.startsWith("$")?
(r=r.substring(1),a=this.vwr.shm.getShapeIdFromObjectName(r),0<=a&&(c[0]=r,this.vwr.shm.getShapePropertyData(a,"index",c),null!=c[1]&&!s.equals("index")&&(r=c[1].intValue(),c[1]=this.vwr.shm.getShapePropertyIndex(a,s.intern(),r)))):(a=JV.JC.shapeTokenIndex(JS.T.getTokFromName(r)),0<=a&&(c[0]=s,c[1]=Integer.$valueOf(-1),this.vwr.shm.getShapePropertyData(a,s.intern(),c)));return null==c[1]?e.addXStr(""):e.addXObj(c[1]);case 7:if(j){g=q.getList();if(0==c)return e.addXObj(this.getMinMax(g,1275068725,
!0));d=new java.util.Hashtable;k=1<c?JS.SV.sValue(a[c-1]):null;null!=k&&c--;n=Array(c);for(r=0;r<c;r++)n[r]=JS.SV.sValue(a[r]);r=0;for(u=g.size();r<u;r++)if(h=g.get(r),6==h.tok){s=h.getMap();a="";for(q=0;q<c;q++)l=s.get(n[q]),a+=(0==q?"":k)+JS.SV.sValue(l);s=d.get(a);null==s&&d.put(a,s=JS.SV.newV(7,new JU.Lst));s.getList().addLast(h)}return e.addXMap(d)}if(null!=l){c=q.getList();a=new JU.Lst;for(r=l.nextSetBit(0);0<=r;r=l.nextSetBit(r+1))a.addLast(c.get(r));return e.addXList(a)}default:if(1275068725==
b&&6==q.tok){d=new java.util.Hashtable;for(c=q.getMap().entrySet().iterator();c.hasNext()&&((r=c.next())||1);)a=r.getKey(),h=r.getValue().asString(),g=d.get(h),null==g&&d.put(h,g=new JU.Lst),g.addLast(a);if("count".equals(n))for(c=d.entrySet().iterator();c.hasNext()&&((r=c.next())||1);)r.setValue(Integer.$valueOf(r.getValue().size()));return e.addXMap(d)}f&&(k="[SELECT "+k+"]");return e.addXObj(this.vwr.extractProperty(q,k,-1))}!n.startsWith("bondinfo")&&(!n.startsWith("atominfo")&&!n.startsWith("modelkitinfo"))&&
(k="atomInfo."+k)}r="";if(k.equalsIgnoreCase("fileContents")&&2<=c){h=JS.SV.sValue(a[1]);for(r=2;r<c;r++)h+="|"+JS.SV.sValue(a[r]);r=h;h=c}else if(c>h)switch(a[h].tok){case 10:r=a[h++].value;k.equalsIgnoreCase("bondInfo")&&(c>h&&10==a[h].tok)&&(r=E(-1,[r,a[h].value]));break;case 6:case 4:this.vwr.checkPropertyParameter(k)&&(r=a[h++].value)}if(d&&(r=q.value,0>r.nextSetBit(0)))return e.addXStr("");g&&!d&&(k="auxiliaryInfo.models."+k);k=JU.PT.rep(k,".[","[");r=this.vwr.getProperty(null,k,r);h<c&&(r=
this.vwr.extractProperty(r,a,h));return e.addXObj(u?JS.SV.safeJSON("value",r):JS.SV.isVariableType(r)?r:JU.Escape.toReadable(k,r))},"JS.ScriptMathProcessor,~A,~N,~B");p(m,"evaluateFormat",function(e,a,b,d){var c=2>b.length||1287653388==a?e.getX():null,f=0==b.length?"%U":7==b[0].tok?null:JS.SV.sValue(b[0]);if(!d&&0<b.length&&null!=c&&10!=c.tok&&null!=f){if(2==b.length){var c=c.getList(),j=b[1].getList();if(null==c||null==j)return!1;c=JS.SV.getVariableList(this.getSublist(c,j))}b=E(-1,[b[0],c]);c=null}if(null==
c){if(null==f)return!1;a=d?-1:JS.SV.getFormatType(f);if(0<=a&&2!=b.length)return!1;if(0<=a||2>b.length||7!=b[1].tok)return b=JS.SV.format(b,a),f.equalsIgnoreCase("json")?e.addXStr(b):e.addXObj(b);f=b[1].getList();b=E(-1,[b[0],null]);d=Array(f.size());for(c=d.length;0<=--c;)b[1]=f.get(c),d[c]=JS.SV.format(b,a).toString();return e.addXAS(d)}if(7==c.tok&&null==f)return c=c.getList(),j=b[0].getList(),f=this.getSublist(c,j),e.addXList(f);b=10==c.tok?c.value:null;a=JS.T.tokAttr(a,480);return e.addXObj(null==
f?"":null==b?JS.SV.sprintf(JU.PT.formatCheck(f),c):this.e.getCmdExt().getBitsetIdent(b,f,c.value,!0,c.index,a))},"JS.ScriptMathProcessor,~N,~A,~B");p(m,"getSublist",function(e,a){for(var b=new JU.Lst,d,c,f,j=0,g=e.size();j<g;j++)switch(c=e.get(j),c.tok){case 6:d=c.getMap();f=new JU.Lst;for(var h=0,k=a.size();h<k;h++)c=d.get(JS.SV.sValue(a.get(h))),f.addLast(null==c?JS.SV.newS(""):c);b.addLast(JS.SV.getVariableList(f));break;case 7:d=new java.util.Hashtable;f=c.getList();h=0;for(k=Math.min(f.size(),
a.size());h<k;h++)d.put(JS.SV.sValue(a.get(h)),f.get(h));b.addLast(JS.SV.getVariable(d))}return b},"JU.Lst,JU.Lst");p(m,"evaluateList",function(e,a,b){var d=b.length,c=e.getX(),f=7==c.tok,j;switch(a){case 1275335685:return 2==d&&e.addX(c.pushPop(b[0],b[1]))||1==d&&e.addX(c.pushPop(null,b[0]));case 1275334681:return 1==d&&e.addX(c.pushPop(b[0],null))||0==d&&e.addX(c.pushPop(null,null));case 1275069441:if(1!=d&&2!=d)return!1;break;case 1275069447:case 1275069446:break;default:if(1!=d)return!1}var g=
null,h=null,k=null;if(2==d){var l=JS.SV.sValue(b[0]);j=b[1];if(1275069441==a){g=f?JS.SV.strListValue(c):JU.PT.split(JS.SV.sValue(c),"\n");h=7==j.tok?JS.SV.strListValue(j):JU.PT.split(JS.SV.sValue(j),"\n");k=Array(d=Math.max(g.length,h.length));for(c=0;c<d;c++)k[c]=(c>=g.length?"":g[c])+l+(c>=h.length?"":h[c]);return e.addXAS(k)}if(1073742335!=j.tok)return!1;k=c.getList();(d=0==l.length)&&(l=",");if(1275069446==a){h=Array(k.size());for(c=k.size();0<=--c;)if(b=k.get(c).getList(),null==b)h[c]=k.get(c);
else{a=new JU.SB;f=0;for(g=b.size();f<g;f++)0<f&&a.append(l),j=b.get(f),a.append(d&&4==j.tok?'"'+JU.PT.rep(j.value,'"','""')+'"':""+j.asString());h[c]=JS.SV.newS(a.toString())}return e.addXAV(h)}a=new JU.Lst;d&&(l="\x00");h=N(2,0);c=0;for(j=k.size();c<j;c++){f=k.get(c).asString();if(d){h[1]=0;for(g=h[0]=0;;){b=JU.PT.getCSVString(f,h);if(null==b){if(-1==h[1]){f+=++c<j?"\n"+k.get(c).asString():'"';h[1]=g;continue}f=f.substring(0,g)+f.substring(g).$replace(",","\x00");break}f=f.substring(0,g)+f.substring(g,
h[0]).$replace(",","\x00")+b+f.substring(h[1]);h[1]=g=h[0]+b.length}}for(var s=f.$plit(l),n=new JU.Lst,f=0,g=s.length;f<g;f++){b=s[f];if(0>b.indexOf("."))try{n.addLast(JS.SV.newI(Integer.parseInt(b)));continue}catch(u){if(!M(u,Exception))throw u;}else try{n.addLast(JS.SV.getVariable(Float.$valueOf(Float.parseFloat(b))));continue}catch(q){if(!M(q,Exception))throw q;}n.addLast(JS.SV.newS(b))}a.addLast(JS.SV.getVariableList(n))}return e.addXObj(JS.SV.getVariableList(a))}j=0==d?JS.SV.newV(1073742327,
"all"):b[0];k=1073742327==j.tok;if(!f&&4!=c.tok)return e.binaryOp(this.opTokenFor(a),c,j);var s=JS.SV.isScalar(c),r=JS.SV.isScalar(j),m=n=null,l=c.getList(),p=j.getList();f?d=l.size():s?d=2147483647:(g=JU.PT.split(JS.SV.sValue(c),"\n"),n=x(d=g.length,0),JU.PT.parseFloatArrayData(g,n));if(k&&1275069446!=a){k=0;if(f)for(c=d;0<=--c;)k+=JS.SV.fValue(l.get(c));else if(!s)for(c=d;0<=--c;)k+=n[c];return e.addXFloat(k)}if(1275069446==a&&4==j.tok){a=new JU.SB;if(s)a.append(JS.SV.sValue(c));else{b=k?"":j.value.toString();
for(c=0;c<d;c++)a.append(0<c?b:"").append(JS.SV.sValue(l.get(c)))}return e.addXStr(a.toString())}var C=null;r?C=j:7==j.tok?d=Math.min(d,p.size()):(h=JU.PT.split(JS.SV.sValue(j),"\n"),m=x(h.length,0),JU.PT.parseFloatArrayData(h,m),d=Math.min(d,m.length));var E=this.opTokenFor(a);if(f&&k)return k=new JU.Lst,e.addXList(this.addAllLists(c.getList(),k));b=s?c:null;var A,B=2147483647==d;B&&(d=1);for(var D=Array(d),c=0;c<d;c++){A=r?C:7==j.tok?p.get(c):Float.isNaN(m[c])?JS.SV.getVariable(JS.SV.unescapePointOrBitsetAsVariable(h[c])):
JS.SV.newF(m[c]);s||(b=f?l.get(c):Float.isNaN(n[c])?JS.SV.getVariable(JS.SV.unescapePointOrBitsetAsVariable(g[c])):JS.SV.newF(n[c]));1275069446==a&&7!=b.tok&&(k=new JU.Lst,k.addLast(b),b=JS.SV.getVariableList(k));if(!e.binaryOp(E,b,A))return!1;D[c]=e.getX()}return B?e.addXObj(D[0]):e.addXAV(D)},"JS.ScriptMathProcessor,~N,~A");p(m,"addAllLists",function(e,a){for(var b=e.size(),d=0;d<b;d++){var c=e.get(d);7==c.tok?this.addAllLists(c.getList(),a):a.addLast(c)}return a},"JU.Lst,JU.Lst");p(m,"evaluateLoad",
function(e,a,b){if(1>a.length||3<a.length)return!1;var d=JV.FileManager.fixDOSName(JS.SV.sValue(a[0])),c=1<a.length&&1073742335==a[1].tok,f=this.vwr.async||2<a.length&&1073742335==a[a.length-1].tok,j=1<a.length&&2==a[1].tok?a[1].asInt():-1;a=1<a.length&&a[1].asString().equalsIgnoreCase("JSON");if(c)return e.addXMap(this.vwr.fm.getFileAsMap(d,null,!1));c=d.startsWith("?");if(JV.Viewer.isJS&&(c||f)){if(b&&c)return e.addXStr("");d=this.e.loadFileAsync("load()_",d,e.oPt,!0)}b=b?this.vwr.fm.getFilePath(d,
!1,!1):this.vwr.getFileAsString4(d,j,!1,!1,!0,"script");try{return a?e.addXObj(this.vwr.parseJSON(b)):e.addXStr(b)}catch(g){if(M(g,Exception))return!1;throw g;}},"JS.ScriptMathProcessor,~A,~B");p(m,"evaluateMath",function(e,a,b){a=JS.SV.fValue(a[0]);switch(b){case 134218246:a=Math.sqrt(a);break;case 134218244:a=Math.sin(3.141592653589793*a/180);break;case 134218245:a=Math.cos(3.141592653589793*a/180);break;case 134218241:a=180*Math.acos(a)/3.141592653589793}return e.addXFloat(a)},"JS.ScriptMathProcessor,~A,~N");
p(m,"evaluateMeasure",function(e,a,b){var d=0;switch(b){case 1745489939:b=null;for(var c=new JU.Lst,f=x(-1,[3.4028235E38,3.4028235E38]),j=null,g=null,h=!1,k=!1,l=0,s=!1,n=null,u=0,q=3.4028235E38,r=!1,m=!1,n=0;n<a.length;n++)switch(a[n].tok){case 10:var p=a[n].value;0==p.length()&&(s=!0);c.addLast(p);d++;u++;break;case 8:p=new JU.Point3fi;p.setT(a[n].value);c.addLast(p);d++;break;case 2:case 3:f[l++%2]=JS.SV.fValue(a[n]);break;case 4:p=JS.SV.sValue(a[n]);if(p.startsWith("property_")){b=p;break}p.equalsIgnoreCase("vdw")||
p.equalsIgnoreCase("vanderwaals")?q=(n+1<a.length&&2==a[n+1].tok?a[++n].asInt():100)/100:p.equalsIgnoreCase("notConnected")?k=!0:p.equalsIgnoreCase("connected")?h=!0:p.equalsIgnoreCase("minArray")?r=1<=u:p.equalsIgnoreCase("asArray")||0==p.length?m=1<=u:JM.Measurement.isUnits(p)?g=p.toLowerCase():j=d+":"+p;break;default:return!1}if(2>d||4<d||2<l||k&&h)return!1;if(s||3.4028235E38!=q&&(2!=u||2!=d))return e.addXStr("");n=3.4028235E38==q?new J.atomdata.RadiusData(f,0,null,null):new J.atomdata.RadiusData(null,
q,J.atomdata.RadiusData.EnumType.FACTOR,J.c.VDW.AUTO);a=this.vwr.newMeasurementData(null,c).set(0,null,n,b,j,g,null,h,k,null,!0,0,0,null,NaN,null).getMeasurements(m,r);return e.addXObj(a);case 134217729:if(3!=(d=a.length)&&4!=d)return!1;break;default:if(2!=(d=a.length))return!1}b=Array(d);for(n=0;n<d;n++)if(null==(b[n]=e.ptValue(a[n],null)))return!1;switch(d){case 2:return e.addXFloat(b[0].distance(b[1]));case 3:return e.addXFloat(JU.Measure.computeAngleABC(b[0],b[1],b[2],!0));case 4:return e.addXFloat(JU.Measure.computeTorsion(b[0],
b[1],b[2],b[3],!0))}return!1},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluateModulation",function(e,a){var b="",d=NaN,c=null;switch(a.length){case 0:break;case 1:switch(a[0].tok){case 8:c=a[0].value;break;case 4:b=a[0].asString();break;default:d=JS.SV.fValue(a[0])}break;case 2:b=JS.SV.sValue(a[0]);d=JS.SV.fValue(a[1]);break;default:return!1}null==c&&1E6>d&&(c=JU.P3.new3(d,d,d));d=e.getX();d=10==d.tok?d.value:new JU.BS;return e.addXList(this.vwr.ms.getModulationList(d,(b+"D").toUpperCase().charAt(0),
c))},"JS.ScriptMathProcessor,~A");p(m,"evaluatePlane",function(e,a,b){if(134219777==b&&3!=a.length&&4!=a.length||134217763==b&&2!=a.length&&3!=a.length&&4!=a.length||0==a.length||4<a.length)return!1;var d,c,f=this.e.planeValue(a[0]),j,g;switch(a.length){case 1:return 10==a[0].tok&&(a=a[0].value,3==a.cardinality())?(a=this.vwr.ms.getAtomPointVector(a),e.addXPt4(JU.Measure.getPlaneThroughPoints(a.get(0),a.get(1),a.get(2),new JU.V3,new JU.V3,new JU.P4))):null!=f&&e.addXPt4(f);case 2:if(134217763==b){d=
this.e.planeValue(a[1]);if(null==d)return!1;b=new JU.P3;j=new JU.V3;g=new JU.V3;if(null!=f)return a=JU.Measure.getIntersectionPP(f,d),null==a?e.addXStr(""):e.addXList(a);c=e.ptValue(a[0],null);return null==c?e.addXStr(""):e.addXPt(JU.Measure.getIntersection(c,null,d,b,j,g))}case 3:case 4:switch(b){case 134219777:return b=4==a.length?JS.SV.fValue(a[3]):NaN,f=this.e.getHklPlane(JU.P3.new3(JS.SV.fValue(a[0]),JS.SV.fValue(a[1]),JS.SV.fValue(a[2])),b,null),null!=f&&e.addXPt4(f);case 134217763:d=e.ptValue(a[0],
null);c=e.ptValue(a[1],null);if(null==d||null==c)return e.addXStr("");c=JU.V3.newV(c);c.normalize();f=this.e.planeValue(a[2]);if(null!=f)return b=new JU.P3,j=new JU.V3,g=new JU.V3,d=JU.Measure.getIntersection(d,c,f,b,j,g),null==d?e.addXStr(""):e.addXPt(d);b=e.ptValue(a[2],null);if(null==b)return e.addXStr("");j=new JU.V3;b=JU.P3.newP(b);if(3==a.length)return JU.Measure.projectOntoAxis(b,d,c,j),e.addXPt(b);f=JS.SV.fValue(a[3]);a=JU.P3.newP(b);JU.Measure.projectOntoAxis(b,d,c,j);a=a.distance(b);d=new JU.Lst;
a==f?d.addLast(b):a<f&&(a=Math.sqrt(f*f-a*a),j.scaleAdd2(a,c,b),d.addLast(JU.P3.newP(j)),j.scaleAdd2(-a,c,b),d.addLast(JU.P3.newP(j)));return e.addXList(d)}switch(a[0].tok){case 2:case 3:if(3==a.length)return f=JS.SV.fValue(a[0]),b=JS.SV.fValue(a[1]),a=JS.SV.fValue(a[2]),j=JU.V3.new3(0,0,1),c=JU.P3.new3(0,1,0),a=JU.Quat.newVA(c,a),a.getMatrix().rotate(j),c.set(0,0,1),a=JU.Quat.newVA(c,b),a.getMatrix().rotate(j),c.setT(j),c.scale(f),f=new JU.P4,JU.Measure.getPlaneThroughPoint(c,j,f),e.addXPt4(f);break;
case 10:case 8:d=e.ptValue(a[0],null);c=e.ptValue(a[1],null);if(null==c)return!1;b=2<a.length&&(10==a[2].tok||8==a[2].tok)?e.ptValue(a[2],null):null;j=JU.V3.newV(c);if(null==b)return f=new JU.P4,2==a.length||2!=a[2].tok&&3!=a[2].tok&&!a[2].asBoolean()?(b=JU.P3.newP(d),b.add(c),b.scale(0.5),j.sub(d),j.normalize()):1073742335==a[2].tok?b=d:(j.sub(d),b=new JU.P3,b.scaleAdd2(a[2].asFloat(),j,d)),JU.Measure.getPlaneThroughPoint(b,j,f),e.addXPt4(f);f=new JU.V3;a=4==a.length?e.ptValue(a[3],null):null;a=
JU.Measure.getDirectedNormalThroughPoints(d,c,b,a,j,f);return e.addXPt4(JU.P4.new4(j.x,j.y,j.z,a))}}if(4!=a.length)return!1;b=JS.SV.fValue(a[0]);j=JS.SV.fValue(a[1]);d=JS.SV.fValue(a[2]);a=JS.SV.fValue(a[3]);return e.addXPt4(JU.P4.new4(b,j,d,a))},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluatePoint",function(e,a){switch(a.length){default:return!1;case 1:if(3==a[0].tok||2==a[0].tok)return e.addXInt(a[0].asInt());var b=null;if(7==a[0].tok){var d=a[0].getList(),c=d.size();if(0==c)return!1;switch(d.get(0).tok){case 4:b=
d.get(0).value;if(!b.startsWith("{")||"string"==typeof JU.Escape.uP(b))break;for(var b=new JU.Lst,f=0;f<c;f++)b.addLast(JS.SV.getVariable(JU.Escape.uP(JS.SV.sValue(d.get(f)))));return e.addXList(b)}b="{"+JS.SV.sValue(a[0])+"}"}null==b&&(b=JS.SV.sValue(a[0]));d=JU.Escape.uP(b);return C(d,"JU.P3")?e.addXPt(d):e.addXStr(""+d);case 2:switch(a[1].tok){case 1073742334:case 1073742335:switch(a[0].tok){case 8:d=JU.P3.newP(a[0].value);break;case 10:d=this.vwr.ms.getAtomSetCenter(a[0].value);break;default:return!1}1073742335==
a[1].tok?(this.vwr.tm.transformPt3f(d,d),d.y=this.vwr.tm.height-d.y,this.vwr.antialiased&&d.scale(0.5)):(this.vwr.antialiased&&d.scale(2),d.y=this.vwr.tm.height-d.y,this.vwr.tm.unTransformPoint(d,d));break;case 8:c=a[0].getList();if(null==c||4!=c.size())return!1;b=JS.SV.ptValue(a[1]);d=JU.P3.newP(JS.SV.ptValue(c.get(0)));d.scaleAdd2(b.x,JS.SV.ptValue(c.get(1)),d);d.scaleAdd2(b.y,JS.SV.ptValue(c.get(2)),d);d.scaleAdd2(b.z,JS.SV.ptValue(c.get(3)),d);break;default:return!1}return e.addXPt(d);case 3:return e.addXPt(JU.P3.new3(a[0].asFloat(),
a[1].asFloat(),a[2].asFloat()));case 4:return e.addXPt4(JU.P4.new4(a[0].asFloat(),a[1].asFloat(),a[2].asFloat(),a[3].asFloat()))}},"JS.ScriptMathProcessor,~A");p(m,"evaluatePrompt",function(e,a){if(1!=a.length&&2!=a.length&&3!=a.length)return!1;var b=JS.SV.sValue(a[0]),d=1<a.length&&7==a[1].tok?JS.SV.strListValue(a[1]):null,c=null!=d||1==a.length||3==a.length&&a[2].asBoolean(),f=null!=d?null:2<=a.length?JS.SV.sValue(a[1]):"OK",b=""+this.vwr.prompt(b,f,d,c);return c&&null!=d?e.addXInt(Integer.parseInt(b)+
1):e.addXStr(b)},"JS.ScriptMathProcessor,~A");p(m,"evaluateQuaternion",function(e,a,b){var d=null,c=a.length,f=2147483647,j=!1;134221850==b&&(1<c&&(4==a[c-1].tok&&a[c-1].value.equalsIgnoreCase("relative"))&&(c--,j=!0),1<c&&(2==a[c-1].tok&&10==a[0].tok)&&(f=a[c-1].asInt(),0>=f&&(f=2147483646),c--));switch(c){case 0:case 1:case 4:break;case 2:if(134221850==b){if(7==a[0].tok&&(7==a[1].tok||1073742335==a[1].tok))break;if(10==a[0].tok&&(2==a[1].tok||10==a[1].tok))break}if(null==(d=e.ptValue(a[0],null))||
134221850!=b&&8==a[1].tok)return!1;break;case 3:if(134221850!=b)return!1;if(9==a[0].tok){if(8!=a[2].tok&&10!=a[2].tok)return!1;break}for(var g=0;3>g;g++)if(8!=a[g].tok&&10!=a[g].tok)return!1;break;default:return!1}var h=g=null,k=null;switch(c){case 0:return e.addXPt4(this.vwr.tm.getRotationQ().toPoint4f());default:if(134221850==b&&7==a[0].tok){b=this.e.getQuaternionArray(a[0].getList(),1073742001);a=JU.Quat.sphereMean(b,null,1E-4);g=C(a,"JU.Quat")?a:null;break}else if(134221850==b&&10==a[0].tok)h=
this.vwr.getAtomGroupQuaternions(a[0].value,f);else if(11==a[0].tok)g=JU.Quat.newM(a[0].value);else if(9==a[0].tok)k=a[0].value;else if(k=JS.SV.sValue(a[0]),k=JU.Escape.uP(k.equalsIgnoreCase("best")?this.vwr.getOrientation(1073741864,"best",null,null).toString():k),!C(k,"JU.P4"))return!1;134217731==b&&(g=JU.Quat.newVA(JU.P3.new3(k.x,k.y,k.z),k.w));break;case 2:if(134221850==b){if(7==a[0].tok&&7==a[1].tok){b=this.e.getQuaternionArray(a[0].getList(),1073742001);h=this.e.getQuaternionArray(a[1].getList(),
1073742001);h=JU.Quat.div(h,b,f,j);break}if(7==a[0].tok&&1073742335==a[1].tok)return b=this.e.getQuaternionArray(a[0].getList(),1073742001),f=x(1,0),JU.Quat.sphereMean(b,f,1E-4),e.addXFloat(f[0]);if(10==a[0].tok&&10==a[1].tok){b=this.vwr.getAtomGroupQuaternions(a[0].value,2147483647);h=this.vwr.getAtomGroupQuaternions(a[1].value,2147483647);h=JU.Quat.div(h,b,f,j);break}}g=e.ptValue(a[1],null);k=this.e.planeValue(a[0]);g=null!=g?JU.Quat.getQuaternionFrame(JU.P3.new3(0,0,0),d,g):JU.Quat.newVA(d,JS.SV.fValue(a[1]));
break;case 3:if(9==a[0].tok)return f=8==a[2].tok?a[2].value:this.vwr.ms.getAtomSetCenter(a[2].value),e.addXStr(JU.Escape.drawQuat(JU.Quat.newP4(a[0].value),"q",JS.SV.sValue(a[1]),f,1));b=Array(3);for(g=0;3>g;g++)b[g]=8==a[g].tok?a[g].value:this.vwr.ms.getAtomSetCenter(a[g].value);g=JU.Quat.getQuaternionFrame(b[0],b[1],b[2]);break;case 4:134221850==b?k=JU.P4.new4(JS.SV.fValue(a[1]),JS.SV.fValue(a[2]),JS.SV.fValue(a[3]),JS.SV.fValue(a[0])):g=JU.Quat.newVA(JU.P3.new3(JS.SV.fValue(a[0]),JS.SV.fValue(a[1]),
JS.SV.fValue(a[2])),JS.SV.fValue(a[3]))}if(null!=h){if(2147483647!=f){f=new JU.Lst;for(g=0;g<h.length;g++)f.addLast(h[g].toPoint4f());return e.addXList(f)}g=0<h.length?h[0]:null}return e.addXPt4((null==g?JU.Quat.newP4(k):g).toPoint4f())},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluateRandom",function(e,a){if(3<a.length)return!1;null==this.rand&&(this.rand=new java.util.Random);var b=0,d=1;switch(a.length){case 3:this.rand.setSeed(ba(JS.SV.fValue(a[2])));case 2:d=JS.SV.fValue(a[1]);case 1:b=JS.SV.fValue(a[0]);
case 0:break;default:return!1}return e.addXFloat(this.rand.nextFloat()*(d-b)+b)},"JS.ScriptMathProcessor,~A");p(m,"evaluateRowCol",function(e,a,b){if(1!=a.length)return!1;a=a[0].asInt()-1;var d=e.getX();switch(d.tok){case 11:if(0>a||2<a)break;d=d.value;switch(b){case 1275068935:return b=x(3,0),d.getRow(a,b),e.addXAF(b);default:return b=x(3,0),d.getColumn(a,b),e.addXAF(b)}case 12:if(0>a||2<a)break;d=d.value;switch(b){case 1275068935:return b=x(4,0),d.getRow(a,b),e.addXAF(b);default:return b=x(4,0),
d.getColumn(a,b),e.addXAF(b)}case 7:b=d.getList();for(var d=new JU.Lst,c=0,f=b.size();c<f;c++){var j=b.get(c).getList();if(null==j)return e.addXStr("");d.addLast(a<j.size()?j.get(a):JS.SV.newS(""))}return e.addXList(d)}return!1},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluateIn",function(e,a){var b=e.getX();switch(a.length){case 1:var d=a[0].getList();if(null!=d)for(var c=0,f=d.size();c<f;c++)if(JS.SV.areEqual(b,d.get(c)))return e.addXInt(c+1);break;default:for(c=0;c<a.length;c++)if(JS.SV.areEqual(b,
a[c]))return e.addXInt(c+1)}return e.addXInt(0)},"JS.ScriptMathProcessor,~A");p(m,"evaluateReplace",function(e,a){var b=!1,d,c;switch(a.length){case 0:b=!0;d=c=null;break;case 3:b=JS.SV.bValue(a[2]);case 2:d=JS.SV.sValue(a[0]);c=JS.SV.sValue(a[1]);break;default:return!1}var f=e.getX();if(7==f.tok){for(var f=JS.SV.strListValue(f),j=Array(f.length),g=f.length;0<=--g;)j[g]=null==d?JU.PT.clean(f[g]):b?JU.PT.replaceAllCharacters(f[g],d,c):JU.PT.rep(f[g],d,c);return e.addXAS(j)}f=JS.SV.sValue(f);return e.addXStr(null==
d?JU.PT.clean(f):b?JU.PT.replaceAllCharacters(f,d,c):JU.PT.rep(f,d,c))},"JS.ScriptMathProcessor,~A");p(m,"evaluateScript",function(e,a,b){if((134222350==b||134238732==b)&&1!=a.length||0==a.length)return!1;var d=JS.SV.sValue(a[0]),c=new JU.SB;switch(b){case 134218759:return 2==a.length?d.equalsIgnoreCase("JSON")&&e.addXObj(this.vwr.parseJSON(JS.SV.sValue(a[1]))):e.addXObj(this.vwr.evaluateExpressionAsVariable(d));case 134222850:a=2==a.length?JS.SV.sValue(a[1]):".";a.equals(".")||c.append(this.vwr.jsEval(a+
"\u0001"+d));(a.equals(".")||a.equals("*"))&&this.e.runScriptBuffer(d,c,!0);break;case 134222350:this.e.runScriptBuffer("show "+d,c,!0);break;case 134238732:return e.addX(this.vwr.jsEvalSV(d))}var d=c.toString(),f;return Float.isNaN(f=JU.PT.parseFloatStrict(d))?e.addXStr(d):0<=d.indexOf(".")?e.addXFloat(f):e.addXInt(JU.PT.parseInt(d))},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluateSort",function(e,a,b){if(1<a.length)return!1;if(1275068444==b){if(1==a.length&&4==a[0].tok)return e.addX(e.getX().sortMapArray(a[0].asString()));
var d=0==a.length?0:a[0].asInt();return e.addX(e.getX().sortOrReverse(d))}b=e.getX();a=0==a.length?null:a[0];if(4==b.tok){var d=0,c=JS.SV.sValue(b);if(null==a)return e.addXInt(0);a=JS.SV.sValue(a);for(b=0;b<c.length;b++){b=c.indexOf(a,b);if(0>b)break;d++}return e.addXInt(d)}var d=new JU.Lst,f=c=null,j=JS.SV.getVariable(b.value).sortOrReverse(0).getList();if(null==j)return null==a?e.addXStr(""):e.addXInt(0);b=0;for(var g=j.size();b<=g;b++){var h=b==g?null:j.get(b);if(!(null!=a&&null!=h&&!JS.SV.areEqual(h,
a)))if(JS.SV.areEqual(h,c))f.intValue++;else{if(null!=c){var k=new JU.Lst;k.addLast(c);k.addLast(f);d.addLast(JS.SV.getVariableList(k))}f=JS.SV.newI(1);c=h}}return null==a?e.addX(JS.SV.getVariableList(d)):d.isEmpty()?e.addXInt(0):e.addX(d.get(0).getList().get(1))},"JS.ScriptMathProcessor,~A,~N");p(m,"evaluateString",function(e,a,b){var d=e.getX(),c=0<b.length?JS.SV.sValue(b[0]):1275068932==a?"":"\n";switch(b.length){case 0:break;case 1:if(1073742335==b[0].tok)return e.addX(JS.SV.getVariable(JU.PT.getTokens(d.asString())));
break;case 2:if(7==d.tok)break;if(1275069447==a){d=JS.SV.getVariable(JU.PT.split(JU.PT.rep(d.value,"\n\r","\n").$replace("\r","\n"),"\n"));break}default:return!1}if(7==d.tok&&1275068932!=a&&(1275069447!=a||2==b.length))return e.addX(d),this.evaluateList(e,a,b);b=1275069447==a&&10==d.tok||1275068932==a&&7==d.tok?null:JS.SV.sValue(d);switch(a){case 1275069447:if(10==d.tok){c=d.value;d=this.vwr.ms.mc;b=new JU.Lst;for(a=0;a<d;a++){var f=this.vwr.getModelUndeletedAtomsBitSet(a);f.and(c);b.addLast(JS.SV.getVariable(f))}return e.addXList(b)}return e.addXAS(JU.PT.split(b,
c));case 1275069446:return 0<b.length&&"\n"==b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),e.addXStr(JU.PT.rep(b,"\n",c));case 1275068932:if(null!=b)return e.addXStr(JU.PT.trim(b,c));d=JS.SV.strListValue(d);for(a=d.length;0<=--a;)d[a]=JU.PT.trim(d[a],c);return e.addXAS(d)}return e.addXStr("")},"JS.ScriptMathProcessor,~N,~A");p(m,"evaluateSubstructure",function(e,a,b,d){if(0==a.length||d&&(134218753==b||1<a.length))return!1;var c=134218756==b&&!d&&134218756==a[0].tok?a[0].value:null;if(null!=
c&&2>a.length)return!1;var f=134218756==b&&!d&&10==a[0].tok,j=134218753==a[0].tok?a[0].value:null!=c&&134218753==a[1].tok?a[1].value:null;if(null!=c&&null==j)return!1;var g=f?null:JS.SV.sValue(a[0]),h=new JU.BS;if(f||0<g.length)try{if(f)return e.addX(JS.SV.newV(134218756,this.vwr.getSmilesMatcher().compileSearchTarget(this.vwr.ms.at,this.vwr.ms.ac,JS.SV.getBitSet(a[0],!1))));if(null!=c)return e.addXBs(this.vwr.getSmilesMatcher().getSubstructureSet(j,c,0,null,2));if(134218753==b)return e.addX(JS.SV.newV(134218753,
this.vwr.getSmilesMatcher().compileSmartsPattern(g)));var k=d?e.getX().value:2==a.length&&10==a[1].tok?a[1].value:this.vwr.getModelUndeletedAtomsBitSet(-1),h=this.vwr.getSmilesMatcher().getSubstructureSet(null==j?g:j,this.vwr.ms.at,this.vwr.ms.ac,k,134218757==b?1:2)}catch(l){if(M(l,Exception))this.e.evalError(l.getMessage(),null);else throw l;}return 134218753!=b&&e.addXBs(h)},"JS.ScriptMathProcessor,~A,~N,~B");p(m,"evaluateSymop",function(e,a,b){var d=a.length,c=null;if(2==a.length&&4==a[0].tok&&
4==a[1].tok&&a[1].value.equalsIgnoreCase("matrix"))return c=this.vwr.getSymTemp().convertOperation(a[0].value,null),null!=c&&e.addXObj(c);if(2==a.length&&12==a[0].tok&&4==a[1].tok&&a[1].value.equalsIgnoreCase("xyz"))return c=this.vwr.getSymTemp().convertOperation("",a[0].value),null!=c&&e.addXObj(c);var f=b?e.getX():null,j=!1;if(null!=f&&10!=f.tok&&!(j=8==f.tok))return!1;c=null==f||j?null:f.value;f=j?JS.SV.ptValue(f):null;!j&&null==c&&(c=this.vwr.getThisModelAtoms());if(0==d){for(var f=JU.PT.split(JU.PT.trim(this.vwr.getSymTemp().getSpaceGroupInfo(this.vwr.ms,
null,null==c||c.isEmpty()?Math.max(0,this.vwr.am.cmi):this.vwr.ms.at[c.nextSetBit(0)].mi,!1,null).get("symmetryInfo"),"\n"),"\n"),g=new JU.Lst,h=0,k=f.length;h<k;h++)g.addLast(JU.PT.split(f[h],"\t"));return e.addXList(g)}var l=null,s=!1,n=!1,k=-2147483648,m=0,q=null,r=null;switch(a[0].tok){case 4:l=JS.SV.sValue(a[0]);null!=l&&(s=l.equalsIgnoreCase("invariant"),n=l.equalsIgnoreCase("wyckoff"));m++;break;case 12:l=a[0].escape();m++;break;case 2:k=a[0].asInt();m++;break;case 10:j||(r=1==a.length||10!=
a[1].tok?c:null,c=this.vwr.getModelUndeletedAtomsBitSet(this.vwr.getModelIndexForAtom(c.nextSetBit(0))))}null==c&&(m<d&&10==a[m].tok&&(c=new JU.BS).or(a[m].value),m+1<d&&10==a[m+1].tok&&(null==c?c=new JU.BS:c).or(a[m+1].value));j=null;if(d>m&&7==a[m].tok){q=a[m++].getList();if(3!=q.size())return!1;j=JU.P3.new3(JS.SV.fValue(q.get(0)),JS.SV.fValue(q.get(1)),JS.SV.fValue(q.get(2)))}else d>m&&2==a[m].tok&&JU.SimpleUnitCell.ijkToPoint3f(JS.SV.iValue(a[m++]),j=new JU.P3,0,0);null==f&&null!=(f=d>m?e.ptValue(a[m],
c):null)&&m++;null!=(q=d>m?e.ptValue(a[m],c):null)&&m++;null!=f&&(null==q&&null!=r&&!r.isEmpty())&&(q=f,f=JU.P3.newP(this.vwr.ms.at[r.nextSetBit(0)]));r=null!=q&&a.length>m&&-2147483648==k&&2==a[m].tok?a[m].intValue:-1;0<=r&&m++;-2147483648==k&&!s&&(k=0);var p=null;!n&&(!s&&null!=l&&0>l.indexOf(","))&&(m==d?p=this.vwr.ms.getPointGroupInfo(null):6==a[m].tok&&(p=a[m].getMap()));if(null!=p){c=l.indexOf(".");a=l.indexOf("^");0<a?r=JU.PT.parseInt(l.substring(a+1)):(a=l.length,r=1);0<c&&a>c+1?(k=JU.PT.parseInt(l.substring(c+
1,a)),1>k&&(k=1),a=c):k=1;l=l.substring(0,a);c=p.get(l+"_m");if(null==c)return c=p.get(l),null==c?e.addXStr(""):e.addXObj(c);var y;try{if(C(c,"JS.SV"))if(y=p.get("center").value,11==c.tok)g=c.value;else if(7==c.tok)g=c.getList().get(k-1).value;else return!1;else y=p.get("center"),g=C(c,"JU.M3")?c:c.get(k-1);k=g;g=JU.M3.newM3(g);if(1<r)for(h=1;h<r;h++)g.mul(k);if(null==f)return e.addXObj(g);f=JU.P3.newP(f);f.sub(y);g.rotate(f);f.add(y);return e.addXPt(f)}catch(x){if(!M(x,Exception))throw x;}return!1}y=
d==m?n?"":s?"id":null!=q?"all":null!=f?"point":"matrix":JS.SV.sValue(a[m++]);d=(h=null!=c&&!c.isEmpty())?c.nextSetBit(0):-1;if(n){c=h?this.vwr.ms.getAtom(d):f;if(null==c||"".equals(y))return!1;f=null==y?null:y.substring(0,1);h=this.vwr.getOperativeSymmetry();return e.addXObj(null==h?null:h.getWyckoffPosition(this.vwr,c,f))}y=y.toLowerCase();if(s||y.equals("invariant")&&b)h&&null==f&&(f=this.vwr.ms.at[d]),0>d&&(d=this.vwr.getThisModelAtoms().nextSetBit(0));if(s&&-2147483648==k){l=null;h=this.vwr.getCurrentUnitCell();
null!=f?l=null==h?N(0,0):h.getInvariantSymops(f,null):null!=c&&!c.isEmpty()&&(h=c.nextSetBit(0),f=this.vwr.ms.at[h],l=this.vwr.ms.getSymmetryInvariant(h));if(null!=l&&0<l.length){g=Array(l.length);for(h=0;h<g.length;h++)k=l[h],g[h]=this.vwr.getSymmetryInfo(d,null,k,null,f,f,1275068418,y,0,-1,0,null);return e.addXObj(g)}return null!=l&&e.addXAI(l)}return m==a.length&&e.addXObj(this.vwr.getSymmetryInfo(d,l,k,j,f,q,1275068418,y,0,r,0,null))},"JS.ScriptMathProcessor,~A,~B");p(m,"evaluateTensor",function(e,
a){var b=2==a.length&&1275068445==a[1].tok,d=b?null:e.getX();if(2<a.length||!b&&10!=d.tok)return!1;var d=d.value,c=b||0==a.length?null:JS.SV.sValue(a[0]).toLowerCase(),f=this.vwr.getNMRCalculation();if("unique".equals(c))return e.addXBs(f.getUniqueTensorSet(d));var j=2>a.length?null:JS.SV.sValue(a[1]).toLowerCase();return b?e.addXObj(a[0].value.getInfo(j)):e.addXList(f.getTensorInfo(c,j,d))},"JS.ScriptMathProcessor,~A");p(m,"evaluateUserFunction",function(e,a,b,d,c){var f=null;if(c)switch(f=e.getX(),
f.tok){case 10:break;case 6:if(0<b.length)return!1;f=f.getMap().get(a);return null==f?e.addXStr(""):e.addX(f);default:return!1}a=a.toLowerCase();e.wasX=!1;for(var j=new JU.Lst,g=0;g<b.length;g++)j.addLast(b[g]);if(c)return e.addXObj(this.e.getBitsetProperty(f.value,null,d,null,null,f.value,E(-1,[a,j]),!1,f.index,!1));a=this.e.getUserFunctionResult(a,j,null);return null==a?!1:e.addX(a)},"JS.ScriptMathProcessor,~S,~A,~N,~B");p(m,"evaluateWithin",function(e,a,b){var d=a.length;if(1>d||5<d)return!1;if(1==
d&&10==a[0].tok)return e.addX(a[0]);var c=b?JS.SV.getBitSet(e.getX(),!1):null,f=0,j=a[0].value,g=""+j,h=this.vwr.ms,k=!1,l=!1,m=!1,n=!1,p=null,q=a[0].tok;switch(4==q?q=JS.T.getTokFromName(g):q){case 1648363544:k=!0,j=null;case 3:case 2:n=!0;if(2>d||3==d&&7==a[1].tok&&7!=a[2].tok)return!1;f=k?100:JS.SV.fValue(a[0]);switch(q=a[1].tok){case 1073742335:case 1073742334:l=a[1].asBoolean();if(2<d&&JS.SV.sValue(a[2]).equalsIgnoreCase("unitcell"))q=1814695966;else if(2<d&&10!=a[2].tok)return!1;d=0;break;case 4:q=
JS.SV.sValue(a[1]);if(q.startsWith("$"))return e.addXBs(this.getAtomsNearSurface(f,q.substring(1)));if(q.equalsIgnoreCase("group"))m=!0,q=1086324742;else if(q.equalsIgnoreCase("vanderwaals")||q.equalsIgnoreCase("vdw"))j=null,k=!0,q=1648363544;else if(q=JS.T.getTokFromName(q),0==q)return!1}break;case 7:1==d&&(j=a[0].asString(),q=0);break;case 1073742328:return 3==d&&C(a[1].value,"JU.BS")&&C(a[2].value,"JU.BS")&&e.addXBs(this.vwr.getBranchBitSet(a[2].value.nextSetBit(0),a[1].value.nextSetBit(0),!0));
case 134218757:case 1237320707:case 134218756:f=null;b=!0;switch(d){case 2:f=c;break;case 3:if(b=10==a[2].tok)f=a[2].value;break;default:b=!1}return b&&e.addXObj(this.e.getSmilesExt().getSmilesMatches(JS.SV.sValue(a[1]),null,f,null,134218756==q?2:1,e.asBitSet,!1))}if("string"==typeof j){if(0==q){q=1073742362;if(2<d)return!1;d=2}}else if(!n)return!1;switch(d){case 1:switch(q){case 136314895:case 2097184:case 1812599299:case 1814695966:return e.addXBs(h.getAtoms(q,null));case 1073741863:return e.addXBs(h.getAtoms(q,
""));case 1073742362:return e.addXBs(h.getAtoms(1086324744,g))}return!1;case 2:switch(q){case 1073742362:q=1086324744;break;case 1073741824:case 1086326786:case 1086326785:case 1073741863:case 1086324744:case 1111490587:case 1073742128:case 1073741925:case 1073742189:return e.addXBs(this.vwr.ms.getAtoms(q,JS.SV.sValue(a[1])));case 1094713349:case 1094713350:return e.addXBs(this.vwr.ms.getAtoms(q,JS.SV.ptValue(a[1])));case 1814695966:c=a[1].getList();if(null==c)return!1;f=f=null;if(4!=c.size())return!1;
f=Array(4);for(a=0;4>a;a++)if(null==(f[a]=JS.SV.ptValue(c.get(a))))return!1;f=this.vwr.getSymTemp().getUnitCell(f,!1,null);return e.addXBs(this.vwr.ms.getAtoms(q,f))}break;case 3:switch(q){case 1073742335:case 1073742334:case 1086324742:case 1648363544:case 1814695966:case 134217750:case 134219777:case 1073742329:case 8:case 7:break;case 1086324744:g=JS.SV.sValue(a[2]);break;default:return!1}}var r=null,j=d=null,x=a.length-1;switch(a[x].tok){case 9:r=a[x].value;break;case 8:d=a[x].value;JS.SV.sValue(a[1]).equalsIgnoreCase("hkl")&&
(r=this.e.getHklPlane(d,NaN,null));break;case 7:j=2==x&&7==a[1].tok?a[1].getList():null,d=2==x?JS.SV.ptValue(a[1]):1==x?JU.P3.new3(NaN,0,0):null}if(null!=r)return e.addXBs(h.getAtomsNearPlane(f,r));h=10==a[x].tok?a[x].value:null;null==c&&(c=h);if(0<x&&null==d&&null==j&&null==c)return!1;if(1814695966==q)return(null!=c||null!=d)&&e.addXObj(this.vwr.ms.getUnitCellPointsWithin(f,c,d,l));if(null!=d||null!=j){if(7==a[x].tok){b=a[x].getList();q=Array(b.size());for(a=q.length;0<=--a;)q[a]=JS.SV.ptValue(b.get(a));
b=null;if(null!=j){b=Array(j.size());for(a=b.length;0<=--a;)b[a]=JS.SV.ptValue(j.get(a))}a=Array(1);null!=c&&(c.and(this.vwr.getAllAtoms()),b=this.vwr.ms.at);switch(J.bspt.PointIterator.withinDistPoints(f,d,q,b,c,a)){case 10:return e.addXBs(a[0]);case 134217751:return e.addXPt(a[0]);case 1073742001:return e.addXList(a[0]);case 1275068418:return e.addXAI(a[0]);case 4:return e.addXStr(a[0]);default:return!1}}return e.addXBs(this.vwr.getAtomsNearPt(f,d,null))}if(1086324744==q)return e.addXBs(this.vwr.ms.getSequenceBits(g,
c,new JU.BS));null==c&&(c=new JU.BS);if(!n)try{return e.addXBs(this.vwr.ms.getAtoms(q,c))}catch(y){if(M(y,Exception))return!1;throw y;}if(m)return e.addXBs(this.vwr.getGroupsWithin(ba(f),c));k&&(p=new J.atomdata.RadiusData(null,10<f?f/100:f,10<f?J.atomdata.RadiusData.EnumType.FACTOR:J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO),0>f&&(f=0));c=this.vwr.ms.getAtomsWithinRadius(f,b?h:c,l,p,b?c:null);b&&c.andNot(h);return e.addXBs(c)},"JS.ScriptMathProcessor,~A,~B");p(m,"evaluateWrite",function(e,
a){var b=a.length,d=!1;2==b&&1073742335==a[1].tok&&(b=1,d=!0);switch(b){case 0:return!1;case 1:var c=a[0].asString().toUpperCase();if(c.equals("PNGJ"))return b=this.vwr.fm.getFileAsMap(null,"PNGJ",d),d?e.addX(JS.SV.newV(15,new JU.BArray(b))):e.addXMap(b);if(JU.PT.isOneOf(c,";ZIP;ZIPALL;JMOL;")){var b=new java.util.Hashtable,f=new JU.OC;b.put("outputChannel",f);this.vwr.createZip(null,c,b);c=f.toByteArray();if(d)return e.addX(JS.SV.newV(15,new JU.BArray(c)));b=new java.util.Hashtable;this.vwr.readFileAsMap(JU.Rdr.getBIS(c),
b,null);return e.addXMap(b)}}return e.addXStr(this.e.getCmdExt().dispatch(134221856,!0,a))},"JS.ScriptMathProcessor,~A");p(m,"getAtomsNearSurface",function(e,a){var b=E(-1,[a,null,null]);if(this.e.getShapePropertyData(24,"getVertices",b))return this.getAtomsNearPts(e,b[1],b[2]);b[1]=Integer.$valueOf(0);b[2]=Integer.$valueOf(-1);if(this.e.getShapePropertyData(22,"getCenter",b))return this.vwr.getAtomsNearPt(e,b[2],null);b[1]=Float.$valueOf(e);return this.e.getShapePropertyData(21,"getAtomsWithin",
b)?b[2]:new JU.BS},"~N,~S");p(m,"getAtomsNearPts",function(e,a,b){var d=new JU.BS;if(0==a.length||null!=b&&b.isEmpty())return d;null==b&&(b=JU.BSUtil.setAll(a.length));for(var c=this.vwr.ms.at,f=this.vwr.ms.ac;0<=--f;){var j=c[f];if(null!=j)for(var g=b.nextSetBit(0);0<=g;g=b.nextSetBit(g+1))if(j.distance(a[g])<e){d.set(f);break}}return d},"~N,~A,JU.BS");p(m,"getMinMax",function(e,a,b){for(var d=null,c=null,f=0,j=null;;){if(JU.AU.isAF(e)){if(1275068725==a)return Float.$valueOf(NaN);d=e;f=d.length;
if(0==f)break}else if(C(e,"JU.Lst"))if(c=e,f=c.size(),0==f){if(1275068725!=a)break}else{if(1275068725!=a){e=c.get(0);if(8==e.tok)return this.getMinMaxPoint(c,a);if(4==e.tok&&e.value.startsWith("{")){b=JS.SV.ptValue(e);if(C(b,"JU.P3"))return this.getMinMaxPoint(c,a);if(C(b,"JU.P4"))return this.getMinMaxQuaternion(c,a);break}}}else break;var g,h=!1;switch(a){case 1275068725:j=new java.util.Hashtable;e=g=0;break;case 32:h=!0;e=3.4028235E38;g=2147483647;break;case 64:e=-3.4028235E38;g=-2147483647;break;
default:e=g=0}for(var k=0,l=0,m=!0,n=1275068725==a;0<=--f;){var p=null==c?null:c.get(f),q=!b?null:null==p?JS.SV.vF:p,r=n?1:null==d?JS.SV.fValue(q):d[f];if(!Float.isNaN(r))switch(l++,a){case 160:case 192:k+=r*r;case 128:case 96:e+=r;break;case 1275068725:p=null==q?p.toString():q.asString();q=j.get(p);j.put(p,null==q?Integer.$valueOf(1):Integer.$valueOf(q.intValue()+1));break;case 32:case 64:m=(new Boolean(m&2==q.tok)).valueOf(),h==r<e&&(e=r,m&&(g=q.intValue))}}if(1275068725==a)return j;if(0==l)break;
switch(a){case 96:e/=l;break;case 192:if(1==l)break;e=Math.sqrt((k-e*e/l)/(l-1));break;case 32:case 64:if(m)return Integer.$valueOf(g);break;case 160:e=k}return Float.$valueOf(e)}return JS.MathExt.nan},"~O,~N,~B");p(m,"getMinMaxPoint",function(e,a){var b=null,d=null,c=0;C(e,Array)?(b=e,c=b.length):C(e,"JU.Lst")&&(d=e,c=d.size());if(null==d&&null==b)return JS.MathExt.nan;for(var f=new JU.P3,j=x(c,0),g=0;3>g;g++){for(var h=0;h<c;h++){var k=null==b?JS.SV.ptValue(d.get(h)):b[h];if(null==k)return JS.MathExt.nan;
switch(g){case 0:j[h]=k.x;break;case 1:j[h]=k.y;break;case 2:j[h]=k.z}}h=this.getMinMax(j,a,!0);if(!C(h,Number))return JS.MathExt.nan;h=h.floatValue();switch(g){case 0:f.x=h;break;case 1:f.y=h;break;case 2:f.z=h}}return f},"~O,~N");p(m,"getMinMaxQuaternion",function(e,a){var b;switch(a){case 32:case 64:case 128:case 160:return JS.MathExt.nan}for(;;){b=this.e.getQuaternionArray(e,1073742001);if(null==b)break;var d=x(1,0);b=JU.Quat.sphereMean(b,d,1E-4);switch(a){case 96:return b;case 192:return Float.$valueOf(d[0])}break}return JS.MathExt.nan},
"JU.Lst,~N");p(m,"getPatternMatcher",function(){return null==this.pm?this.pm=J.api.Interface.getUtil("PatternMatcher",this.e.vwr,"script"):this.pm});p(m,"opTokenFor",function(e){switch(e){case 1275069441:case 1275069446:return JS.T.tokenPlus;case 1275068931:return JS.T.tokenMinus;case 1275068929:return JS.T.tokenTimes;case 1275068930:return JS.T.tokenMul3;case 1275068928:return JS.T.tokenDivide}return null},"~N");p(m,"setContactBitSets",function(e,a,b,d,c,f){var j,g;null==a?(a=JU.BSUtil.setAll(this.vwr.ms.ac),
JU.BSUtil.andNot(a,this.vwr.slm.bsDeleted),a.andNot(e),j=!1):(g=JU.BSUtil.copy(e),g.or(a),g=this.vwr.ms.getModelBS(g,!1).cardinality(),j=1<g,f&&(1<g&&!this.e.tQuiet)&&this.e.showString(J.i18n.GT.$("Note: More than one model is involved in this contact!")));if(!e.equals(a)){if(f=!b||e.cardinality()<a.cardinality())g=this.vwr.ms.getAtomsWithinRadius(d,e,j,Float.isNaN(d)?c:null,null),a.and(g);b&&(g=this.vwr.ms.getAtomsWithinRadius(d,a,j,Float.isNaN(d)?c:null,null),e.and(g),f||(g=this.vwr.ms.getAtomsWithinRadius(d,
e,j,Float.isNaN(d)?c:null,null),a.and(g)),g=JU.BSUtil.copy(a),g.and(e),g.equals(e)?a.andNot(e):g.equals(a)&&e.andNot(a))}return a},"JU.BS,JU.BS,~B,~N,J.atomdata.RadiusData,~B");m.nan=m.prototype.nan=Float.$valueOf(NaN);m.t0=m.prototype.t0=System.currentTimeMillis()});W("J.bspt");X(null,"J.bspt.PointIterator","java.lang.Float JU.BS $.Lst $.P3 J.bspt.Bspt JU.BSUtil $.Point3fi".split(" "),function(){var m=ja(J.bspt,"PointIterator");m.withinDistPoints=p(m,"withinDistPoints",function(e,a,b,d,c,f){var j=
new JU.Lst,g=new J.bspt.Bspt(3,0),h;if(null!=a&&Float.isNaN(a.x)){for(var k=Array(b.length),l=k.length;0<=--l;){h=b[l];if(null==h)return 0;null==c?(a=new JU.Point3fi,a.setT(h),a.i=l,k[l]=a,g.addTuple(a)):g.addTuple(h)}h=g.allocateCubeIterator();if(null!=c){b=JU.BS.newN(d.length);for(l=c.nextSetBit(0);0<=l;l=c.nextSetBit(l+1)){h.initialize(d[l],e,!1);for(g=e*e;h.hasMoreElements();)if(h.nextElement().distanceSquared(d[l])<=g){b.set(l);break}}f[0]=b;return 10}b=JU.BSUtil.newBitSet2(0,b.length);for(l=
k.length;0<=--l;){h.initialize(a=k[l],e,!1);g=e*e;for(c=0;h.hasMoreElements();)d=h.nextElement(),b.get(d.i)&&(d.distanceSquared(a)<=g&&1<++c)&&b.clear(d.i)}for(l=b.nextSetBit(0);0<=l;l=b.nextSetBit(l+1))j.addLast(JU.P3.newP(k[l]));f[0]=j;return 1073742001}if(0==e){if(null==d){g=3.4028235E38;k=null;for(l=b.length;0<=--l;)j=b[l],e=j.distanceSquared(a),e<g&&(k=j,g=e);f[0]=null==k?"":k;return null==k?4:134217751}k=N(d.length,0);for(l=k.length;0<=--l;){g=3.4028235E38;c=-1;a=d[l];for(h=b.length;0<=--h;)j=
b[h],e=j.distanceSquared(a),e<g&&(c=h,g=e);k[l]=c}f[0]=k;return 1275068418}for(l=b.length;0<=--l;)g.addTuple(b[l]);h=g.allocateCubeIterator();h.initialize(a,e,!1);for(g=e*e;h.hasMoreElements();)d=h.nextElement(),d.distanceSquared(a)<=g&&j.addLast(d);h.release();f[0]=j;return 1073742001},"~N,JU.P3,~A,~A,JU.BS,~A")});W("JU");X(null,"JU.PatternMatcher",["JV.Viewer"],function(){var m=ja(JU,"PatternMatcher");U(m,function(){});p(m,"compile",function(e,a){if(JV.Viewer.isJS&&!JV.Viewer.isSwingJS)return new JU.PatternMatcher.JSPattern(e,
a)},"~S,~B");m=aa(function(){this.strString=this.regexp=null;this.rightBound=this.leftBound=-1;this.results=null;$(this,arguments)},JU.PatternMatcher,"JSPattern");U(m,function(e,a){this.regexp=RegExp(e,a?"gi":"g")},"~S,~B");p(m,"find",function(){var e=this.rightBound==this.strString.length?this.strString:this.strString.substring(0,this.rightBound);this.regexp.lastIndex=this.leftBound;this.results=this.regexp.exec(e);this.leftBound=this.regexp.lastIndex;return null!=this.results});p(m,"start",function(){return this.regexp.lastIndex-
this.results[0].length});p(m,"end",function(){return this.regexp.lastIndex});p(m,"group",function(){return null==this.results||0==this.results.length?null:this.results[0]});p(m,"matcher",function(e){this.strString=e;this.leftBound=0;this.rightBound=e.length;return this},"~S")})})(Clazz,Clazz.getClassName,Clazz.newLongArray,Clazz.doubleToByte,Clazz.doubleToInt,Clazz.doubleToLong,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.floatToLong,
Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,
Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAB,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
